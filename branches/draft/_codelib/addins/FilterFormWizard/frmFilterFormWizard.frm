Version =20
VersionRequired =20
Checksum =168903004
Begin Form
    AllowFilters = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    AllowAdditions = NotDefault
    KeyPreview = NotDefault
    DefaultView =0
    ScrollBars =0
    TabularFamily =119
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridY =10
    Width =10771
    DatasheetFontHeight =10
    ItemSuffix =129
    Left =4056
    Top =1476
    Right =14832
    Bottom =7488
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x668d2cd46a58e440
    End
    GUID = Begin
        0x8f309169ffbfbd4ebbb375424a700b57
    End
    Caption ="ACLib FilterForm Wizard"
    OnCurrent ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xae050000ae050000ae050000ae05000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0025ad0fc4fbc91a58874f00010000000c00000098864f000200000002000000 ,
        0x010403069c00740353ef800301000900ea0a6f08640001000f00580202000100 ,
        0x5802030001004c657474657200296d69d9eba3e798874f0014cee91101000000 ,
        0x00000000b4870000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000004749535000000000000000000000000050524956 ,
        0xe210000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000008000740300000000000000000000000000000000 ,
        0x0000000000000000010000000000000000001000503403002888040000000000 ,
        0x000000000000010000000000000000000000000000000000c029e70d03000000 ,
        0x00000000ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000070000000534d544a0000000010006000 ,
        0x46007200650065005000440046005f0080000000534d544a0000000010007000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080023002b000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000467265655044465850313a0000000000
    End
    FilterOnLoad =0
    ShowPageMargins =0
    AllowLayoutView =0
    DatasheetGridlinesColor12 =12632256
    PrtDevModeW = Begin
        0x000000587e3249d8ec904f00aefcffff34a24f000300000008000000100ef41c ,
        0x347d4f00325bb177002e7f00ec904f00000000001015290b000000000000f41c ,
        0x01040306dc00740353ef800301000900ea0a6f08640001000f00580202000100 ,
        0x5802030001004c00650074007400650072000000c000290be02ffd1c0a000000 ,
        0x08804f00b067b47748000000feffffffd07d4f00955cb177fc01000000000000 ,
        0x9801f40101000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000004749535000000000000000000000000050524956 ,
        0xe210000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000008000740300000000000000000000000000000000 ,
        0x0000000000000000010000000000000000001000503403002888040000000000 ,
        0x000000000000010000000000000000000000000000000000c029e70d03000000 ,
        0x00000000ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000070000000534d544a0000000010006000 ,
        0x46007200650065005000440046005f0080000000534d544a0000000010007000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNamesW = Begin
        0x04001f0027000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000460072006500650050004400460058005000 ,
        0x31003a0000000000000000000000
    End
    
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
        End
        Begin Line
            BorderLineStyle =0
            Width =1701
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            Width =1701
            Height =1701
            BorderColor =16777215
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin ComboBox
            SpecialEffect =2
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =3
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =90.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin ToggleButton
            Width =283
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin Section
            CanGrow = NotDefault
            Height =6029
            BackColor =-2147483633
            Name ="Detailbereich"
            GUID = Begin
                0xfeffd8470a0a9b46abd37d015aab40c1
            End
            Begin
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2345
                    Top =5076
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulFilterStringBuilder"
                    FontName ="Marlett"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xdd6a6769d341054eb9b6a296fae08f29
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2345
                    LayoutCachedTop =5076
                    LayoutCachedWidth =2640
                    LayoutCachedHeight =5371
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2345
                    Top =4716
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulFilterControlManager"
                    FontName ="Marlett"
                    GUID = Begin
                        0x305cae0a69ac99408cdac46d5e2689ce
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2345
                    LayoutCachedTop =4716
                    LayoutCachedWidth =2640
                    LayoutCachedHeight =5011
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2345
                    Top =5436
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulSqlTools"
                    FontName ="Marlett"
                    GUID = Begin
                        0x1d0212a8607e14459c58854d3069900b
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2345
                    LayoutCachedTop =5436
                    LayoutCachedWidth =2640
                    LayoutCachedHeight =5731
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2345
                    Top =4371
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModules"
                    FontName ="Marlett"
                    GUID = Begin
                        0xbe7161d84c13b5499ad792e6366b9eac
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2345
                    LayoutCachedTop =4371
                    LayoutCachedWidth =2640
                    LayoutCachedHeight =4666
                End
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =2
                    Left =2748
                    Top =4210
                    Width =0
                    Height =1814
                    Name ="Linie49"
                    GUID = Begin
                        0x6c2c3106ded8534c87892e2ee126530c
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2748
                    LayoutCachedTop =4210
                    LayoutCachedWidth =2748
                    LayoutCachedHeight =6024
                End
                Begin TextBox
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    Name ="sysFirst"
                    GUID = Begin
                        0x4d21045caadf464383f75e79a673ebd4
                    End

                End
                Begin CommandButton
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =7425
                    Top =5475
                    Width =3072
                    Height =375
                    FontSize =10
                    TabIndex =4
                    Name ="cmdAddFilterCodeToForm"
                    Caption ="Formular-Code einfügen"
                    OnClick ="[Event Procedure]"
                    FontName ="Verdana"
                    Tag ="LANG:"
                    GUID = Begin
                        0x5bd9780ad5280e4ca3a72fc65582233c
                    End
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =7425
                    LayoutCachedTop =5475
                    LayoutCachedWidth =10497
                    LayoutCachedHeight =5850
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin Label
                    OverlapFlags =85
                    Left =320
                    Top =4741
                    Width =1991
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulFilterControlManager"
                    Caption ="FilterControlManager"
                    GUID = Begin
                        0x8b2a1e9b456dac47a589d89260e7cd9d
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =320
                    LayoutCachedTop =4741
                    LayoutCachedWidth =2311
                    LayoutCachedHeight =4996
                End
                Begin Label
                    OverlapFlags =85
                    Left =320
                    Top =5101
                    Width =1991
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulFilterStringBuilder"
                    Caption ="FilterStringBuilder"
                    GUID = Begin
                        0x502db6c278e7644e80b7bb465da8086e
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =320
                    LayoutCachedTop =5101
                    LayoutCachedWidth =2311
                    LayoutCachedHeight =5356
                End
                Begin Label
                    OverlapFlags =85
                    Left =320
                    Top =5461
                    Width =1991
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulSqlTools"
                    Caption ="SqlTools"
                    GUID = Begin
                        0xdd04a61804b3d3489636dea0aac6d966
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =320
                    LayoutCachedTop =5461
                    LayoutCachedWidth =2311
                    LayoutCachedHeight =5716
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =2345
                    Top =5076
                    Width =295
                    Height =295
                    TabIndex =5
                    Name ="cmdCopyModulFilterStringBuilder"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc8975d8c2da3304ebb127dc3080d923e
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2345
                    LayoutCachedTop =5076
                    LayoutCachedWidth =2640
                    LayoutCachedHeight =5371
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =2345
                    Top =4716
                    Width =295
                    Height =295
                    TabIndex =3
                    Name ="cmdCopyModulFilterControlManager"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc0cb35c7d786bf44aefdc3b2945a0498
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2345
                    LayoutCachedTop =4716
                    LayoutCachedWidth =2640
                    LayoutCachedHeight =5011
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =2345
                    Top =5436
                    Width =295
                    Height =295
                    TabIndex =6
                    Name ="cmdCopyModulSqlTools"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xb1a983cde9722b43a3e535cf8b426c67
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2345
                    LayoutCachedTop =5436
                    LayoutCachedWidth =2640
                    LayoutCachedHeight =5731
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =93
                    Left =84
                    Top =4393
                    Width =2145
                    Height =255
                    FontSize =9
                    FontWeight =700
                    ForeColor =16737792
                    Name ="labCopyCaption"
                    Caption ="Klassen installieren:"
                    OnMouseDown ="[Event Procedure]"
                    OnMouseMove ="[Event Procedure]"
                    Tag ="LANG:"
                    GUID = Begin
                        0x6fdf1d4132b76c429cd92273cd9ef89b
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =84
                    LayoutCachedTop =4393
                    LayoutCachedWidth =2229
                    LayoutCachedHeight =4648
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =223
                    Left =2345
                    Top =4371
                    Width =295
                    Height =295
                    TabIndex =1
                    Name ="cmdCopyModules"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x71b2bb2e794e5a4183b92a358e952ad8
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2345
                    LayoutCachedTop =4371
                    LayoutCachedWidth =2640
                    LayoutCachedHeight =4666
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =2003
                    Top =165
                    Width =3402
                    Height =285
                    FontSize =10
                    TabIndex =2
                    GUID = Begin
                        0x9ae17955cc84ce48bbcca6b1a3566263
                    End
                    Name ="cbxFormName"
                    RowSourceType ="Table/Query"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Verdana"
                    OnGotFocus ="[Event Procedure]"

                    LayoutCachedLeft =2003
                    LayoutCachedTop =165
                    LayoutCachedWidth =5405
                    LayoutCachedHeight =450
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =77
                            Top =165
                            Width =1920
                            Height =285
                            FontSize =10
                            Name ="labSelectForm"
                            Caption ="Filter-Formular:"
                            FontName ="Verdana"
                            Tag ="LANG:"
                            GUID = Begin
                                0x686faf8a460dc643aef4f21fb057114d
                            End
                            LayoutCachedLeft =77
                            LayoutCachedTop =165
                            LayoutCachedWidth =1997
                            LayoutCachedHeight =450
                        End
                    End
                End
                Begin Subform
                    Enabled = NotDefault
                    OverlapFlags =87
                    SpecialEffect =3
                    Left =84
                    Top =895
                    Width =10605
                    Height =3255
                    TabIndex =7
                    BorderColor =-2147483630
                    Name ="sfrFilterControls"
                    SourceObject ="Form.frmFilterFormWizard_SF_Controls"
                    GUID = Begin
                        0x31310376de53cf4f94a5b24ab61e1a1a
                    End
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedLeft =84
                    LayoutCachedTop =895
                    LayoutCachedWidth =10689
                    LayoutCachedHeight =4150
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =84
                            Top =610
                            Width =1920
                            Height =285
                            FontSize =10
                            Name ="labFilterControls"
                            Caption ="Filter-Controls:"
                            Tag ="LANG:"
                            GUID = Begin
                                0x316e57d56817c141a27648ce160be30c
                            End
                            LayoutCachedLeft =84
                            LayoutCachedTop =610
                            LayoutCachedWidth =2004
                            LayoutCachedHeight =895
                        End
                    End
                End
                Begin OptionGroup
                    Enabled = NotDefault
                    OverlapFlags =93
                    Left =3108
                    Top =4615
                    Width =3742
                    Height =1304
                    TabIndex =9
                    Name ="ApplyFilterMethodOptions"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    GUID = Begin
                        0x467177d9c56ca94a880a2e7ea0a3df15
                    End
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =3108
                    LayoutCachedTop =4615
                    LayoutCachedWidth =6850
                    LayoutCachedHeight =5919
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            TextAlign =2
                            Left =3228
                            Top =4500
                            Width =1536
                            Height =240
                            BackColor =-2147483633
                            Name ="labUseFilterMethodOptions"
                            Caption ="ApplyFilter-Methode"
                            Tag ="LANG:"
                            GUID = Begin
                                0x6e694148f314bf4eae763e55e8443045
                            End
                            HorizontalAnchor =1
                            VerticalAnchor =1
                            LayoutCachedLeft =3228
                            LayoutCachedTop =4500
                            LayoutCachedWidth =4764
                            LayoutCachedHeight =4740
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =3258
                            Top =4887
                            OptionValue =0
                            BorderColor =13553360
                            Name ="ApplyFilterMethodOptions_Opt0"
                            GUID = Begin
                                0x2ed9a0b87581e9459437795c1ea4f08f
                            End
                            GridlineColor =10921638
                            HorizontalAnchor =1
                            VerticalAnchor =1

                            LayoutCachedLeft =3258
                            LayoutCachedTop =4887
                            LayoutCachedWidth =3518
                            LayoutCachedHeight =5127
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =3483
                                    Top =4855
                                    Width =3075
                                    Height =240
                                    Name ="labUseFilterMethodOptions0"
                                    Caption ="auskommentierten Beispiel-Code einfügen"
                                    Tag ="LANG:"
                                    GUID = Begin
                                        0x45350e3d0a7cde4ca18753d3df2a7a50
                                    End
                                    HorizontalAnchor =1
                                    VerticalAnchor =1
                                    LayoutCachedLeft =3483
                                    LayoutCachedTop =4855
                                    LayoutCachedWidth =6558
                                    LayoutCachedHeight =5095
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =3258
                            Top =5197
                            TabIndex =1
                            OptionValue =1
                            BorderColor =13553360
                            Name ="ApplyFilterMethodOptions_Opt1"
                            GUID = Begin
                                0x918bf012f5ab6a4a82b18d8d78de17cb
                            End
                            GridlineColor =10921638
                            HorizontalAnchor =1
                            VerticalAnchor =1

                            LayoutCachedLeft =3258
                            LayoutCachedTop =5197
                            LayoutCachedWidth =3518
                            LayoutCachedHeight =5437
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =3487
                                    Top =5170
                                    Width =3049
                                    Height =240
                                    Name ="labUseFilterMethodOptions1"
                                    Caption ="aktuelles Formular filtern"
                                    Tag ="LANG:"
                                    GUID = Begin
                                        0xdcea6dbc2fc72b438c7c28fb17bae4f6
                                    End
                                    HorizontalAnchor =1
                                    VerticalAnchor =1
                                    LayoutCachedLeft =3487
                                    LayoutCachedTop =5170
                                    LayoutCachedWidth =6536
                                    LayoutCachedHeight =5410
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =3258
                            Top =5540
                            TabIndex =2
                            OptionValue =2
                            BorderColor =13553360
                            Name ="ApplyFilterMethodOptions_Opt2"
                            GUID = Begin
                                0x03d2ddc59a72074694568a25b639186a
                            End
                            GridlineColor =10921638
                            HorizontalAnchor =1
                            VerticalAnchor =1

                            LayoutCachedLeft =3258
                            LayoutCachedTop =5540
                            LayoutCachedWidth =3518
                            LayoutCachedHeight =5780
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =3487
                                    Top =5510
                                    Width =1114
                                    Height =240
                                    Name ="labUseFilterMethodOptions3"
                                    Caption ="Unterformular"
                                    Tag ="LANG:"
                                    GUID = Begin
                                        0x743cbf1b4fad704a87f1096bb7ea5c8e
                                    End
                                    HorizontalAnchor =1
                                    VerticalAnchor =1
                                    LayoutCachedLeft =3487
                                    LayoutCachedTop =5510
                                    LayoutCachedWidth =4601
                                    LayoutCachedHeight =5750
                                End
                            End
                        End
                    End
                End
                Begin ComboBox
                    Enabled = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =247
                    IMESentenceMode =3
                    ListWidth =3402
                    Left =4601
                    Top =5510
                    Width =2061
                    TabIndex =8
                    GUID = Begin
                        0xd2abcc3725b6174684facff57821578b
                    End
                    Name ="cbxApplyFilterSubForm"
                    RowSourceType ="Value List"
                    ColumnWidths ="3402"
                    AfterUpdate ="[Event Procedure]"
                    OnGotFocus ="[Event Procedure]"
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =4601
                    LayoutCachedTop =5510
                    LayoutCachedWidth =6662
                    LayoutCachedHeight =5750
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =3
                    Left =1176
                    Top =4183
                    Width =1548
                    Height =210
                    FontSize =7
                    Name ="labCodeInstalled"
                    Caption ="bereits installiert"
                    FontName ="Small Fonts"
                    Tag ="LANG:"
                    GUID = Begin
                        0x9586ac4241703346a1cfd7ee0517764e
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =1176
                    LayoutCachedTop =4183
                    LayoutCachedWidth =2724
                    LayoutCachedHeight =4393
                End
                Begin OptionGroup
                    Enabled = NotDefault
                    OverlapFlags =215
                    Left =7245
                    Top =4620
                    Width =3458
                    Height =1304
                    TabIndex =10
                    Name ="FormCodeOptions"
                    DefaultValue ="1"
                    GUID = Begin
                        0xed45349e0bb4624d802c11bd5a81e244
                    End
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =7245
                    LayoutCachedTop =4620
                    LayoutCachedWidth =10703
                    LayoutCachedHeight =5924
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            Left =7361
                            Top =4500
                            Width =1395
                            Height =240
                            BackColor =-2147483633
                            Name ="labFormCodeOptions"
                            Caption ="Filter-Variante"
                            Tag ="LANG:"
                            GUID = Begin
                                0x4cd36eb1b18bd14090e780e9374d713e
                            End
                            HorizontalAnchor =1
                            VerticalAnchor =1
                            LayoutCachedLeft =7361
                            LayoutCachedTop =4500
                            LayoutCachedWidth =8756
                            LayoutCachedHeight =4740
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =7395
                            Top =4892
                            OptionValue =1
                            BorderColor =13553360
                            Name ="FormCodeOptions_Opt1"
                            GUID = Begin
                                0x9360b4bcc3c8bf48a0506593b1be6c0a
                            End
                            GridlineColor =10921638
                            HorizontalAnchor =1
                            VerticalAnchor =1

                            LayoutCachedLeft =7395
                            LayoutCachedTop =4892
                            LayoutCachedWidth =7655
                            LayoutCachedHeight =5132
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =7620
                                    Top =4860
                                    Width =2948
                                    Height =240
                                    Name ="labFormCodeOptions1"
                                    Caption ="FilterControlManager-Methoden"
                                    Tag ="LANG:"
                                    GUID = Begin
                                        0x96fff90c3e8c3744973d78912bd996cc
                                    End
                                    HorizontalAnchor =1
                                    VerticalAnchor =1
                                    LayoutCachedLeft =7620
                                    LayoutCachedTop =4860
                                    LayoutCachedWidth =10568
                                    LayoutCachedHeight =5100
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =7395
                            Top =5202
                            TabIndex =1
                            OptionValue =2
                            BorderColor =13553360
                            Name ="FormCodeOptions_Opt2"
                            GUID = Begin
                                0x3b9786ef86a3784a9dd3a8c5ebed31d9
                            End
                            GridlineColor =10921638
                            HorizontalAnchor =1
                            VerticalAnchor =1

                            LayoutCachedLeft =7395
                            LayoutCachedTop =5202
                            LayoutCachedWidth =7655
                            LayoutCachedHeight =5442
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =7624
                                    Top =5175
                                    Width =2948
                                    Height =240
                                    Name ="labFormCodeOptions2"
                                    Caption ="FilterStringBuilder-Methoden"
                                    Tag ="LANG:"
                                    GUID = Begin
                                        0x69dd7bb4498fde4eadebb58c04022929
                                    End
                                    HorizontalAnchor =1
                                    VerticalAnchor =1
                                    LayoutCachedLeft =7624
                                    LayoutCachedTop =5175
                                    LayoutCachedWidth =10572
                                    LayoutCachedHeight =5415
                                End
                            End
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =87
                    IMESentenceMode =3
                    ColumnCount =4
                    Left =8820
                    Top =4200
                    Width =1836
                    TabIndex =11
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"40\""
                    GUID = Begin
                        0x441a7ad565bdaf4ba272387b51e93fe5
                    End
                    Name ="cbxSqlLang"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tabSqlLangFormat.SqlLang, tabSqlLangFormat.SqlDateFormat, tabSqlLangForma"
                        "t.SqlBooleanTrueString, tabSqlLangFormat.SqlWildCardString FROM tabSqlLangFormat"
                        " ORDER BY tabSqlLangFormat.SqlLang;"
                    ColumnWidths ="1701;0;0;0"
                    StatusBarText ="SQL-Dialekt auswählen"
                    DefaultValue ="\"Jet/DAO\""
                    Tag ="LANG:"
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =8820
                    LayoutCachedTop =4200
                    LayoutCachedWidth =10656
                    LayoutCachedHeight =4440
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =7755
                            Top =4200
                            Width =1065
                            Height =240
                            RightMargin =29
                            Name ="labSqlLang"
                            Caption ="SQL-Dialekt:"
                            Tag ="LANG:"
                            GUID = Begin
                                0x14d7ced7ebfa2f4dbad32c7023fb2a33
                            End
                            HorizontalAnchor =1
                            VerticalAnchor =1
                            LayoutCachedLeft =7755
                            LayoutCachedTop =4200
                            LayoutCachedWidth =8820
                            LayoutCachedHeight =4440
                        End
                    End
                End
                Begin ComboBox
                    Enabled = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    IMESentenceMode =3
                    ListWidth =2268
                    Left =8423
                    Top =308
                    Width =1659
                    TabIndex =12
                    GUID = Begin
                        0x7fbc37c8d7358d42adb800f0c274acc7
                    End
                    Name ="cbxRemoveFilterCtl"
                    RowSourceType ="Value List"

                    LayoutCachedLeft =8423
                    LayoutCachedTop =308
                    LayoutCachedWidth =10082
                    LayoutCachedHeight =548
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =5496
                            Top =312
                            Width =2925
                            Height =240
                            RightMargin =29
                            Name ="labRemoveFilterCtl"
                            Caption ="CommandButton \"Filter löschen\":"
                            Tag ="LANG:"
                            GUID = Begin
                                0xe5c1e8b3e7057c4ea77f36613572cde1
                            End
                            LayoutCachedLeft =5496
                            LayoutCachedTop =312
                            LayoutCachedWidth =8421
                            LayoutCachedHeight =552
                        End
                    End
                End
                Begin ComboBox
                    Enabled = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    IMESentenceMode =3
                    Left =8423
                    Top =24
                    Width =1659
                    TabIndex =13
                    GUID = Begin
                        0x468d75b535427e479ada1078d0e59ce2
                    End
                    Name ="cbxApplyFilterCtl"
                    RowSourceType ="Value List"
                    ColumnWidths ="2268"

                    LayoutCachedLeft =8423
                    LayoutCachedTop =24
                    LayoutCachedWidth =10082
                    LayoutCachedHeight =264
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =5496
                            Top =28
                            Width =2925
                            Height =240
                            RightMargin =29
                            Name ="labUseFilterCtl"
                            Caption ="CommandButton \"Filter anwenden\":"
                            Tag ="LANG:"
                            GUID = Begin
                                0xf68078d376144d4793b250bb6c33fe72
                            End
                            LayoutCachedLeft =5496
                            LayoutCachedTop =28
                            LayoutCachedWidth =8421
                            LayoutCachedHeight =268
                        End
                    End
                End
                Begin ComboBox
                    Enabled = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    IMESentenceMode =3
                    ListWidth =2268
                    Left =8424
                    Top =598
                    Width =1659
                    TabIndex =14
                    GUID = Begin
                        0xa00a87a1d6cb4544b317178021673676
                    End
                    Name ="cbxAutoFilterCtl"
                    RowSourceType ="Value List"

                    LayoutCachedLeft =8424
                    LayoutCachedTop =598
                    LayoutCachedWidth =10083
                    LayoutCachedHeight =838
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =5497
                            Top =602
                            Width =2925
                            Height =240
                            RightMargin =29
                            Name ="labAutoFilterCtl"
                            Caption ="AutoFilter-Checkbox:"
                            Tag ="LANG:"
                            GUID = Begin
                                0x7236fa277bfd404d87113a1a58418527
                            End
                            LayoutCachedLeft =5497
                            LayoutCachedTop =602
                            LayoutCachedWidth =8422
                            LayoutCachedHeight =842
                        End
                    End
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    Left =60
                    Top =5755
                    Width =2568
                    Height =240
                    ForeColor =16737792
                    Name ="labCheckVersion"
                    Caption ="Wizard-Version prüfen"
                    OnClick ="[Event Procedure]"
                    OnMouseMove ="[Event Procedure]"
                    Tag ="unchecked|LANG:"
                    GUID = Begin
                        0xdcdeffa97bf2ca4f8f5702328eae0b9b
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =60
                    LayoutCachedTop =5755
                    LayoutCachedWidth =2628
                    LayoutCachedHeight =5995
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =87
                    Left =2004
                    Top =595
                    Width =3402
                    Height =284
                    FontSize =7
                    TabIndex =15
                    Name ="cmdFillFilterControlsFromDataSource"
                    Caption ="FilterControl-Liste mit Namen aus Datenquelle füllen"
                    StatusBarText ="Zum Füllen der List mit den Namen aus der Formulardatenquelle bitte zuerst in de"
                        "r ApplyFilter-Methode das Datenformular einstellen"
                    OnClick ="[Event Procedure]"
                    Tag ="LANG:"
                    ControlTipText ="Bitte zuerst in der 'ApplyFilter-Methode'-Option das Datenformular einstellen!"
                    GUID = Begin
                        0x683609b2ef3da847bec91b308cba0601
                    End

                    LayoutCachedLeft =2004
                    LayoutCachedTop =595
                    LayoutCachedWidth =5406
                    LayoutCachedHeight =879
                    BackColor =-2147483633
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    TabStop = NotDefault
                    RowSourceTypeInt =1
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextAlign =2
                    IMESentenceMode =3
                    Left =10128
                    Top =24
                    Width =561
                    Height =228
                    TabIndex =16
                    BackColor =14151142
                    GUID = Begin
                        0x15a2262ca2a68c44a65eace584910596
                    End
                    Name ="cbxLangCode"
                    RowSourceType ="Value List"
                    RowSource ="\"DE\";\"EN\""
                    AfterUpdate ="[Event Procedure]"
                    HorizontalAnchor =1

                    LayoutCachedLeft =10128
                    LayoutCachedTop =24
                    LayoutCachedWidth =10689
                    LayoutCachedHeight =252
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------f------------------------------------------------------
' Form: frmFilterFormWizard
'---------------------------------------------------------------------------------------
'/**
' \author       Josef Poetzl
' <summary>
' Wizard-Form für FilterControlManager-Import
' </summary>
' <remarks></remarks>
'**/
'------------------------------------------------------------------------------------
'<codelib>
'  <file>_codelib/addins/FilterFormWizard/frmFilterFormWizard.frm</file>
'  <license>_codelib/license.bas</license>
'  <use>_codelib/addins/FilterFormWizard/FilterFormCodeImporter.cls</use>
'  <use>_codelib/addins/shared/AppFileCodeModulTransfer.cls</use>
'  <use>_codelib/addins/FilterFormWizard/frmFilterFormWizard_SF_Controls.frm</use>
'  <use>_codelib/addins/shared/ACLibWebImporter.cls</use>
'  <use>text/StringTools.bas</code>
'  <use>localization/L10nTools.bas</use>
'  <use>localization/L10nDict.cls</use>
'</codelib>
'---------------------------------------------------------------------------------------
'
Option Compare Database
Option Explicit

Private m_OpenModules As Long
Private m_CodeModulImporter As AppFileCodeModulTransfer

Private Const SubFormApplyFilterOption As Long = 2

Private WithEvents m_L10nDict As L10nDict
Attribute m_L10nDict.VB_VarHelpID = -1

Private Property Get SourceDb() As DAO.Database
   Set SourceDb = CurrentDb
End Property

Private Property Get CodeModulImporter() As AppFileCodeModulTransfer
   If m_CodeModulImporter Is Nothing Then
      Set m_CodeModulImporter = New AppFileCodeModulTransfer
      m_CodeModulImporter.UseVbComponentsImport = APPLICATION_FILTERCODEMODULE_USEVBCOMPONENTSIMPORT
   End If
   Set CodeModulImporter = m_CodeModulImporter
End Property

Private Sub cbxFormName_AfterUpdate()

   Dim FormName As String
   Dim FormSelected As Boolean
   Dim FormRef As Form

   RefreshAddFilterButtonEnableMode
   
   FormName = Nz(Me.cbxFormName.Value, vbNullString)
   FormSelected = (Len(FormName) > 0)

   Me.sfrFilterControls.Enabled = FormSelected
   Me.cbxApplyFilterCtl.Enabled = FormSelected
   Me.cbxRemoveFilterCtl.Enabled = FormSelected
   Me.cbxAutoFilterCtl.Enabled = FormSelected
   
   Me.ApplyFilterMethodOptions.Enabled = FormSelected
   With Me.cbxApplyFilterSubForm
      .Enabled = FormSelected And (Me.ApplyFilterMethodOptions = SubFormApplyFilterOption)
      .Value = Null
   End With
   
   Me.FormCodeOptions.Enabled = FormSelected
   
   If Not FormSelected Then
      Me.cbxFormName.RowSource = vbNullString
      Me.sfrFilterControls.Form.InitFilterForm Nothing
      Me.cbxApplyFilterSubForm.RowSource = vbNullString
      Exit Sub
   End If

   Set FormRef = GetFilterFormRef
   
   LoadControlsFromForm FormRef

End Sub

Private Sub RefreshAddFilterButtonEnableMode()
   
   Dim EnableBtn As Boolean

   EnableBtn = (Len(Nz(Me.cbxFormName.Value, vbNullString)) > 0)
   
   If EnableBtn Then
      If Me.ApplyFilterMethodOptions.Value = 2 Then
         EnableBtn = (Len(Nz(Me.cbxApplyFilterSubForm.Value, vbNullString)) > 0)
      End If
   End If

   Me.cmdAddFilterCodeToForm.Enabled = EnableBtn

End Sub

Private Function GetFilterFormRef() As Form

   Dim FormName As String

   FormName = Nz(Me.cbxFormName.Value, vbNullString)
   If Len(FormName) = 0 Then
      Set GetFilterFormRef = Nothing
      Exit Function
   End If

   OpenFormIfClosed FormName
   Set GetFilterFormRef = Application.Forms(FormName)

End Function

Private Sub OpenFormIfClosed(ByVal FormName As String)
   If Not CurrentProject.AllForms(FormName).IsLoaded Then
      DoCmd.OpenForm FormName, acDesign, , , , acHidden
   End If
End Sub

Private Sub cbxFormName_GotFocus()
   LoadForms
End Sub

Private Sub LoadForms()
   Me.cbxFormName.RowSource = "Select Name FROM [" & SourceDb.Name & "].MSysObjects where Type = -32768 Order By Name"
End Sub

Private Sub cbxLangCode_AfterUpdate()
   With Me.cbxLangCode
      If IsNull(.Value) Then
         .Value = "EN"
      End If
      L10n.LangCode = .Value
   End With
End Sub

Private Sub cbxApplyFilterSubForm_AfterUpdate()
   SetFillFilterControlsFromDataSourceMode
   RefreshAddFilterButtonEnableMode
End Sub

Private Sub cbxApplyFilterSubForm_GotFocus()
   RefreshSubFormList
End Sub

Private Sub RefreshSubFormList()

   Dim frm As Form
   Dim ctl As Control

   Me.cbxApplyFilterSubForm.RowSource = vbNullString
   
   Set frm = GetFilterFormRef
   If frm Is Nothing Then
      Exit Sub
   End If

   For Each ctl In frm.Controls
      Select Case ctl.ControlType
         Case AcControlType.acSubform
            Me.cbxApplyFilterSubForm.AddItem ctl.Name
      End Select
   Next

End Sub

Private Sub AddFilterCodeToForm(ByVal ImporterRef As IFilterFormCodeBuilder)

   Dim FormName As String
   Dim ApplyFilterCtlName As String
   Dim RemoveFilterCtlName As String
   Dim AutoFilterCtlName As String

   FormName = Nz(Me.cbxFormName.Value, vbNullString)
   If Len(FormName) = 0 Then
      MsgBox "Bitte zuerst Formular auswählen!", , CurrentApplication.ApplicationName
      Exit Sub
   End If
   
   ApplyFilterCtlName = Nz(Me.cbxApplyFilterCtl.Value, vbNullString)
   RemoveFilterCtlName = Nz(Me.cbxRemoveFilterCtl.Value, vbNullString)
   AutoFilterCtlName = Nz(Me.cbxAutoFilterCtl.Value, vbNullString)
   
   AddChangeFilterControlsToForm FormName, ApplyFilterCtlName, RemoveFilterCtlName, AutoFilterCtlName
   
   With New FilterFormCodeImporter
   
      Set .Importer = ImporterRef
   
      AddControlsToImporter .Self, FormName
      
      .WriteToForm FormName, _
                   Nz(Me.ApplyFilterMethodOptions.Value, 0), _
                   Nz(Me.cbxApplyFilterSubForm.Value, vbNullString), _
                   Nz(Me.cbxSqlLang.Column(1), vbNullString), _
                   Nz(Me.cbxSqlLang.Column(2), vbNullString), _
                   Nz(Me.cbxSqlLang.Column(3), vbNullString), _
                   GetCheckedControlName(ApplyFilterCtlName), _
                   GetCheckedControlName(RemoveFilterCtlName), _
                   GetCheckedControlName(AutoFilterCtlName)

   End With

   CheckModules

   Me.SetFocus

End Sub

Private Sub AddChangeFilterControlsToForm(ByVal FilterFormName As String, ByRef ApplyFilterCtlName As String, ByRef RemoveFilterCtlName As String, ByRef AutoFilterCtlName As String)

   Dim SaveForm As Boolean
   
   If ApplyFilterCtlName = FILTERFORMWIZARD_TEXT_CREATENEW Then
      ApplyFilterCtlName = "cmdApplyFilter"
      AddChangeFilterControlToForm FilterFormName, ApplyFilterCtlName, acCommandButton, L10n.Text("Filter anwenden")
      SaveForm = True
   End If
   
   If RemoveFilterCtlName = FILTERFORMWIZARD_TEXT_CREATENEW Then
      RemoveFilterCtlName = "cmdRemoveFilter"
      AddChangeFilterControlToForm FilterFormName, RemoveFilterCtlName, acCommandButton, L10n.Text("Filter löschen")
      SaveForm = True
   End If
   
   If AutoFilterCtlName = FILTERFORMWIZARD_TEXT_CREATENEW Then
      AutoFilterCtlName = "cbAutoFilter"
      AddChangeFilterControlToForm FilterFormName, AutoFilterCtlName, acCheckBox, L10n.Text("Autofilter"), True
      SaveForm = True
   End If
   
   If SaveForm Then
      DoCmd.Save acForm, FilterFormName
   End If
   
End Sub

Private Sub AddChangeFilterControlToForm(ByVal FilterFormName As String, _
                                         ByRef ControlName As String, _
                                         ByVal ControlType As AcControlType, _
                                         ByVal ControlCaption As String, _
                                Optional ByVal DefaultValue As Variant)

   Const DistanceBetweenControls As Long = 72

   Dim InsertLabelControl As Boolean
   
   Select Case ControlType
      Case AcControlType.acCommandButton, AcControlType.acOptionButton, AcControlType.acLabel
         InsertLabelControl = False
      Case Else
         InsertLabelControl = True
   End Select
   
   With New FormDesigner
      .FormName = FilterFormName
      With .AddControl(ControlType, ControlName, acHeader, , , , , DistanceBetweenControls, InsertLabelControl, ControlCaption)
         If Not InsertLabelControl Then
            .Caption = ControlCaption
         End If
         ControlName = .Name
         If Not IsMissing(DefaultValue) Then
            .DefaultValue = DefaultValue
         End If
      End With
   End With

End Sub

Private Sub AddControlsToImporter(ByVal Importer As FilterFormCodeImporter, ByVal FilterFormName As String)
   Me.sfrFilterControls.Form.AddControlsToImporter Importer, FilterFormName
End Sub

Private Sub cmdAddFilterCodeToForm_Click()
   
   Select Case Me.FormCodeOptions.Value
      Case 1
         AddFilterCodeToForm New FilterControlManagerCodeBuilder
      Case 2
         AddFilterCodeToForm New FilterStringBuilderCodeBuilder
   End Select
   
End Sub

Private Sub cmdFillFilterControlsFromDataSource_Click()
   
   Dim FilterFormName As String
   Dim SubFormName As String
   
   FilterFormName = Nz(Me.cbxFormName.Value, vbNullString)
   If Len(FilterFormName) = 0 Then Exit Sub
   
   Select Case Me.ApplyFilterMethodOptions.Value
      Case 1
         ' keine weiteren Anpassungen
      Case 2
         SubFormName = Nz(Me.cbxApplyFilterSubForm.Value, vbNullString)
         If Len(SubFormName) = 0 Then Exit Sub
      Case Else
         Exit Sub
   End Select

   If Not CurrentProject.AllForms(FilterFormName).IsLoaded Then
      DoCmd.OpenForm FilterFormName, acDesign, , , , acWindowNormal
   End If
   
   With Application.Forms(FilterFormName)
      Select Case Me.ApplyFilterMethodOptions.Value
         Case 1
            FillFilterControlsFromDataSource .RecordSource
         Case 2
            FillFilterControlsFromDataSource .Controls(SubFormName).Form.RecordSource
      End Select
   
   End With
   
End Sub

Private Sub FillFilterControlsFromDataSource(ByVal DataSource As String)
   
   Dim fld As DAO.Field
   
   If Len(DataSource) = 0 Then
      MsgBox "Es ist keine Datenquelle eingestellt!", vbExclamation, "Filter aus Datenfelder erzeugen"
      Exit Sub
   End If
   
   With CurrentDb.OpenRecordset(DataSource)
      For Each fld In .Fields
         AddFilterControlFromDataField fld
      Next
      .Close
   End With
   
End Sub

Private Sub AddFilterControlFromDataField(ByVal DataField As DAO.Field)
   Me.sfrFilterControls.Form.InsertFilterRecord DataField.Name, DataField.Type
End Sub

Private Sub Form_Current()
   CheckModules
End Sub

Private Sub OpenReplaceModulesContextMenu(ByRef MenuControlRef As Control, ByVal x As Single, ByVal y As Single)

   Dim mnu As WinApiShortcutMenu
   Dim SelectedMenuItem As Long

   Set mnu = New WinApiShortcutMenu
      
   With mnu
      .ControlSection = acDetail
      Set .AccessForm = Me
      Set .MenuControl = MenuControlRef
      
      .AddMenuItem 3, L10n.Text("Codemodule in Add-In aus SVN-Repository aktualisieren (trunk).")
      .AddMenuItem 4, L10n.Text("Codemodule in Add-In aus SVN-Repository aktualisieren (draft-Zweig).")
      .AddMenuItem 0, "", MF_SEPARATOR
      .AddMenuItem 1, L10n.Text("Alle Codemodule erneuern (vorhandene Module werden überschrieben)")
      .AddMenuItem 2, L10n.Text("Alle Codemodule außer 'SqlTools' erneuern (SqlTools bleibt unverändert)")
      
   End With
   
   SelectedMenuItem = mnu.OpenMenu(x, y)
   Select Case SelectedMenuItem
      Case 1
         ReplaceAllModules True
      Case 2
         ReplaceAllModules False
      Case 3
         RefreshCodeModulesFromSvnRepo False
      Case 4
         RefreshCodeModulesFromSvnRepo True
      Case Else
         '
   End Select

   Set mnu = Nothing

End Sub

Private Sub ReplaceAllModules(Optional ByVal WithSqlTools As Boolean = False)
   
   Dim ModulesReplaced As Boolean

On Error Resume Next
   
   With CodeModulImporter
      If WithSqlTools Then
         ModulesReplaced = .ReplaceCodeModules("SqlTools", "StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
      Else
         ModulesReplaced = .ReplaceCodeModules("StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
      End If
   End With

   If ModulesReplaced Then
   
      SetModulCopyControls "CopyModulSqlTools", True
      SetModulCopyControls "CopyModulFilterStringBuilder", True
      SetModulCopyControls "CopyModulFilterControlManager", True
      SetModulCopyControls "CopyModules", True
   
      If m_OpenModules = 0 Then
         MsgBox "Codemodule wurden aktualisiert.", , CurrentApplication.ApplicationName
      End If
      
      m_OpenModules = 0
      
   End If
   
End Sub

Private Sub Form_Open(ByRef Cancel As Integer)
   Me.cbxLangCode.Value = L10n.LangCode
   L10n.TranslateControls Me.Controls
   Set m_L10nDict = L10n
   SetFormCaption
End Sub

Private Sub SetFormCaption()
   Me.Caption = "ACLib FilterForm Wizard  " & ChrW(&H25AA) & "  Version " & CurrentApplication.Version & " (" & L10n.Text("Filter-Klassen") & ": SVN-Rev. " & SvnRev & ")"
End Sub

Private Sub labCheckVersion_Click()
   
   Select Case L10n.ControlTag(Me.labCheckVersion.Tag)
      Case "unchecked"
         SetNewVersionInfo
      Case "NewVersionExists"
         OpenDownloadSource
      Case Else
         '
   End Select
   
End Sub

Private Sub labCheckVersion_MouseMove(ByRef Button As Integer, ByRef Shift As Integer, ByRef x As Single, ByRef y As Single)
   If L10n.ControlTag(Me.labCheckVersion.Tag) <> "VersionUptodate" Then
      modWinApi_Mouse.MouseCursor IDC_HAND
   End If
End Sub

Private Sub labCopyCaption_MouseDown(ByRef Button As Integer, ByRef Shift As Integer, ByRef x As Single, ByRef y As Single)

   If Button = 1 Or Button = 2 Then
      OpenReplaceModulesContextMenu Me.labCopyCaption, x, y
   End If

End Sub

Private Sub CheckModules(Optional ByVal WithControlManager As Boolean = True)
   
   Dim CheckOk As Boolean
   
On Error Resume Next
   
   m_OpenModules = 0

   With CodeModulImporter
      CheckOk = .CheckCodeModules("SqlTools")
      m_OpenModules = m_OpenModules + 1 + CheckOk
      SetModulCopyControls "CopyModulSqlTools", CheckOk
      
      CheckOk = .CheckCodeModules("StringCollection", "FilterStringBuilder")
      m_OpenModules = m_OpenModules + 1 + CheckOk
      SetModulCopyControls "CopyModulFilterStringBuilder", CheckOk
      
      If WithControlManager Then
         CheckOk = .CheckCodeModules("FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
         m_OpenModules = m_OpenModules + 1 + CheckOk
         SetModulCopyControls "CopyModulFilterControlManager", CheckOk
      End If
      
      CheckOk = (m_OpenModules = 0)
      SetModulCopyControls "CopyModules", CheckOk
   End With
   
End Sub

Private Sub cmdCopyModulSqlTools_Click()

   CodeModulImporter.TransferCodeModules "SqlTools"
   m_OpenModules = m_OpenModules - 1
   SetModulCopyControls "CopyModulSqlTools", True

End Sub

Private Sub cmdCopyModulFilterControlManager_Click()

   With CodeModulImporter
      .TransferCodeModules "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager"
      m_OpenModules = m_OpenModules - 1
      If Not .CheckCodeModules("StringCollection", "FilterStringBuilder") Then
         cmdCopyModulFilterStringBuilder_Click
      End If
      SetModulCopyControls "CopyModulFilterControlManager", True
   End With

End Sub

Private Sub cmdCopyModulFilterStringBuilder_Click()

   With CodeModulImporter
      .TransferCodeModules "StringCollection", "FilterStringBuilder"
      m_OpenModules = m_OpenModules - 1
      If Not .CheckCodeModules("SqlTools") Then
         cmdCopyModulSqlTools_Click
      End If
      SetModulCopyControls "CopyModulFilterStringBuilder", True
   End With

End Sub

Private Sub cmdCopyModules_Click()

   CodeModulImporter.TransferCodeModules "SqlTools", "StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager"
   SetModulCopyControls "CopyModulSqlTools", True
   SetModulCopyControls "CopyModulFilterStringBuilder", True
   SetModulCopyControls "CopyModulFilterControlManager", True
   SetModulCopyControls "CopyModules", True
   m_OpenModules = 0

End Sub

Private Sub SetModulCopyControls(ByVal ModulCodeName As String, ByVal Exists As Boolean)
   
   Dim ModuleCodeCaption As String
   Dim BorderStyle As Long
   
On Error Resume Next
   
   If Exists Then Me.sysFirst.SetFocus
   Me.Controls("cmd" & ModulCodeName).Enabled = Not Exists
   If Exists Then
      ModuleCodeCaption = "b"
      BorderStyle = 0
   Else
      ModuleCodeCaption = vbNullString
      BorderStyle = 1
   End If
   With Me.Controls("lab" & ModulCodeName)
      .Caption = ModuleCodeCaption
      .BorderStyle = BorderStyle
   End With
 
   If ModulCodeName <> "CopyModules" And m_OpenModules = 0 Then
      SetModulCopyControls "CopyModules", True
   End If
   
End Sub

Private Sub labCopyCaption_MouseMove(ByRef Button As Integer, ByRef Shift As Integer, ByRef x As Single, ByRef y As Single)
   modWinApi_Mouse.MouseCursor IDC_HAND
End Sub

Private Sub m_L10nDict_LanguageChanged()
   If Nz(Me.cbxLangCode.Value, vbNullString) <> L10n.LangCode Then
      Me.cbxLangCode.Value = L10n.LangCode
   End If
   SetFormCaption
   L10n.TranslateControls Me.Controls
End Sub

Private Sub ApplyFilterMethodOptions_AfterUpdate()

   With Me.cbxApplyFilterSubForm
      .Enabled = (Me.ApplyFilterMethodOptions = SubFormApplyFilterOption)
      If .Enabled = False Then .Value = Null
   End With
   
   SetFillFilterControlsFromDataSourceMode

   RefreshAddFilterButtonEnableMode

End Sub

Private Sub SetFillFilterControlsFromDataSourceMode()

   With Me.cmdFillFilterControlsFromDataSource
      Select Case Me.ApplyFilterMethodOptions
         Case 1
            .Enabled = True
         Case 2
            .Enabled = (Len(Nz(Me.cbxApplyFilterSubForm.Value, vbNullString)) > 0)
         Case Else
            .Enabled = False
      End Select
   
      If .Enabled Then
         .ControlTipText = vbNullString
      Else
         .ControlTipText = L10n.Text("Bitte zuerst in der 'ApplyFilter-Methode'-Option das Datenformular einstellen!")
      End If
   End With
   
End Sub

Private Sub LoadControlsFromForm(ByVal FormRef As Form)

   Dim ctl As Control

   ClearFilterCtlCombobox Me.cbxApplyFilterCtl
   ClearFilterCtlCombobox Me.cbxRemoveFilterCtl
   ClearFilterCtlCombobox Me.cbxAutoFilterCtl

   If FormRef Is Nothing Then
      Exit Sub
   End If

   Me.cbxApplyFilterCtl.AddItem FILTERFORMWIZARD_TEXT_CREATENEW
   Me.cbxRemoveFilterCtl.AddItem FILTERFORMWIZARD_TEXT_CREATENEW
   Me.cbxAutoFilterCtl.AddItem FILTERFORMWIZARD_TEXT_CREATENEW

   For Each ctl In FormRef.Controls
      Select Case ctl.ControlType
         Case AcControlType.acCommandButton
         
            Me.cbxApplyFilterCtl.AddItem ctl.Name
            Me.cbxRemoveFilterCtl.AddItem ctl.Name
         
         Case AcControlType.acCheckBox, AcControlType.acToggleButton
              
            Me.cbxAutoFilterCtl.AddItem ctl.Name
            

      End Select
   Next
   
   Me.sfrFilterControls.Form.InitFilterForm FormRef

End Sub

Private Sub ClearFilterCtlCombobox(ByVal CbxRef As ComboBox)
   With CbxRef
      .RowSource = vbNullString
      .Value = Null
   End With
End Sub

Private Sub SetNewVersionInfo()
   
   Dim AhProcParams(1) As Variant
   Dim AhResumeMode As ApplicationHandlerResumeModes
   Dim AhResumeMessage As Variant
   
   Call CurrentApplication.CallExtensionProcedure("AppVersion", "NewVersionExists", AhResumeMode, AhResumeMessage, AhProcParams)
   
   If AhResumeMode <> AppResumeMode_Completed Then
      If AhResumeMode = AppResumeMode_Error Then
      If Len(AhResumeMessage) > 0 Then
         MsgBox AhResumeMessage, vbExclamation, "Fehler bei Versionsprüfung"
      End If
      End If
      Exit Sub
   End If
   
   With Me.labCheckVersion
   If AhResumeMessage = False Then
      .Caption = L10n.Text("Aktuelle Version ist installiert")
      .Tag = "VersionUptodate" & L10n.LangSeparatorChar & "LANG:Wizard-Version prüfen"
      .ForeColor = 0
      .FontUnderline = False
   ElseIf AhResumeMessage = True Then
      .Caption = FormatText("Neue Version ({0}) verfügbar", AhProcParams(0))
      .ControlTipText = AhProcParams(1)
      .Tag = "NewVersionExists" & L10n.LangSeparatorChar & "LANG:Wizard-Version prüfen"
   Else
      
   End If
   End With
   
End Sub

Private Sub OpenDownloadSource()
   Application.FollowHyperlink APPLICATION_DOWNLOADSOURCE, , True, False
End Sub

Private Function GetCheckedControlName(ByVal ControlNameToCheck As String) As String
   GetCheckedControlName = Replace(ControlNameToCheck, " ", "_")
End Function

Private Sub RefreshCodeModulesFromSvnRepo(ByVal UseDraft As Boolean)

   With New ACLibWebImporter
   
      .UseDraftBranch = UseDraft
   
      If .CurrentSvnRev(True) = SvnRevMin Then
         If MsgBox("Es sind bereits alle Module auf dem neuesten Stand." & vbNewLine & "Trotzdem neu einlesen?", vbYesNo + vbDefaultButton2, CurrentApplication.ApplicationName) <> vbYes Then
            Exit Sub
         End If
      End If
      
      .UpdateCodeModules
   
   End With
   
   MsgBox "Codemodule wurden aktualisiert.", , CurrentApplication.ApplicationName
   
   SetFormCaption

End Sub