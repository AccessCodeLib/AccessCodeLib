Version =20
VersionRequired =20
Checksum =25855757
Begin Form
    NavigationButtons = NotDefault
    AllowDesignChanges = NotDefault
    ScrollBars =2
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =10050
    DatasheetFontHeight =11
    ItemSuffix =33
    Left =615
    Top =2025
    Right =10935
    Bottom =4995
    DatasheetGridlinesColor =15062992
    RecSrcDt = Begin
        0xc4d680b8ef58e440
    End
    RecordSource ="tabFilterControls"
    OnCurrent ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0085a901020000000c0000003886a901032e35631486a901472e35632e3e6ba3 ,
        0x010400069c00640353ef8001010009009a0b3408640001000f00580202000100 ,
        0x580203000100413400d6850c2810880cb888a9010c000000b5f95967b888a901 ,
        0xe81cfa0dcc880000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe210000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000009000640300000000000000000000000000000000 ,
        0x0000000000000000030000000000000000001000503403002888040000000000 ,
        0x0000000000000100000000000000000000000000000000002401df8c03000000 ,
        0x05000b00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000090000000534d544a0000000010008000 ,
        0x4d00530020005000750062006c0069007300680065007200200043006f006c00 ,
        0x6f00720020005000720069006e0074006500720000005265736f6c7574696f6e ,
        0x00363030647069005061676553697a650041340050616765526567696f6e0000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080023002b000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000467265655044465850313a00000000000000000000 ,
        0x0000000000000000000000
    End
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    DatasheetBackColor12 =-2147483643
    ShowPageMargins =0
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    PrtDevModeW = Begin
        0x000000001015490c61150000400000000cba1a019223e300000000001a00000c ,
        0x0001000000000000000000004090a90100000000f83be5017f0000000c000000 ,
        0x01040006dc00640353ef8001010009009a0b3408640001000f00580202000100 ,
        0x580203000100410034000000400dae77834d27bdfeffffff0c7da90126dcaa77 ,
        0xfc010000090000005b030000f87ca90100000000c000490c000000000815490c ,
        0x0a00000001000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe210000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000009000640300000000000000000000000000000000 ,
        0x0000000000000000030000000000000000001000503403002888040000000000 ,
        0x0000000000000100000000000000000000000000000000002401df8c03000000 ,
        0x05000b00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000090000000534d544a0000000010008000 ,
        0x4d00530020005000750062006c0069007300680065007200200043006f006c00 ,
        0x6f00720020005000720069006e0074006500720000005265736f6c7574696f6e ,
        0x00363030647069005061676553697a650041340050616765526567696f6e0000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNamesW = Begin
        0x04001f0027000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000460072006500650050004400460058005000 ,
        0x31003a0000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000
    End
    
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            ForeThemeColorIndex =2
            ForeTint =60.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =3
            BorderShade =90.0
            ThemeFontIndex =1
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =3
            BorderShade =90.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            Height =285
            BackColor =15064278
            Name ="Formularkopf"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =2
            BackTint =20.0
            Begin
                Begin Label
                    OverlapFlags =93
                    Left =5831
                    Width =2040
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =11573124
                    Name ="Bezeichnungsfeld1"
                    Caption ="Steuerelement"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    LayoutCachedLeft =5831
                    LayoutCachedWidth =7871
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =85
                    Left =56
                    Width =2157
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =11573124
                    Name ="Bezeichnungsfeld4"
                    Caption ="Datenfeld"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    LayoutCachedLeft =56
                    LayoutCachedWidth =2213
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =85
                    Left =3746
                    Width =1815
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =11573124
                    Name ="Bezeichnungsfeld6"
                    Caption ="Vergleichsoperator"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    LayoutCachedLeft =3746
                    LayoutCachedWidth =5561
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =85
                    Left =2268
                    Width =1380
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =11573124
                    Name ="Bezeichnungsfeld10"
                    Caption ="Datentyp"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    LayoutCachedLeft =2268
                    LayoutCachedWidth =3648
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =87
                    Left =7875
                    Width =2175
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =11573124
                    Name ="Bezeichnungsfeld13"
                    Caption ="weitere Steuerelemente"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    LayoutCachedLeft =7875
                    LayoutCachedWidth =10050
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
            End
        End
        Begin Section
            Height =642
            Name ="Detailbereich"
            AlternateBackColor =16250871
            AlternateBackThemeColorIndex =1
            AlternateBackShade =97.0
            BackThemeColorIndex =1
            Begin
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    ListWidth =3402
                    Left =5831
                    Top =29
                    Width =2041
                    Height =285
                    FontSize =10
                    TabIndex =3
                    BorderColor =13553360
                    ForeColor =3484194
                    ConditionalFormat = Begin
                        0x0100000090000000010000000100000000000000000000001700000000000000 ,
                        0x00000000ffffff00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x5b006300620043007200650061007400650043006f006e00740072006f006c00 ,
                        0x5d003d00540072007500650000000000
                    End
                    Name ="fcControl"
                    ControlSource ="Control"
                    RowSourceType ="Value List"
                    ColumnWidths ="3402"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    LayoutCachedLeft =5831
                    LayoutCachedTop =29
                    LayoutCachedWidth =7872
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000000000000000000ffffff00160000005b00 ,
                        0x6300620043007200650061007400650043006f006e00740072006f006c005d00 ,
                        0x3d005400720075006500000000000000000000000000000000000000000000
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =3746
                    Top =29
                    Width =1803
                    Height =285
                    FontSize =10
                    TabIndex =2
                    BoundColumn =1
                    BorderColor =13553360
                    ForeColor =3484194
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"40\""
                    Name ="fcRelationalOperator"
                    ControlSource ="RelationalOperator"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tabRelationalOperators.RelationalOperator, tabRelationalOperators.Relatio"
                        "nalOperatorCode FROM tabRelationalOperators ORDER BY tabRelationalOperators.Orde"
                        "rPos;"
                    ColumnWidths ="1134;0"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    LayoutCachedLeft =3746
                    LayoutCachedTop =29
                    LayoutCachedWidth =5549
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
                Begin ComboBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2268
                    Top =29
                    Width =1353
                    Height =285
                    FontSize =10
                    TabIndex =1
                    BoundColumn =1
                    BorderColor =13553360
                    ForeColor =3484194
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"40\""
                    Name ="fcDataType"
                    ControlSource ="DataType"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tabSqlFieldDataTypes.SqlFieldDataType, tabSqlFieldDataTypes.SqlFieldDataT"
                        "ypeCode FROM tabSqlFieldDataTypes ORDER BY tabSqlFieldDataTypes.SqlFieldDataType"
                        ";"
                    ColumnWidths ="1134;0"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    LayoutCachedLeft =2268
                    LayoutCachedTop =29
                    LayoutCachedWidth =3621
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =5465
                    Top =390
                    TabIndex =7
                    BorderColor =13553360
                    Name ="fcRelationalOperatorNot"
                    ControlSource ="RelationalOperatorNot"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =5465
                    LayoutCachedTop =390
                    LayoutCachedWidth =5725
                    LayoutCachedHeight =630
                    Begin
                        Begin Label
                            OverlapFlags =127
                            Left =5135
                            Top =360
                            Width =330
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            ForeColor =11573124
                            Name ="Bezeichnungsfeld15"
                            Caption ="Not"
                            FontName ="Tahoma"
                            GridlineColor =10921638
                            LayoutCachedLeft =5135
                            LayoutCachedTop =360
                            LayoutCachedWidth =5465
                            LayoutCachedHeight =600
                            ThemeFontIndex =-1
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =4181
                    Top =390
                    TabIndex =5
                    BorderColor =13553360
                    Name ="fcWildCardSuffix"
                    ControlSource ="WildCardSuffix"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =4181
                    LayoutCachedTop =390
                    LayoutCachedWidth =4441
                    LayoutCachedHeight =630
                    Begin
                        Begin Label
                            OverlapFlags =119
                            Left =3746
                            Top =360
                            Width =435
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            ForeColor =11573124
                            Name ="Bezeichnungsfeld18"
                            Caption ="xxx*"
                            FontName ="Tahoma"
                            GridlineColor =10921638
                            LayoutCachedLeft =3746
                            LayoutCachedTop =360
                            LayoutCachedWidth =4181
                            LayoutCachedHeight =600
                            ThemeFontIndex =-1
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =247
                    Left =4886
                    Top =390
                    TabIndex =6
                    BorderColor =13553360
                    Name ="fcWildCardPrefix"
                    ControlSource ="WildCardPrefix"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =4886
                    LayoutCachedTop =390
                    LayoutCachedWidth =5146
                    LayoutCachedHeight =630
                    Begin
                        Begin Label
                            OverlapFlags =119
                            Left =4451
                            Top =360
                            Width =435
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            ForeColor =11573124
                            Name ="Bezeichnungsfeld20"
                            Caption ="*xxx"
                            FontName ="Tahoma"
                            GridlineColor =10921638
                            LayoutCachedLeft =4451
                            LayoutCachedTop =360
                            LayoutCachedWidth =4886
                            LayoutCachedHeight =600
                            ThemeFontIndex =-1
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =56
                    Top =29
                    Width =2160
                    Height =285
                    FontSize =10
                    BorderColor =13553360
                    ForeColor =3484194
                    Name ="fcDataField"
                    ControlSource ="DataField"
                    FontName ="Tahoma"
                    GridlineColor =10921638

                    LayoutCachedLeft =56
                    LayoutCachedTop =29
                    LayoutCachedWidth =2216
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =7938
                    Top =29
                    Width =2056
                    Height =285
                    FontSize =10
                    TabIndex =4
                    BorderColor =13553360
                    ForeColor =3484194
                    Name ="fcControl2"
                    ControlSource ="Control2"
                    StatusBarText ="Mehrere Steuerelemente mit Komma trennen"
                    FontName ="Tahoma"
                    ConditionalFormat = Begin
                        0x0100000090000000010000000100000000000000000000001700000000000000 ,
                        0x00000000ffffff00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x5b006300620043007200650061007400650043006f006e00740072006f006c00 ,
                        0x5d003d00540072007500650000000000
                    End
                    GridlineColor =10921638

                    LayoutCachedLeft =7938
                    LayoutCachedTop =29
                    LayoutCachedWidth =9994
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000000000000000000ffffff00160000005b00 ,
                        0x6300620043007200650061007400650043006f006e00740072006f006c005d00 ,
                        0x3d005400720075006500000000000000000000000000000000000000000000
                    End
                End
                Begin CheckBox
                    OverlapFlags =93
                    Left =6222
                    Top =390
                    TabIndex =8
                    BorderColor =13553360
                    Name ="cbCreateControl"
                    ControlSource ="CreateControl"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =6222
                    LayoutCachedTop =390
                    LayoutCachedWidth =6482
                    LayoutCachedHeight =630
                    Begin
                        Begin Label
                            OverlapFlags =255
                            Left =5831
                            Top =360
                            Width =414
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            Name ="Bezeichnungsfeld24"
                            Caption ="Neu"
                            FontName ="Tahoma"
                            GridlineColor =10921638
                            LayoutCachedLeft =5831
                            LayoutCachedTop =360
                            LayoutCachedWidth =6245
                            LayoutCachedHeight =600
                            ThemeFontIndex =-1
                            ForeThemeColorIndex =0
                            ForeTint =100.0
                        End
                    End
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =247
                    Left =5839
                    Top =336
                    Width =4137
                    Height =300
                    TabIndex =9
                    BorderColor =13553360
                    Name ="ogNewControlType"
                    ControlSource ="ControlType"
                    OnEnter ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =5839
                    LayoutCachedTop =336
                    LayoutCachedWidth =9976
                    LayoutCachedHeight =636
                    Begin
                        Begin OptionButton
                            OverlapFlags =119
                            Left =6689
                            Top =396
                            OptionValue =109
                            BorderColor =13553360
                            Name ="ogfldTextbox"
                            GridlineColor =10921638

                            LayoutCachedLeft =6689
                            LayoutCachedTop =396
                            LayoutCachedWidth =6949
                            LayoutCachedHeight =636
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =6919
                                    Top =336
                                    Width =876
                                    Height =300
                                    BorderColor =16777215
                                    ForeColor =11573124
                                    Name ="Bezeichnungsfeld30"
                                    Caption ="TextBox"
                                    GridlineColor =10921638
                                    LayoutCachedLeft =6919
                                    LayoutCachedTop =336
                                    LayoutCachedWidth =7795
                                    LayoutCachedHeight =636
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =119
                            Left =7992
                            Top =396
                            TabIndex =1
                            OptionValue =111
                            BorderColor =13553360
                            Name ="ogfldCombobox"
                            GridlineColor =10921638

                            LayoutCachedLeft =7992
                            LayoutCachedTop =396
                            LayoutCachedWidth =8252
                            LayoutCachedHeight =636
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =8219
                                    Top =336
                                    Width =1032
                                    Height =300
                                    BorderColor =16777215
                                    ForeColor =11573124
                                    Name ="Bezeichnungsfeld32"
                                    Caption ="ComboBox"
                                    GridlineColor =10921638
                                    LayoutCachedLeft =8219
                                    LayoutCachedTop =336
                                    LayoutCachedWidth =9251
                                    LayoutCachedHeight =636
                                End
                            End
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="Formularfuß"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------------------------------------------------------------
' Form: frmFilterFormWizard_SF_Controls
'---------------------------------------------------------------------------------------
'/**
' \author       Josef Poetzl
' <summary>
' Wizard-Form-Unterformular für FilterControls-Import
' </summary>
' <remarks></remarks>
'**/
'---------------------------------------------------------------------------------------
'<codelib>
'  <file>_codelib/addins/FilterFormWizard/frmFilterFormWizard_SF_Controls.frm</file>
'  <license>_codelib/license.bas</license>
'  <use>_codelib/addins/shared/FormDesigner.cls</use>
'</codelib>
'---------------------------------------------------------------------------------------
'
Option Compare Database
Option Explicit

#Const ADODB_EARLYBINDING = 0

#If ADODB_EARLYBINDING = 1 Then

#Else
   Const adOpenKeyset As Long = 1
   Const adUseClient As Long = 3
   Const adLockOptimistic As Long = 3
#End If

Public Sub InitFilterForm(ByVal frm As Form)

   InitDataSource
   LoadControlsFromForm frm

End Sub

Private Sub InitDataSource()

#If ADODB_EARLYBINDING = 1 Then
   Dim rst As ADODB.Recordset
#Else
   Dim rst As Object
#End If

   Set rst = CreateObject("ADODB.Recordset")
   rst.CursorLocation = adUseClient
   rst.Open "select * from tabFilterControls", CodeProject.Connection, adOpenKeyset, adLockOptimistic
   Set rst.ActiveConnection = Nothing

   Set Me.Recordset = rst

End Sub

Private Sub LoadControlsFromForm(ByVal frm As Form)

   Dim ctl As Control

   Me.fcControl.RowSource = vbNullString

   If frm Is Nothing Then
      Exit Sub
   End If

   For Each ctl In frm.Controls
      Select Case ctl.ControlType
         Case AcControlType.acTextBox, AcControlType.acComboBox, _
              AcControlType.acCheckBox, AcControlType.acListBox, _
              AcControlType.acOptionButton, AcControlType.acOptionGroup, _
              AcControlType.acToggleButton

            Me.fcControl.AddItem ctl.Name

      End Select
   Next

End Sub

Public Sub AddControlsToImporter(ByVal Importer As FilterFormCodeImporter, ByVal FilterFormName As String)
   
#If ADODB_EARLYBINDING = 1 Then
   Dim rst As ADODB.Recordset
#Else
   Dim rst As Object
#End If

   Dim ControlCode As String
   Dim RelOp As String

   Set rst = Me.Recordset.Clone
   If rst.RecordCount = 0 Then
      Exit Sub
   End If
   
   Dim DataFieldName As String
   Dim ControlName As String, ControlName2 As String
   
   Dim SaveForm As Boolean

   With rst
      Do While Not .EOF

         RelOp = Nz(.Fields("RelationalOperator"), vbNullString)
         If .Fields("WildCardSuffix") = True Then
            RelOp = RelOp & " + SQL_Add_WildCardSuffix"
         End If
         If .Fields("WildCardPrefix") = True Then
            RelOp = RelOp & " + SQL_Add_WildCardPrefix"
         End If
         If .Fields("RelationalOperatorNot") = True Then
            RelOp = "SQL_Not + " & RelOp
         End If
         
         DataFieldName = Nz(.Fields("DataField").Value, vbNullString)

         If .Fields("CreateControl").Value = True Then
            InsertFormControl FilterFormName, Nz(.Fields("ControlType").Value, acTextBox), DataFieldName, RelOp, ControlName, ControlName2
            SaveForm = True
         Else
            ControlName = Nz(.Fields("Control").Value, vbNullString)
            ControlName2 = Nz(.Fields("Control2"), vbNullString)
         End If

         Importer.AddFilterControlDefinition DataFieldName, _
                                             Nz(.Fields("DataType"), vbNullString), _
                                             RelOp, _
                                             ControlName, _
                                             ControlName2

         .MoveNext

      Loop
   End With
   
   If SaveForm Then
      DoCmd.Save acForm, FilterFormName
   End If

End Sub

Private Sub InsertFormControl(ByVal FilterFormName As String, ControlType As String, ByVal DataFieldName As String, ByVal RelOp As String, ByRef ControlName As String, ByRef Control2Name As String)

   Const DistanceBetweenControls As Long = 72

   Dim ctl As Control
   
   Dim ControlCaption As String, Control2Caption As String
   Dim CreateControl2 As Boolean

   ControlCaption = DataFieldName
   If StrComp(Left(DataFieldName, 1), UCase(Left(DataFieldName, 1)), vbBinaryCompare) <> 0 Then
      DataFieldName = UCase(Left(DataFieldName, 1)) & Mid(DataFieldName, 2)
   End If
   ControlName = "fctl" & DataFieldName
   
   With New FormDesigner
   
      Set .Form = Forms(FilterFormName)
      
      If (RelOp Like "*SQL_Between*") Then
         CreateControl2 = True
         Control2Caption = ControlCaption & " bis"
         Control2Name = ControlName & "Max"
         ControlName = ControlName & "Min"
         ControlCaption = ControlCaption & " von"
      End If
      
      Set ctl = .AddControl(ControlType, ControlName, acHeader, , , , , DistanceBetweenControls, True, ControlCaption)
      ControlName = ctl.Name
      If CreateControl2 Then
         Set ctl = ctl.Controls(0)
         Control2Name = .AddControl(ControlType, Control2Name, acHeader, ctl.Left + ctl.Width + DistanceBetweenControls, ctl.Top, , , DistanceBetweenControls, True, Control2Caption).Name
      End If
      
   End With

End Sub

Private Sub cbCreateControl_AfterUpdate()

   Dim CreateNewControl As Boolean
   
   CreateNewControl = Me.cbCreateControl.Value

   With Me.ogNewControlType
      .TabStop = .Value
      If CreateNewControl Then
         .Value = acTextBox
      Else
         .Value = Null
      End If
      
   End With
   
End Sub

Private Sub Form_Current()
   Me.ogNewControlType.TabStop = Nz(Me.cbCreateControl.Value)
End Sub

Private Sub ogNewControlType_Enter()
   Me.ogNewControlType.Locked = (Me.cbCreateControl.Value = False)
End Sub