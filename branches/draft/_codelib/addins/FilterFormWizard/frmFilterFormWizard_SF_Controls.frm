Version =20
VersionRequired =20
Checksum =-14903921
Begin Form
    NavigationButtons = NotDefault
    AllowDesignChanges = NotDefault
    ScrollBars =2
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =10050
    DatasheetFontHeight =11
    ItemSuffix =21
    Left =4515
    Top =3135
    Right =15105
    Bottom =6360
    DatasheetGridlinesColor =15062992
    RecSrcDt = Begin
        0xc4d680b8ef58e440
    End
    RecordSource ="tabFilterControls"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0072842f0400000001000000ec811b001800000060841b0014821b00ac8d2f38 ,
        0x010400069c00440353ef8001010009009a0b3408640001000f00580202000100 ,
        0x58020300010041340044ef024c841b00c444ef0244821b00e188ab2fe044ef02 ,
        0xe888ab2fefd60000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000007000440300000000000000000000000000000000 ,
        0x0000000000000000030000000000000000001000503403002888040000000000 ,
        0x0000000000000100000000000000000000000000000000002401df8c03000000 ,
        0x05000b00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000070000000534d544a0000000010006000 ,
        0x46007200650065005000440046005f005800500000005265736f6c7574696f6e ,
        0x00363030647069005061676553697a650041340050616765526567696f6e0000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080013001b000100000000000000000000000000000000000000004672656550 ,
        0x44465850313a0000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000
    End
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    DatasheetBackColor12 =-2147483643
    ShowPageMargins =0
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    PrtDevModeW = Begin
        0x0000ffffbc791b0034030000007a1b005001e6050c8ea4380016e6057a71c675 ,
        0x7f000000c8739e2f09000000509f1b0006799e2f64cf792f972e794d00000000 ,
        0x01040006dc00440353ef8001010009009a0b3408640001000f00580202000100 ,
        0x580203000100410034000000814aaa2f0a0000000c0000000016e6050016e605 ,
        0xfb15e60500000000687a1b000000e605088b9c01ac791b0002000000287e1b00 ,
        0x051ae37754470000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000007000440300000000000000000000000000000000 ,
        0x0000000000000000030000000000000000001000503403002888040000000000 ,
        0x0000000000000100000000000000000000000000000000002401df8c03000000 ,
        0x05000b00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000070000000534d544a0000000010006000 ,
        0x46007200650065005000440046005f005800500000005265736f6c7574696f6e ,
        0x00363030647069005061676553697a650041340050616765526567696f6e0000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNamesW = Begin
        0x04000f0017000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000460072006500650050004400460058005000 ,
        0x31003a0000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000
    End
    
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            ForeThemeColorIndex =2
            ForeTint =60.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =3
            BorderShade =90.0
            ThemeFontIndex =1
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =3
            BorderShade =90.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            Height =285
            BackColor =15849926
            Name ="Formularkopf"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =2
            BackTint =20.0
            Begin
                Begin Label
                    OverlapFlags =93
                    Left =5831
                    Width =2040
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =13995605
                    Name ="Bezeichnungsfeld1"
                    Caption ="Steuerelement"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    LayoutCachedLeft =5831
                    LayoutCachedWidth =7871
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =85
                    Left =56
                    Width =2265
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =13995605
                    Name ="Bezeichnungsfeld4"
                    Caption ="Datenfeld"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    LayoutCachedLeft =56
                    LayoutCachedWidth =2321
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =85
                    Left =3915
                    Width =1815
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =13995605
                    Name ="Bezeichnungsfeld6"
                    Caption ="Vergleichsoperator"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    LayoutCachedLeft =3915
                    LayoutCachedWidth =5730
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =85
                    Left =2437
                    Width =1380
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =13995605
                    Name ="Bezeichnungsfeld10"
                    Caption ="Datentyp"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    LayoutCachedLeft =2437
                    LayoutCachedWidth =3817
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =87
                    Left =7875
                    Width =2175
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =13995605
                    Name ="Bezeichnungsfeld13"
                    Caption ="weitere Steuerelemente"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    LayoutCachedLeft =7875
                    LayoutCachedWidth =10050
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
            End
        End
        Begin Section
            Height =680
            Name ="Detailbereich"
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    ListWidth =3402
                    Left =5831
                    Top =29
                    Width =2041
                    Height =285
                    FontSize =10
                    TabIndex =1
                    BorderColor =12835293
                    ForeColor =4138256
                    Name ="fcControl"
                    ControlSource ="Control"
                    RowSourceType ="Value List"
                    ColumnWidths ="3402"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    LayoutCachedLeft =5831
                    LayoutCachedTop =29
                    LayoutCachedWidth =7872
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =3915
                    Top =29
                    Width =1803
                    Height =285
                    FontSize =10
                    TabIndex =2
                    BoundColumn =1
                    BorderColor =12835293
                    ForeColor =4138256
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"40\""
                    Name ="fcRelationalOperator"
                    ControlSource ="RelationalOperator"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tabRelationalOperators.RelationalOperator, tabRelationalOperators.Relatio"
                        "nalOperatorCode FROM tabRelationalOperators ORDER BY tabRelationalOperators.Orde"
                        "rPos;"
                    ColumnWidths ="1134;0"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    LayoutCachedLeft =3915
                    LayoutCachedTop =29
                    LayoutCachedWidth =5718
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
                Begin ComboBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2437
                    Top =29
                    Width =1353
                    Height =285
                    FontSize =10
                    TabIndex =4
                    BoundColumn =1
                    BorderColor =12835293
                    ForeColor =4138256
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"40\""
                    Name ="fcDataType"
                    ControlSource ="DataType"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tabSqlFieldDataTypes.SqlFieldDataType, tabSqlFieldDataTypes.SqlFieldDataT"
                        "ypeCode FROM tabSqlFieldDataTypes ORDER BY tabSqlFieldDataTypes.SqlFieldDataType"
                        ";"
                    ColumnWidths ="1134;0"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    LayoutCachedLeft =2437
                    LayoutCachedTop =29
                    LayoutCachedWidth =3790
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =5944
                    Top =390
                    TabIndex =5
                    BorderColor =12835293
                    Name ="fcRelationalOperatorNot"
                    ControlSource ="RelationalOperatorNot"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =5944
                    LayoutCachedTop =390
                    LayoutCachedWidth =6204
                    LayoutCachedHeight =630
                    Begin
                        Begin Label
                            OverlapFlags =119
                            Left =5614
                            Top =360
                            Width =330
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            ForeColor =13995605
                            Name ="Bezeichnungsfeld15"
                            Caption ="Not"
                            FontName ="Tahoma"
                            GridlineColor =10921638
                            LayoutCachedLeft =5614
                            LayoutCachedTop =360
                            LayoutCachedWidth =5944
                            LayoutCachedHeight =600
                            ThemeFontIndex =-1
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =4350
                    Top =396
                    TabIndex =6
                    BorderColor =12835293
                    Name ="fcWildCardSuffix"
                    ControlSource ="WildCardSuffix"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =4350
                    LayoutCachedTop =396
                    LayoutCachedWidth =4610
                    LayoutCachedHeight =636
                    Begin
                        Begin Label
                            OverlapFlags =119
                            Left =3915
                            Top =366
                            Width =435
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            ForeColor =13995605
                            Name ="Bezeichnungsfeld18"
                            Caption ="xxx*"
                            FontName ="Tahoma"
                            GridlineColor =10921638
                            LayoutCachedLeft =3915
                            LayoutCachedTop =366
                            LayoutCachedWidth =4350
                            LayoutCachedHeight =606
                            ThemeFontIndex =-1
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =5194
                    Top =390
                    TabIndex =7
                    BorderColor =12835293
                    Name ="fcWildCardPrefix"
                    ControlSource ="WildCardPrefix"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =5194
                    LayoutCachedTop =390
                    LayoutCachedWidth =5454
                    LayoutCachedHeight =630
                    Begin
                        Begin Label
                            OverlapFlags =119
                            Left =4759
                            Top =360
                            Width =435
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            ForeColor =13995605
                            Name ="Bezeichnungsfeld20"
                            Caption ="*xxx"
                            FontName ="Tahoma"
                            GridlineColor =10921638
                            LayoutCachedLeft =4759
                            LayoutCachedTop =360
                            LayoutCachedWidth =5194
                            LayoutCachedHeight =600
                            ThemeFontIndex =-1
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =56
                    Top =29
                    Width =2268
                    Height =285
                    FontSize =10
                    BorderColor =12835293
                    ForeColor =4138256
                    Name ="fcDataField"
                    ControlSource ="DataField"
                    FontName ="Tahoma"
                    GridlineColor =10921638

                    LayoutCachedLeft =56
                    LayoutCachedTop =29
                    LayoutCachedWidth =2324
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =7938
                    Top =29
                    Width =2056
                    Height =285
                    FontSize =10
                    TabIndex =3
                    BorderColor =12835293
                    ForeColor =4138256
                    Name ="fcControl2"
                    ControlSource ="Control2"
                    StatusBarText ="Mehrere Steuerelemente mit Komma trennen"
                    FontName ="Tahoma"
                    GridlineColor =10921638

                    LayoutCachedLeft =7938
                    LayoutCachedTop =29
                    LayoutCachedWidth =9994
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="Formularfuß"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------------------------------------------------------------
' Form: frmFilterFormWizard_SF_Controls
'---------------------------------------------------------------------------------------
'/**
' \author       Josef Poetzl
' <summary>
' Wizard-Form-Unterformular für FilterControls-Import
' </summary>
' <remarks></remarks>
'**/
'---------------------------------------------------------------------------------------
'<codelib>
'  <file>_codelib/addins/FilterFormWizard/frmFilterFormWizard_SF_Controls.frm</file>
'  <license>_codelib/license.bas</license>
'</codelib>
'---------------------------------------------------------------------------------------
'

#Const ADODB_EARLYBINDING = 0

#If ADODB_EARLYBINDING = 1 Then

#Else
   Const adOpenKeyset As Long = 1
   Const adUseClient As Long = 3
   Const adLockOptimistic As Long = 3
#End If

Option Compare Database
Option Explicit

Public Sub InitFilterForm(ByVal frm As Form)

   InitDataSource

   LoadControlsFromForm frm

End Sub

Private Sub InitDataSource()

#If ADODB_EARLYBINDING = 1 Then
   Dim rst As ADODB.Recordset
#Else
   Dim rst As Object
#End If

   Set rst = CreateObject("ADODB.Recordset")
   rst.CursorLocation = adUseClient
   rst.Open "select * from tabFilterControls", CodeProject.Connection, adOpenKeyset, adLockOptimistic
   Set rst.ActiveConnection = Nothing

   Set Me.Recordset = rst

End Sub

Private Sub LoadControlsFromForm(ByVal frm As Form)

   Dim ctl As Control

   Me.fcControl.RowSource = vbNullString

   If frm Is Nothing Then
      Exit Sub
   End If

   For Each ctl In frm.Controls
      Select Case ctl.ControlType
         Case AcControlType.acTextBox, AcControlType.acComboBox, _
              AcControlType.acCheckBox, AcControlType.acListBox, _
              AcControlType.acOptionButton, AcControlType.acOptionGroup, _
              AcControlType.acToggleButton

            Me.fcControl.AddItem ctl.Name

      End Select
   Next

End Sub

Public Sub AddControlsToImporter(ByVal Importer As Object)
   
#If ADODB_EARLYBINDING = 1 Then
   Dim rst As ADODB.Recordset
#Else
   Dim rst As Object
#End If

   Dim ControlCode As String
   Dim RelOp As String

   Set rst = Me.Recordset.Clone
   If rst.RecordCount = 0 Then
      Exit Sub
   End If

   With rst
      Do While Not .EOF

         RelOp = Nz(.Fields("RelationalOperator"), vbNullString)
         If .Fields("WildCardSuffix") = True Then
            RelOp = RelOp & " + SQL_Add_WildCardSuffix"
         End If
         If .Fields("WildCardPrefix") = True Then
            RelOp = RelOp & " + SQL_Add_WildCardPrefix"
         End If
         If .Fields("RelationalOperatorNot") = True Then
            RelOp = "SQL_Not + " & RelOp
         End If

         Importer.AddFilterControlDefinition Nz(.Fields("DataField"), vbNullString), _
                                             Nz(.Fields("DataType"), vbNullString), _
                                             RelOp, _
                                             Nz(.Fields("Control"), vbNullString), _
                                             Nz(.Fields("Control2"), vbNullString)

         .MoveNext

      Loop
   End With

End Sub