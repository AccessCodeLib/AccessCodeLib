Version =19
VersionRequired =19
Checksum =-17876925
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    TabularCharSet =238
    BorderStyle =3
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =10215
    DatasheetFontHeight =11
    ItemSuffix =51
    Left =4200
    Top =2280
    Right =17295
    Bottom =10200
    OnUnload ="[Event Procedure]"
    RecSrcDt = Begin
        0x212b6fd80e9ce340
    End
    Caption ="Access Code Library - Import Wizard"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x000000000c5120010c512000ddd9427134522000fc5c20008452200008522000 ,
        0x0104f0a49c00a00743ef8005010009009a0b3408000001000f00c80002000200 ,
        0xc800020001000000fc5c20008452200008522000d8d1a22f0000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001010000010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010000000100000009000000b30d0000b0090000020000000100000001000000 ,
        0x9dffffff02000000020000000100000000000000010100000200000002000000 ,
        0x0300000005000000000000000000000001000000010100000101000000000000 ,
        0x0000000000000000000000000000000001000000000000000100000000000000 ,
        0x0100000001000000000000000200000002000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000002000000 ,
        0x0100000008000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000001000000010000009dffffff01000000 ,
        0x0101000009000000000000000000000000000000284e4f4e4529000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000a005000000000000 ,
        0xc2010000c2010000900100000000000030000022417269616c00000000000000 ,
        0x0000000000000000000000000000000000000000000000003200000000000000 ,
        0x0000000000000000284e4f4e4529000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000a005000000000000c2010000c201000090010000 ,
        0x0000000030000022417269616c00000000000000000000000000000000000000 ,
        0x0000000000000000000000003200000000000000000000000000000000000000 ,
        0xf0a497bc4c65786d61726b20533330302d533430302053657269657300000000 ,
        0x0000000038010000f0a497bc9dff580200000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000080000 ,
        0x0100000000000000ffff00000000000000000000000000000000630000000000 ,
        0x0100010001000100000002000100f802f6047008e01000000000000001000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000536f6674776172655c4c65786d61726b496e6b6a6574000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000010001000100010000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000001000100 ,
        0x0100010000000000000000000000000000000000000001009dff04009dffffff ,
        0xfefffcff00000000000000000000000001005802040058022c01580258020000 ,
        0x0000000000000000000001005802040058022c015802c0120000000000000000 ,
        0x00000000010058020400580258025802b0040000000000000000000000000100 ,
        0x060004000600010002000500000000000000000000000000f0a497bc
    End
    PrtDevNames = Begin
        0x080021003b000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000005553423030 ,
        0x3100
    End
    OnLoad ="[Event Procedure]"
    
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
        End
        Begin Line
            BorderLineStyle =0
            Width =1701
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Calibri"
        End
        Begin OptionButton
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
        End
        Begin TextBox
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
        End
        Begin ListBox
            BorderLineStyle =0
            Width =1701
            Height =1417
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
        End
        Begin ToggleButton
            Width =283
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
        End
        Begin Section
            Height =7937
            Name ="Detail"
            GUID = Begin
                0xf7378bf1e579c5409d7a702d0d22f4f7
            End
            Begin
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =9690
                    Top =90
                    Width =397
                    Height =397
                    TabIndex =2
                    Name ="cmdSelectLocalRepository"
                    Caption ="Select Root"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadad00000000000adada ,
                        0x003333333330adad0b03333333330ada0fb03333333330ad0bfb03333333330a ,
                        0x0fbfb000000000000bfbfbfbfb0adada0fbfbfbfbf0dadad0bfb0000000adada ,
                        0xa000adadadad000ddadadadadadad00aadadadad0dad0d0ddadadadad000dada ,
                        0xadadadadadadadad000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Lokales Root-Verzeichnis auswählen"
                    GUID = Begin
                        0x7a375b3d4e7ab64aa4b92d9318fa2f75
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =83
                    Left =9688
                    Top =1050
                    Width =397
                    Height =397
                    TabIndex =5
                    Name ="cmdSelectFile"
                    Caption ="&Select File"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadad00000000000adada ,
                        0x003333333330adad0b03333333330ada0fb03333333330ad0bfb03333333330a ,
                        0x0fbfb000000000000bfbfbfbfb0adada0fbfbfbfbf0dadad0bfb0000000adada ,
                        0xa000adadadad000ddadadadadadad00aadadadad0dad0d0ddadadadad000dada ,
                        0xadadadadadadadad
                    End
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Datei(en) mit Auswahldialog anfügen"
                    GUID = Begin
                        0xe62794268747e54e9d3b2819c30094ff
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =87
                    TextFontCharSet =238
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4702
                    Top =120
                    Width =4896
                    Height =315
                    FontWeight =700
                    TabIndex =1
                    LeftMargin =29
                    Name ="txtLocalRepositoryPath"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0xffffa1d5ad2703478979ee0aca0822fd
                    End
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =113
                            Top =120
                            Width =4575
                            Height =315
                            Name ="Label5"
                            Caption ="Lokales Root-Verzeichnis der Code-Bibliothek:"
                            GUID = Begin
                                0x260de0a075a52c4a847dc3c64f35b307
                            End
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    AccessKey =65
                    IMESentenceMode =3
                    Left =113
                    Top =1075
                    Width =9021
                    Height =315
                    TabIndex =3
                    Name ="txtFileString"
                    StatusBarText ="Pfad ab Root-Verzeichnis"
                    OnKeyDown ="[Event Procedure]"
                    OnGotFocus ="[Event Procedure]"
                    GUID = Begin
                        0x05058d9cecfbbb4ea43e85b2775cd26f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =113
                            Top =735
                            Width =4410
                            Height =315
                            Name ="Label11"
                            Caption ="Datei &anfügen"
                            GUID = Begin
                                0xdce6936cc22dab4b8aaf87981939126a
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =9195
                    Top =1050
                    Width =397
                    Height =397
                    TabIndex =4
                    Name ="cmdAddFile"
                    Caption ="+"
                    OnClick ="[Event Procedure]"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Datei aus Textzeile anfügen"
                    GUID = Begin
                        0x039cfae327f89243b5a5953b895bbd58
                    End
                End
                Begin ListBox
                    OverlapFlags =247
                    AccessKey =68
                    MultiSelect =2
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =113
                    Top =1814
                    Width =9979
                    Height =3232
                    TabIndex =6
                    BoundColumn =1
                    Name ="lstImportFiles"
                    RowSourceType ="Table/Query"
                    ColumnWidths ="2835;3402"
                    AfterUpdate ="[Event Procedure]"
                    OnDblClick ="[Event Procedure]"
                    OnKeyDown ="[Event Procedure]"
                    OnLostFocus ="[Event Procedure]"
                    ControlTipText ="Liste der zu importierenden Dateien\015\012Markierte Einträge können mit {Entf}-"
                        "Taste aus der Liste entfernt werden."
                    GUID = Begin
                        0x97cc1de5cfe2a04b8cdb64735afe62b6
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =120
                            Top =1470
                            Width =2280
                            Height =315
                            Name ="Label13"
                            Caption ="Ausgewählte &Dateien:"
                            GUID = Begin
                                0x60c0884bcdad91479b2f6fa6a23c332f
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    AccessKey =73
                    Left =7035
                    Top =7155
                    Width =2925
                    Height =555
                    TabIndex =9
                    Name ="cmdImportFiles"
                    Caption ="Dateien &importieren"
                    OnClick ="[Event Procedure]"
                    OnMouseDown ="[Event Procedure]"
                    GUID = Begin
                        0x0752e8199e039a46b1633c490cc5b6d9
                    End
                End
                Begin OptionGroup
                    OverlapFlags =223
                    AccessKey =77
                    Left =113
                    Top =5220
                    Width =9982
                    Height =2616
                    TabIndex =7
                    Name ="ogImportMode"
                    DefaultValue ="0"
                    GUID = Begin
                        0x91a1a06315224448bd037c8cd2b7e9fe
                    End
                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =177
                            Top =5277
                            Width =6630
                            Height =315
                            Name ="lblImportMode"
                            Caption ="Import-&Modus"
                            GUID = Begin
                                0xf7e99834a0cc8d4e9ebbec0c245e4b62
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =352
                            Top =6050
                            OptionValue =0
                            Name ="Option17"
                            GUID = Begin
                                0xa20e4892bdcb844cab1b25b010367d37
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =577
                                    Top =6020
                                    Width =6240
                                    Height =315
                                    Name ="Label18"
                                    Caption ="vorhandene Elemente nicht überschreiben"
                                    GUID = Begin
                                        0x0503a60b3ca0f64cb332cac0d90780e8
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =352
                            Top =6440
                            OptionValue =2
                            Name ="Option19"
                            GUID = Begin
                                0xc6bc8f322a47ad4683e8d970a2655c8c
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =582
                                    Top =6410
                                    Width =6225
                                    Height =315
                                    Name ="Label20"
                                    Caption ="vorhandene Elemente überschreiben"
                                    GUID = Begin
                                        0x5e1091f5ed76ae45b156edf033d42e35
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =352
                            Top =7295
                            OptionValue =1
                            Name ="Option21"
                            GUID = Begin
                                0xd9544bbca994c74196f99278c4a147bf
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =577
                                    Top =7265
                                    Width =6240
                                    Height =315
                                    Name ="Label22"
                                    Caption ="nur die ausgewählte Datei(en) importieren"
                                    GUID = Begin
                                        0xc2155cb67d013a4881e9d3a464c25a81
                                    End
                                End
                            End
                        End
                    End
                End
                Begin Label
                    OverlapFlags =215
                    Left =285
                    Top =5670
                    Width =6525
                    Height =285
                    Name ="Label23"
                    Caption ="fehlende Abhängigkeiten automatisch ergänzen"
                    GUID = Begin
                        0xebb7fc3d0c887544a4a8c5348dff83e0
                    End
                End
                Begin Label
                    OverlapFlags =215
                    Left =283
                    Top =6916
                    Width =6525
                    Height =285
                    Name ="Label24"
                    Caption ="keine Abhängigkeitsprüfung"
                    GUID = Begin
                        0x990473fa44f0624db2af405d80e5513b
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    Enabled = NotDefault
                    OverlapFlags =215
                    Left =7035
                    Top =5896
                    Width =2925
                    Height =555
                    TabIndex =8
                    Name ="Command25"
                    Caption ="Abhängigkeiten anzeigen"
                    GUID = Begin
                        0xe40621db1bc93147b26953b8f737fc02
                    End
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =215
                    TextFontCharSet =238
                    TextAlign =2
                    Left =7035
                    Top =6720
                    Width =2895
                    Height =315
                    FontWeight =700
                    ForeColor =8210719
                    Name ="labInfo"
                    Caption ="Dateien wurden importiert"
                    GUID = Begin
                        0xe6d8e143d98b804d9762731252545906
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    Name ="sysFirst"
                    GUID = Begin
                        0x41701c76b83aea418068794d55739952
                    End
                End
                Begin CheckBox
                    OverlapFlags =215
                    AccessKey =84
                    Left =7035
                    Top =5340
                    TabIndex =10
                    Name ="chkImportTests"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    ControlTipText ="Die Testklassen der importierten Code-Modulen ebenfalls importieren"
                    GUID = Begin
                        0x7262df6ddc0c3a4f89103b45350f36f9
                    End
                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =7311
                            Top =5280
                            Width =2730
                            Height =315
                            Name ="Bezeichnungsfeld32"
                            Caption ="inkl. &Test-Klassen"
                            GUID = Begin
                                0x33a5f8b40df7ad41a4d1f01be3066e80
                            End
                        End
                    End
                End
                Begin CommandButton
                    Transparent = NotDefault
                    Cancel = NotDefault
                    OverlapFlags =85
                    Left =10185
                    Width =29
                    Height =29
                    TabIndex =11
                    Name ="cmdClose"
                    Caption ="Schließen"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x950857d9af4f2d4999b6fb2515640201
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =93
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6979
                    Top =2136
                    Width =3120
                    Height =2910
                    TabIndex =12
                    BorderColor =0
                    Name ="txtCodeModuleDescription"
                    GUID = Begin
                        0xfd1cc5ab6fc5024dbe9b6cf4925d1a14
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    FontUnderline = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =93
                    BackStyle =0
                    IMESentenceMode =3
                    Left =6979
                    Top =1814
                    Width =3120
                    Height =285
                    TabIndex =13
                    BorderColor =0
                    Name ="txtCodeModuleName"
                    GUID = Begin
                        0x6eef0d90281fdd4a90c14881cc72f01f
                    End
                End
                Begin ToggleButton
                    OverlapFlags =85
                    Left =6975
                    Top =1500
                    Width =3105
                    Height =273
                    FontSize =8
                    TabIndex =14
                    ForeColor =4138256
                    Name ="tbViewCodeModuleDescription"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    Caption ="Beschreibung anzeigen"
                    GUID = Begin
                        0x8ac695bd55ec8f448547c7aa22b0feae
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------------------------------------------------------------
' Form: ACLibImportWizardForm
'---------------------------------------------------------------------------------------
'/**
' <summary>
' Wizard-Formular für Import der CodeLib-Elemente
' </summary>
' <remarks></remarks>
'\ingroup ACLibAddInImportWizard
'**/
'---------------------------------------------------------------------------------------
'<codelib>
'  <file>_codelib/addins/ImportWizard/ACLibImportWizardForm.frm</file>
'  <description>Maske für Import-Wizard</description>
'  <use>base/modErrorHandler.bas</use>
'  <use>_codelib/addins/ImportWizard/defGlobal_ACLibImportWizard.bas</use>
'  <use>api/winapi/modWinAPI.bas</use>
'  <use>api/winapi/WinApiShortcutMenu.cls</use>
'  <use>file/modFiles.bas</use>
'  <use>data/dao/TempDbHandler.cls</use>
'  <use>data/modSQL_Tools.bas</use>
'</codelib>
'---------------------------------------------------------------------------------------
'
Option Compare Database
Option Explicit

' verwendete Erweiterungen
Private Const EXTENSION_KEY_AppFile As String = "AppFile"
Private Const APPFILE_PROPNAME_AppIcon As String = "AppIcon"

Private Const TEMPDB_TABNAME As String = "tRepositoryFiles"
Private Const TEMPDB_TABDDL As String = "create table " & TEMPDB_TABNAME & " (LocalRepositoryPath varchar(255) primary key, ObjectName varchar(255), Description memo)"
Private m_TempDb As TempDbHandler

Private m_LastSelectionID As Variant

Private Sub bindTextbox(ByRef tb As Textbox, Optional ByVal BaseFolderPath As String = vbNullString)

   'Latebindung, damit ApplicationHandler_DirTextbox-Klasse nicht vorhanden sein muss
   Dim objDirTextbox As Object ' = ApplicationHandler_DirTextbox

   'Standard-Instanz verwenden:
On Error GoTo HandleErr

   Set objDirTextbox = CurrentApplication.Extensions("DirTextbox")
   
   'Textbox binden
   If Not (objDirTextbox Is Nothing) Then
      Set objDirTextbox.Textbox = tb
      objDirTextbox.BaseFolderPath = BaseFolderPath
   End If

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "bindTextbox", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select

End Sub

Private Sub chkImportTests_AfterUpdate()
   CurrentACLibConfiguration.ImportTestsDefaultValue = Nz(Me.chkImportTests.Value, False)
End Sub

Private Sub cmdAddFile_Click()

On Error GoTo HandleErr

   addFileFromFileName Me.txtFileString & ""

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "cmdAddFile_Click", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub

Private Sub cmdClose_Click()
   DoCmd.Close acForm, Me.Name
End Sub

Private Sub cmdImportFiles_Click()

   Dim fileNameArray() As String
   Dim arraySize As Long, i As Long
   Dim lb As ListBox
   
On Error GoTo HandleErr

   Set lb = Me.lstImportFiles
   
   arraySize = lb.ListCount - 1
   
   If arraySize < 0 Then
      MsgBox "Es sind keine Dateien ausgewählt.", vbInformation
      Exit Sub
   End If
   
   ReDim fileNameArray(arraySize)
   
   For i = 0 To arraySize
      fileNameArray(i) = lb.ItemData(i)
   Next
   
   Me.labInfo.Caption = "Importvorgang läuft ..."
   Me.labInfo.Visible = True
   Me.Repaint
   
   CurrentACLibFileManager.ImportRepositoryFiles fileNameArray, Nz(Me.ogImportMode.Value, 0), Nz(Me.chkImportTests.Value, False)
   
   Me.labInfo.Caption = "Dateien wurden importiert"
   Me.Repaint
   
   TempDb.Execute "delete from " & TEMPDB_TABNAME
   lb.Requery
   
   Me.SetFocus

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "cmdImportFiles_Click", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select

End Sub

Private Sub cmdImportFiles_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)

On Error GoTo HandleErr

   If Button = 2 Then
      OpenImportFileShortcutMenu
      Button = 0
   End If

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "cmdImportFiles_MouseDown", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub

Private Function OpenImportFileShortcutMenu() As Long

   Dim mnu As WinApiShortcutMenu
On Error GoTo HandleErr

   Set mnu = New WinApiShortcutMenu

   With mnu
      Set .MenuControl = Me.cmdImportFiles
      Set .AccessForm = Me
      .ControlSection = acDetail
      
      .AddMenuItem 11, "Alle Elemente aus der Codebibliothek importieren", , 1
      .AddMenuItem 10, "Import", MF_POPUP, 1
      
      .AddMenuItem -1, "", MF_SEPARATOR
      
      .AddMenuItem 31, "Alle vorhandenen Elemente exportieren", , 2
      .AddMenuItem 32, "Alle vorhandenen Module exportieren", , 2
      .AddMenuItem 30, "Export", MF_POPUP, 2
      
      
      .AddMenuItem -2, "", MF_SEPARATOR
      .AddMenuItem 21, "Alle vorhandenen Elemente aktualisieren"
      .AddMenuItem 22, "Alle vorhandenen Module aktualisieren"

      
   End With
   
   Select Case mnu.OpenMenu
      Case 11
         CurrentACLibFileManager.ImportAllFilesFromRepository Nz(Me.ogImportMode.Value, clim_ImportAllUsedItems)
      Case 21
         CurrentACLibFileManager.RefreshAll Nz(Me.ogImportMode.Value, clim_ImportMissingItems), True
      Case 22
         CurrentACLibFileManager.RefreshAllModules Nz(Me.ogImportMode.Value, clim_ImportMissingItems), True
      Case 31
         CurrentACLibFileManager.ExportAll
      Case 32
         CurrentACLibFileManager.ExportAllModules
      Case Else
         '
   End Select
   
   Set mnu = Nothing

ExitHere:
On Error Resume Next
   Exit Function

HandleErr:
   Select Case HandleError(Err.Number, "ShowImportFileShortcutMenu", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Function

Private Sub cmdSelectFile_Click()
   
   Dim strStartFolder As String
   Dim strFiles As String
   Dim fileArray() As String
   Dim pos As Long

On Error GoTo HandleErr

   strStartFolder = Replace(Me.txtFileString.Value & "", "/", "\")
   If Len(strStartFolder) > 0 Then
      Do While Left$(strStartFolder, 1) = "\"
         strStartFolder = Mid$(strStartFolder, 1)
         If Len(strStartFolder) = 0 Then Exit Do
      Loop
   End If
   
   strStartFolder = CurrentLocalRepositoryPath & strStartFolder
   Do While Not DirExists(strStartFolder)
      pos = InStrRev(strStartFolder, "\")
      If pos = 0 Then Exit Do
      strStartFolder = Left$(strStartFolder, pos - 1)
   Loop

   strFiles = SelectFile(strStartFolder, , , True)
   If Len(strFiles) = 0 Then
      Exit Sub
   End If
   
   fileArray = Split(strFiles, "|")
   addFiles fileArray

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "cmdSelectFile_Click", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub

Private Sub addFiles(ByRef fileArray() As String)
   
   Dim lb As ListBox
   Dim i As Long
   Dim arraySize As Long
   
   Dim cli As CodeLibInfo
   
On Error GoTo HandleErr

   arraySize = UBound(fileArray)
   
   Set lb = Me.lstImportFiles
   For i = 0 To arraySize
      cli = CurrentACLibFileManager.GetCodeLibInfoFromFilePath(fileArray(i))
      TempDb.Execute "insert into " & TEMPDB_TABNAME & " (ObjectName, LocalRepositoryPath, Description) VALUES (" & _
                           SqlTools.TextToSqlText(cli.Name) & ", " & SqlTools.TextToSqlText(getLocalRepositoryPath(fileArray(i))) & _
                           ", " & SqlTools.TextToSqlText(cli.Description) & ")", dbFailOnError
   Next
   
   lb.Requery
   Me.labInfo.Visible = (lb.ListCount = 0)
   
ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "cmdSelectFile_Click", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub

Private Function getLocalRepositoryPath(ByRef fullPath As String) As String

On Error GoTo HandleErr

   getLocalRepositoryPath = Replace(GetRelativPathFromFullPath(Replace(fullPath, "/", "\"), CurrentLocalRepositoryPath, False), "\", "/")

ExitHere:
On Error Resume Next
   Exit Function

HandleErr:
   Select Case HandleError(Err.Number, "getLocalRepositoryPath", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select

End Function

Private Property Get CurrentLocalRepositoryPath() As String

On Error GoTo HandleErr

   CurrentLocalRepositoryPath = Me.txtLocalRepositoryPath.Value

ExitHere:
On Error Resume Next
   Exit Property

HandleErr:
   Select Case HandleError(Err.Number, "CurrentLocalRepositoryPath", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Property

Private Sub cmdSelectLocalRepository_Click()
   
   Dim selectedRepositoryPath As String
   
On Error GoTo HandleErr

   selectedRepositoryPath = SelectFolder(Nz(Me.txtLocalRepositoryPath, vbNullString), "Lokalen Repository-Ordner auswählen", , False, 1)
   
   If Len(selectedRepositoryPath) > 0 Then
      If Right$(selectedRepositoryPath, 1) = "\" Then
         selectedRepositoryPath = Left$(selectedRepositoryPath, Len(selectedRepositoryPath) - 1)
      End If
      
      setLocalRepositoryPath selectedRepositoryPath
      
   End If
   
ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "cmdSelectLocalRepository_Click", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub

Private Sub setEnableMode()

On Error GoTo HandleErr

   Me.cmdImportFiles.Enabled = Len(Me.txtLocalRepositoryPath.Value & vbNullString) > 0

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "setEnableMode", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select

End Sub

Private Sub Form_Load()

On Error GoTo HandleErr

   Me.Caption = CurrentApplication.ApplicationTitle & "  " & ChrW(&H25AA) & "  Version " & CurrentApplication.Version
   loadIconFromAppFiles
   
   Me.txtLocalRepositoryPath.Value = CurrentACLibConfiguration.LocalRepositoryPath
   Me.chkImportTests.Value = CurrentACLibConfiguration.ImportTestsDefaultValue
   
   EnableCodeModuleDescription Me.tbViewCodeModuleDescription.Value
   
   setEnableMode
   
ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "Form_Load", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select

End Sub

Private Sub Form_Unload(Cancel As Integer)
On Error Resume Next
   If Not (m_TempDb Is Nothing) Then
      Me.lstImportFiles.RowSource = vbNullString
      DBEngine.Idle dbRefreshCache
      m_TempDb.Dispose
   End If
   DisposeCurrentApplicationHandler
End Sub

Private Sub lstImportFiles_AfterUpdate()
   RefreshCodeModuleDescription
End Sub

Private Sub lstImportFiles_DblClick(Cancel As Integer)
   OpenSelectItemFormImportFilesListboxInTextViewer
End Sub

Private Sub lstImportFiles_KeyDown(KeyCode As Integer, Shift As Integer)

On Error GoTo HandleErr

   If KeyCode = vbKeyDelete Then
      removeSelectedItemsFromListbox
   ElseIf KeyCode = vbKeyF2 Then
      OpenSelectItemFormImportFilesListboxInTextViewer
   End If

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "lstImportFiles_KeyDown", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub

Private Sub removeSelectedItemsFromListbox()

   Dim lb As ListBox
   Dim selectedItem As Variant
   Dim strItemFilter As String

On Error GoTo HandleErr

   Set lb = Me.lstImportFiles
   
   For Each selectedItem In lb.ItemsSelected
      strItemFilter = ", " & SqlTools.TextToSqlText(lb.Column(1, selectedItem))
   Next
   
   If Len(strItemFilter) <= 2 Then
      Exit Sub
   End If
   
   strItemFilter = Mid$(strItemFilter, 3)
   TempDb.Execute "delete from " & TEMPDB_TABNAME & " where LocalRepositoryPath IN (" & strItemFilter & ")"
   
   lb.Requery
   
   RefreshCodeModuleDescription

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "removeSelectedItemsFormListbox", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select

End Sub

Private Sub lstImportFiles_LostFocus()
On Error Resume Next
   m_LastSelectionID = Me.lstImportFiles.Column(1)
   Me.lstImportFiles = Null
End Sub

Private Sub tbViewCodeModuleDescription_AfterUpdate()
   EnableCodeModuleDescription Me.tbViewCodeModuleDescription.Value
   If Len(m_LastSelectionID) > 0 Then
      SelectListItem m_LastSelectionID
   End If
End Sub

Private Sub SelectListItem(ByVal sItemID As String)
   Dim i As Long
   Dim lb As ListBox
   Set lb = Me.lstImportFiles
   For i = 0 To (lb.ListCount - 1)
      If lb.Column(1, i) = sItemID Then
         lb.SetFocus
         lb.Selected(i) = True
         RefreshCodeModuleDescriptionFromID sItemID, lb.Column(0, i)
         Exit Sub
      End If
   Next
End Sub

Private Sub txtFileString_GotFocus()
On Error Resume Next
   bindTextbox Me.txtFileString, CurrentLocalRepositoryPath
End Sub

Private Sub txtFileString_KeyDown(KeyCode As Integer, Shift As Integer)

On Error GoTo HandleErr

   If KeyCode = vbKeyReturn Then
      If Me.txtFileString.Text = ".." Then
         Exit Sub
      ElseIf Replace(Right$(Me.txtFileString.Text, 3), "/", "\") = "\.." Then
         Exit Sub
      Else
         addFileFromFileName Me.txtFileString.Text
         KeyCode = 0
      End If
   ElseIf KeyCode = vbKeyF2 Then
      OpenRepositoryFileInTextViewer Me.txtFileString.Text
      KeyCode = 0
   End If

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "txtFileString_KeyDown", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub

Private Sub addFileFromFileName(ByVal fileString As String)

On Error GoTo HandleErr

   fileString = Trim$(Replace(fileString, "/", "\"))
   If Len(fileString) > 0 Then
      Do While Left$(fileString, 1) = "\"
         fileString = Trim$(Mid$(fileString, 2))
         If Len(fileString) = 0 Then Exit Sub
      Loop
      addFile CurrentLocalRepositoryPath & fileString
   End If

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "addFileFromFileName", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub


Private Function addFile(ByRef newFileName As String) As Boolean

   Dim fileArray(0) As String
   
On Error GoTo HandleErr

   If Len(newFileName) = 0 Then
      Exit Function
   End If
   
   newFileName = Replace(newFileName, "\\", "\")

   If Not FileExists(newFileName) Then
      MsgBox "Diese Datei ist nicht vorhanden", vbInformation
      addFile = False
      Exit Function
   End If
   
   fileArray(0) = newFileName
   addFiles fileArray
   
   addFile = True

ExitHere:
On Error Resume Next
   Exit Function

HandleErr:
   Select Case HandleError(Err.Number, "addFile", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Function

Private Sub txtLocalRepositoryPath_AfterUpdate()

On Error GoTo HandleErr

   setLocalRepositoryPath Me.txtLocalRepositoryPath & vbNullString

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "txtLocalRepositoryPath_AfterUpdate", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub

Private Sub setLocalRepositoryPath(ByRef newRoot As String)

On Error GoTo HandleErr

   CurrentACLibConfiguration.LocalRepositoryPath = newRoot
   
   'damit mögliche Modifikationen aus CurrentACLibConfiguration übernommen werden:
   Me.txtLocalRepositoryPath.Value = CurrentACLibConfiguration.LocalRepositoryPath
   
   setEnableMode

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "setLocalRepositoryPath", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub

Private Sub txtLocalRepositoryPath_BeforeUpdate(Cancel As Integer)

   Dim strNewPath As String
On Error GoTo HandleErr

   strNewPath = Me.txtLocalRepositoryPath & ""
   
   If Len(strNewPath) > 0 Then
      Cancel = Not DirExists(strNewPath)
      If Cancel Then
         MsgBox "Verzeichnis ist nicht vorhanden", vbInformation
      End If
   End If
   
ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "txtLocalRepositoryPath_BeforeUpdate", Err.Description, ACLibErrorHandlerMode.aclibErrMsgBox)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select

End Sub

Private Sub loadIconFromAppFiles()

   Dim strIconFilePath As String
   Dim strIconFileName As String
   
   'Latebindung, damit ApplicationHandler_AppFile-Klasse nicht vorhanden sein muss
   Dim objAppFile As Object ' ... ApplicationHandler_AppFile

On Error GoTo HandleErr

   If Val(SysCmd(acSysCmdAccessVer)) <= 9 Then 'Abbruch, da Ac00 sonst abstürzt
      Exit Sub
   End If

   Set objAppFile = CurrentApplication.Extensions(EXTENSION_KEY_AppFile)
   
   'Textbox binden
   If Not (objAppFile Is Nothing) Then
      strIconFileName = ACLibIconFileName
      strIconFilePath = CurrentACLibConfiguration.ACLibConfigDirectory

      If Len(ACLibIconFileName) = 0 Then 'nur Temp-Datei erzeugen
         strIconFileName = Me.Name & ".ico"
         strIconFilePath = TempPath
      End If
      
      strIconFilePath = strIconFilePath & strIconFileName
      
      If Len(Dir$(strIconFilePath)) = 0 Then
         If Not objAppFile.CreateAppFile(APPFILE_PROPNAME_AppIcon, strIconFilePath) Then
            Exit Sub
         End If
      End If
      
      WinAPI.Image.SetFormIconFromFile Me, strIconFilePath
      
   End If

ExitHere:
On Error Resume Next
   Exit Sub

HandleErr:
   Select Case HandleError(Err.Number, "loadIconFromAppFiles", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Sub

Private Property Get TempDb() As TempDbHandler

On Error GoTo HandleErr

   If m_TempDb Is Nothing Then
      Set m_TempDb = New TempDbHandler
      m_TempDb.CreateDatabase True, True
      m_TempDb.CreateTable TEMPDB_TABNAME, TEMPDB_TABDDL
      Me.lstImportFiles.RowSource = "select ObjectName, LocalRepositoryPath FROM [" & m_TempDb.CurrentDatabase.Name & "]." & TEMPDB_TABNAME
   End If
   Set TempDb = m_TempDb

ExitHere:
   Exit Property

HandleErr:
   Select Case HandleError(Err.Number, "TempDb", Err.Description, ACLibErrorHandlerMode.aclibErrRaise)
   Case ACLibErrorResumeMode.aclibErrResume
      Resume
   Case ACLibErrorResumeMode.aclibErrResumeNext
      Resume Next
   Case Else
      Resume ExitHere
   End Select
   
End Property

Private Sub OpenSelectItemFormImportFilesListboxInTextViewer()
   OpenRepositoryFileInTextViewer Me.lstImportFiles.Column(1)
End Sub

Private Sub OpenRepositoryFileInTextViewer(ByVal sRelativeFilePath As String)
   Dim fullPath As String
   fullPath = CurrentACLibFileManager.GetRepositoryFullPath(sRelativeFilePath)
   WinAPI.Shell.Execute fullPath, "open"
End Sub

Private Sub EnableCodeModuleDescription(ByVal bViewDescription As Boolean)

   With Me.lstImportFiles
      If bViewDescription Then
         .Width = Me.lblImportMode.Left + Me.lblImportMode.Width - .Left
         RefreshCodeModuleDescription
      Else
         .Width = Me.InsideWidth - 2 * .Left
      End If
   End With
   
   Me.txtCodeModuleDescription.Visible = bViewDescription
   Me.txtCodeModuleName.Visible = bViewDescription
   
End Sub

Private Sub RefreshCodeModuleDescription()
   RefreshCodeModuleDescriptionFromID Nz(Me.lstImportFiles.Column(1), vbNullString), Nz(Me.lstImportFiles.Column(0), vbNullString)
End Sub

Private Sub RefreshCodeModuleDescriptionFromID(ByVal sLocalRepositoryPath As String, ByVal sName As String)

   Dim strDescription As String
   If Len(sLocalRepositoryPath) > 0 Then
      strDescription = Nz(m_TempDb.LookupSQL("select Description from " & TEMPDB_TABNAME & " where LocalRepositoryPath = " & SqlTools.TextToSqlText(sLocalRepositoryPath)), vbNullString)
   End If
   Me.txtCodeModuleName.Value = sName
   Me.txtCodeModuleDescription.Value = strDescription
   
End Sub