<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>FilterStringBuilder</title><link rel="stylesheet" type="text/css" href="../../../../styles/main.css" /><script type="text/javascript" src="../../../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Topic233"></a><div class="CTopic TClass LVisualBasic first">
 <div class="CTitle"><span class="Qualifier">data.&#8203;sql.</span>&#8203;FilterStringBuilder</div>
 <div class="CBody"><p>Create SQL criteria (filter) expression</p><div class="CHeading">Author</div><p>Josef Poetzl</p></div>
</div>

<a name="Class_support"></a><a name="Topic242"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">Class support</div>
</div>

<a name="Self"></a><a name="Topic245"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">Self</div>
 <div class="CBody"><p>Reference to Me (current instance of FilterStringBuilder class)</p></div>
</div>

<a name="Config"></a><a name="Topic250"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">Config</div>
</div>

<a name="DefaultConcatOperator"></a><a name="Topic241"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">DefaultConcatOperator</div>
 <div class="CBody"><p>The default concat operator for the instance</p></div>
</div>

<a name="SqlTool"></a><a name="Topic248"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">SqlTool</div>
 <div class="CBody"><p>SqlTools instance to be used (if not set, clone of global SqlTools instance is used)</p></div>
</div>

<a name="ConfigSqlFormat"></a><a name="Topic244"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">ConfigSqlFormat</div>
 <div id="NDPrototype244" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Friend Sub ConfigSqlFormat(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal SqlDateFormat&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String,</td></tr><tr><td class="PModifierQualifier first">ByVal SqlBooleanTrueString&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String,</td></tr><tr><td class="PModifierQualifier first">ByVal SqlWildCardString&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Config sql text output format for specific sql dialect</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">SqlDateFormat</td><td class="CDLDefinition"><p>output string format for date values</p></td></tr><tr><td class="CDLEntry">SqlBooleanTrueString</td><td class="CDLDefinition"><p>output string format for boolean values</p></td></tr><tr><td class="CDLEntry">SqlWildCardString</td><td class="CDLDefinition"><p>wildcard string (e.g. * .. dao, % .. T-SQL)</p></td></tr></table></div>
</div>

<a name="ConfigSqlStatement"></a><a name="Topic249"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">ConfigSqlStatement</div>
 <div id="NDPrototype249" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Friend Sub ConfigSqlStatement(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal SqlPrefix&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal SqlSuffix&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal ConditionPrefix&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal IgnoreSqlPreSuffixIfEmptyFilter&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Auxiliary function for setting SQL texts if this class is used in other filter builder classes.&nbsp; (e.g. in form.filter.FilterControlCollection)</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">SqlPrefix</td><td class="CDLDefinition"><p>Is placed before the FilterString for ToString output (ToString = m_SqlPrefix &amp; FilterString &amp; m_SqlSuffix)</p></td></tr><tr><td class="CDLEntry">SqlSuffix</td><td class="CDLDefinition"><p>Is placed after the FilterString for ToString output (ToString = m_SqlPrefix &amp; FilterString &amp; m_SqlSuffix)</p></td></tr><tr><td class="CDLEntry">ConditionPrefix</td><td class="CDLDefinition"><p>Is placed before the filter condition (but only if the filter condition is &gt; &quot;&quot;).</p></td></tr><tr><td class="CDLEntry">IgnoreSqlPreSuffixIfEmptyFilter</td><td class="CDLDefinition"><p>True: SqlPrefix + SqlSuffix are not set for empty FilterString</p></td></tr></table></div>
</div>

<a name="Build_Criteria"></a><a name="Topic234"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">Build Criteria</div>
</div>

<a name="Add"></a><a name="Topic239"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Add</div>
 <div id="NDPrototype239" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Sub Add(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal FieldName&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal FieldDataType&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">SqlFieldDataType,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal RelationalOperator&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">SqlRelationalOperators,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal Value&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal Value2&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">Null,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal IgnoreValue&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">Null</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Add filter criteria definition (uses: data.SqlTools.BuildCriteria)</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">FieldName</td><td class="CDLDefinition"><p>Field name in the data source to be filtered</p></td></tr><tr><td class="CDLEntry">RelationalOperator</td><td class="CDLDefinition"><p>Relational operator (=, &lt;=, etc.)</p></td></tr><tr><td class="CDLEntry">Value</td><td class="CDLDefinition"><p>Filter value (can be a single value or an array of values)</p></td></tr><tr><td class="CDLEntry">Value2</td><td class="CDLDefinition"><p>Optional 2nd filter value (for Between)</p></td></tr><tr><td class="CDLEntry">IgnoreValue</td><td class="CDLDefinition"><p>The value for which no filter condition is to be created. (Array transfer of values possible), Default: Null</p></td></tr></table></div>
</div>

<a name="AddCriteria"></a><a name="Topic240"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">AddCriteria</div>
 <div id="NDPrototype240" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Sub AddCriteria(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal Criteria&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Add filter criteria (String)</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Criteria</td><td class="CDLDefinition"><p>Criteria string to append</p></td></tr></table></div>
</div>

<a name="NewConditionGroup"></a><a name="Topic236"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">NewConditionGroup</div>
 <div id="NDPrototype236" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function NewConditionGroup(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal ConcatOperator&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">SqlLogicalOperator</td></tr></table></td><td class="PAfterParameters">) As FilterStringBuilder</td></tr></table></div></div>
 <div class="CBody"><table class="CDefinitionList"><tr><td class="CDLEntry">New filter condition group</td><td class="CDLDefinition"><p>e.g. for Or group: ( a = 1 and (x = 2 or x &gt;= 10) )</p></td></tr></table><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">ConcatOperator</td><td class="CDLDefinition"><p>[SQL_And (default), SQL_Or, SQL_CommaSeparator] .. valid within the new group</p></td></tr></table><div class="CHeading">Returns</div><p>FilterStringBuilder instance for new group</p></div>
</div>

<a name="AddSubSelectCriteria"></a><a name="Topic237"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">AddSubSelectCriteria</div>
 <div id="NDPrototype237" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function AddSubSelectCriteria(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal FieldName&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal RelationalOperator&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">SqlRelationalOperators,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal SelectFromText&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal IgnoreIfSubSelectHasNoCriteria&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal UseWhereReplacementTextInFromText&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal SubSelectConcatOperator&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">SqlLogicalOperator</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">SqlLogicalOperator.SQL_And</td></tr></table></td><td class="PAfterParameters">) As FilterStringBuilder</td></tr></table></div></div>
 <div class="CBody"><table class="CDefinitionList"><tr><td class="CDLEntry">New filter condition group for a sub select</td><td class="CDLDefinition"><p>e.g. ( a = 1 and x In (select n&nbsp; from tab123) )</p></td></tr></table><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">FieldName</td><td class="CDLDefinition"><p>Data field name to compare</p></td></tr><tr><td class="CDLEntry">RelationalOperator</td><td class="CDLDefinition"><p>Relational operator for sub select: usually In(...)</p></td></tr><tr><td class="CDLEntry">SelectFromText</td><td class="CDLDefinition"><p>Sql text for sub select (without where, except UseWhereReplacementTextInFromText is used)</p></td></tr><tr><td class="CDLEntry">IgnoreIfSubSelectHasNoCriteria</td><td class="CDLDefinition"><p>True = Ignore subselect criterion if no filter values were transferred</p></td></tr><tr><td class="CDLEntry">UseWhereReplacementTextInFromText</td><td class="CDLDefinition"><p>Replace [Where] with Where condition string ... is required for Group By-SQL, for example.</p></td></tr><tr><td class="CDLEntry">SubSelectConcatOperator</td><td class="CDLDefinition"><p>[SQL_And (default), SQL_Or, SQL_CommaSeparator] .. valid within the new group</p></td></tr></table><div class="CHeading">Returns</div><p>FilterStringBuilder instance for new sub select group</p></div>
</div>

<a name="AddExistsCriteria"></a><a name="Topic238"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">AddExistsCriteria</div>
 <div id="NDPrototype238" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function AddExistsCriteria(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal SelectFromText&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal IgnoreIfExistsStatementHasNoCriteria&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal SubSelectConcatOperator&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">SqlLogicalOperator</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">SqlLogicalOperator.SQL_And,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal UseNotExists&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False</td></tr></table></td><td class="PAfterParameters">) As FilterStringBuilder</td></tr></table></div></div>
 <div class="CBody"><table class="CDefinitionList"><tr><td class="CDLEntry">New filter condition group for a exits sub select</td><td class="CDLDefinition"><p>e.g. ( a = 1 and exists (select * from tab123 where t = a and y = 123) )</p></td></tr></table><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">SelectFromText</td><td class="CDLDefinition"><p>Sql text for sub select (without where, except UseWhereReplacementTextInFromText is used)</p></td></tr><tr><td class="CDLEntry">IgnoreIfExistsStatementHasNoCriteria</td><td class="CDLDefinition"><p>True = Ignore subselect criterion if no filter values were transferred</p></td></tr><tr><td class="CDLEntry">SubSelectConcatOperator</td><td class="CDLDefinition"><p>[SQL_And (default), SQL_Or, SQL_CommaSeparator] .. valid within the new group</p></td></tr><tr><td class="CDLEntry">UseNotExists</td><td class="CDLDefinition"><p>use not exists (..): default: false = exists (...)</p></td></tr></table><div class="CHeading">Returns</div><p>FilterStringBuilder instance for new exists group</p></div>
</div>

<a name="Output"></a><a name="Topic252"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">Output</div>
</div>

<a name="ToString"></a><a name="Topic235"></a><div class="CTopic TFunction LVisualBasic last">
 <div class="CTitle">ToString</div>
 <div id="NDPrototype235" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function ToString(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">Optional ByVal ConcatOperator&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">SqlLogicalOperator</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">SqlLogicalOperator.[_SQL_Default],</td></tr><tr><td class="PModifierQualifier first">Optional ByVal IgnoreDuplicateFilters&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False</td></tr></table></td><td class="PAfterParameters">) As String</td></tr></table></div></div>
 <div class="CBody"><p>Output criteria to String</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">ConcatOperator</td><td class="CDLDefinition"><p>[SQL_And (default), SQL_Or, SQL_CommaSeparator]</p></td></tr><tr><td class="CDLEntry">IgnoreDuplicateFilters</td><td class="CDLDefinition"><p>Do not output duplicate filter criteria</p></td></tr></table><div class="CHeading">Returns</div><p>Criteria/filter string</p></div>
</div>

</body></html>