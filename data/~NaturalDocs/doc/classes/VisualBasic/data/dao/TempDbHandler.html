<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>TempDbHandler</title><link rel="stylesheet" type="text/css" href="../../../../styles/main.css" /><script type="text/javascript" src="../../../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Topic2"></a><div class="CTopic TClass LVisualBasic first">
 <div class="CTitle"><span class="Qualifier">data.&#8203;dao.</span>&#8203;TempDbHandler</div>
 <div class="CBody"><p>Creates and manages a database file (mdb/accb) for temporary tables</p><div class="CHeading">Author</div><p>Josef Poetzl</p></div>
</div>

<a name="Events"></a><a name="Topic3"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">Events</div>
</div>

<a name="ErrorMissingDbConnection"></a><a name="Topic4"></a><div class="CTopic TEvent LVisualBasic">
 <div class="CTitle">ErrorMissingDbConnection</div>
 <div class="CBody"><p>Event message when DbConnection is missing</p><div class="CHeading">Remarks</div><p>Enables error handling from the frontend</p></div>
</div>

<a name="Disposed"></a><a name="Topic5"></a><div class="CTopic TEvent LVisualBasic">
 <div class="CTitle">Disposed</div>
 <div class="CBody"><p>Event message when object references were removed</p></div>
</div>

<a name="TempDb_configuration"></a><a name="Topic6"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">TempDb configuration</div>
</div>

<a name="Dispose"></a><a name="Topic7"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Dispose</div>
 <div id="NDPrototype7" class="NDPrototype"><div class="PSection PPlainSection">Public Sub Dispose()</div></div>
 <div class="CBody"><p>Dispose objects, reset members, delete file</p></div>
</div>

<a name="ClientDatabase"></a><a name="Topic8"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">ClientDatabase</div>
 <div class="CBody"><p>Database instance of the client application (frontend)</p><div class="CHeading">Returns</div><p>DAO.Database</p></div>
</div>

<a name="CurrentDatabase"></a><a name="Topic9"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">CurrentDatabase</div>
 <div class="CBody"><p>Database instance of TempDB</p><div class="CHeading">Returns</div><p>DAO.Database</p></div>
</div>

<a name="CloseCurrentDatabase"></a><a name="Topic10"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">CloseCurrentDatabase</div>
 <div id="NDPrototype10" class="NDPrototype"><div class="PSection PPlainSection">Public Sub CloseCurrentDatabase()</div></div>
 <div class="CBody"><p>Closes database but does not delete it ... DB is opened again at the next access attempt</p></div>
</div>

<a name="CreateDatabase"></a><a name="Topic11"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">CreateDatabase</div>
 <div id="NDPrototype11" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function CreateDatabase(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">Optional ByVal OpenSharedMode&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal DeleteFileOnTerminate&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">True</td></tr></table></td><td class="PAfterParameters">) As DAO.Database</td></tr></table></div></div>
 <div class="CBody"><p>Erzeugt neue mdb im %Temp%-Verzeichnis</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">OpenSharedMode</td><td class="CDLDefinition"><p>True: opens the database in split mode, False: opens the database in exclusive mode. Default: False</p></td></tr><tr><td class="CDLEntry">DeleteFileOnTerminate</td><td class="CDLDefinition"><p>True: File will be deleted at Class_Terminate. Default: True</p></td></tr></table><div class="CHeading">Returns</div><p>DAO.Database</p></div>
</div>

<a name="OpenDatabase"></a><a name="Topic12"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">OpenDatabase</div>
 <div id="NDPrototype12" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function OpenDatabase(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal DatabaseFile&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal Exclusive&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal ReadOnly&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False</td></tr></table></td><td class="PAfterParameters">) As DAO.Database</td></tr></table></div></div>
 <div class="CBody"><p>Opens existing database (mdb) as temp DB.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">DatabaseFile</td><td class="CDLDefinition"><p>The file to open</p></td></tr><tr><td class="CDLEntry">Exclusive</td><td class="CDLDefinition"><p>True: opens the database in exclusive mode, False: opens the database in split mode. Default: False</p></td></tr><tr><td class="CDLEntry">ReadOnly</td><td class="CDLDefinition"><p>opens the database read-only</p></td></tr></table><div class="CHeading">Returns</div><p>DAO.Database</p></div>
</div>

<a name="DeleteCurrentDatabase"></a><a name="Topic13"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">DeleteCurrentDatabase</div>
 <div id="NDPrototype13" class="NDPrototype"><div class="PSection PPlainSection">Public Sub DeleteCurrentDatabase()</div></div>
 <div class="CBody"><p>Deletes mdb file of the current database instance</p><div class="CHeading">Remarks</div><p>Will be executed automatically at Class_Terminate if file was created by TempDbHandler.CreateNewDatabase.</p></div>
</div>

<a name="CheckTempTable"></a><a name="Topic14"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">CheckTempTable</div>
 <div class="CBody"><p>CheckTempTable</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">SourceTableDefName</td><td class="CDLDefinition"><p>Table name in TempDB (backend)</p></td></tr><tr><td class="CDLEntry">CreateTableDDL</td><td class="CDLDefinition"><p>(optional) DDL statement to create the table if table does not exist.</p></td></tr><tr><td class="CDLEntry">LinkedTableDefName</td><td class="CDLDefinition"><p>(optional) Table name in frontend (no linked table if empty)</p></td></tr></table><div class="CHeading">Returns</div><p>Boolean</p></div>
</div>

<a name="CreateTable"></a><a name="Topic15"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">CreateTable</div>
 <div id="NDPrototype15" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function CreateTable(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal SourceTableDefName&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal CreateTableSql&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal LinkedTableDefName&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">vbNullString</td></tr></table></td><td class="PAfterParameters">) As Boolean</td></tr></table></div></div>
 <div class="CBody"><p>Erstellt Tabelle per DDL-Anweisung</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">SourceTableDefName</td><td class="CDLDefinition"><p>Table name in TempDB (backend)</p></td></tr><tr><td class="CDLEntry">CreateTableDDL</td><td class="CDLDefinition"><p>DDL statement to create the table if table does not exist.</p></td></tr><tr><td class="CDLEntry">LinkedTableDefName</td><td class="CDLDefinition"><p>(optional) Table name in frontend (no linked table if empty)</p></td></tr></table><div class="CHeading">Returns</div><p>Boolean</p></div>
</div>

<a name="DropTable"></a><a name="Topic16"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">DropTable</div>
 <div id="NDPrototype16" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function DropTable(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal SourceTableDefName&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal LinkedTableDefName&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">vbNullString</td></tr></table></td><td class="PAfterParameters">) As Boolean</td></tr></table></div></div>
 <div class="CBody"><p>Deletes table</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">SourceTableDefName</td><td class="CDLDefinition"><p>Table name in TempDB (backend)</p></td></tr><tr><td class="CDLEntry">LinkedTableDefName</td><td class="CDLDefinition"><p>(optional) Table name in frontend (no linked table if empty)</p></td></tr></table><div class="CHeading">Returns</div><p>Boolean</p></div>
</div>

<a name="DropLinkedTableDefs"></a><a name="Topic17"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">DropLinkedTableDefs</div>
 <div id="NDPrototype17" class="NDPrototype"><div class="PSection PPlainSection">Public Sub DropLinkedTableDefs()</div></div>
 <div class="CBody"><p>Removes TableDef objects linked to tables of TempDb</p></div>
</div>

<a name="LinkedTableDefExists"></a><a name="Topic18"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">LinkedTableDefExists</div>
 <div class="CBody"><p>Checks if table is present in the frontend</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">TableDefName</td><td class="CDLDefinition"><p>Table name in frontend</p></td></tr></table><div class="CHeading">Returns</div><p>Boolean</p></div>
</div>

<a name="SourceTableDefExists"></a><a name="Topic19"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">SourceTableDefExists</div>
 <div class="CBody"><p>Checks if table exists in temp database (backend)</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">TableDefName</td><td class="CDLDefinition"><p>Table name in backend</p></td></tr></table><div class="CHeading">Returns</div><p>Boolean</p></div>
</div>

<a name="Data_Operations"></a><a name="Topic20"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">Data Operations</div>
</div>

<a name="OpenRecordset"></a><a name="Topic21"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">OpenRecordset</div>
 <div id="NDPrototype21" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function OpenRecordset(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal Source&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal RecordsetType&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">DAO.RecordsetTypeEnum</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">dbOpenForwardOnly,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal RecordsetOptions&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">DAO.RecordsetOptionEnum</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">DAO.RecordsetOptionEnum.dbSeeChanges,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal LockEdit&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">DAO.LockTypeEnum</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">DAO.LockTypeEnum.dbOptimistic</td></tr></table></td><td class="PAfterParameters">) As DAO.Recordset</td></tr></table></div></div>
 <div class="CBody"><p>Open DAO.Recordset</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Source</td><td class="CDLDefinition"><p>SQL statement or table or query name</p></td></tr><tr><td class="CDLEntry">RecordsetType</td><td class="CDLDefinition"><p>DAO.RecordsetTypeEnum (Standard: dbOpenDynaset)</p></td></tr><tr><td class="CDLEntry">RecordsetOptions</td><td class="CDLDefinition"><p>DAO.RecordsetOptionEnum (Standard: dbSeeChanges)</p></td></tr><tr><td class="CDLEntry">LockEdit</td><td class="CDLDefinition"><p>DAO.LockTypeEnum (Standard: dbOptimistic)</p></td></tr></table><div class="CHeading">Returns</div><p>DAO.Recordset</p></div>
</div>

<a name="Execute"></a><a name="Topic22"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Execute</div>
 <div id="NDPrototype22" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function Execute(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal Query&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal Options&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">DAO.RecordsetOptionEnum</td></tr></table></td><td class="PAfterParameters">) As Long</td></tr></table></div></div>
 <div class="CBody"><p>Execute SQL statement</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">CommandText</td><td class="CDLDefinition"><p>SQL statement (String)</p></td></tr><tr><td class="CDLEntry">Options</td><td class="CDLDefinition"><p>DAO.RecordsetOptionEnum</p></td></tr></table><div class="CHeading">Returns</div><p>RecordsAffected (Long)</p></div>
</div>

<a name="LookupSQL"></a><a name="Topic23"></a><div class="CTopic TFunction LVisualBasic last">
 <div class="CTitle">LookupSQL</div>
 <div id="NDPrototype23" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function LookupSql(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal SqlText&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal Index&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last"><span class="SHNumber">0</span>&amp;,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal ValueIfNull&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">Null</td></tr></table></td><td class="PAfterParameters">) As Variant</td></tr></table></div></div>
 <div class="CBody"><p>Lookup DAO.Recordset replacement function for DLookup (passing a SQL statement)</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">SqlText</td><td class="CDLDefinition"><p>SQL statement</p></td></tr><tr><td class="CDLEntry">Index</td><td class="CDLDefinition"><p>Field selection if the first field of the recordset is not to be returned.&nbsp; The index is passed in the same way as DAO.Recordset.Fields(index).</p></td></tr><tr><td class="CDLEntry">ValueIfNull</td><td class="CDLDefinition"><p>Return value if record is missing or data field value is Null (default: Null).</p></td></tr></table><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Variant</td><td class="CDLDefinition"><p>Null, if SQL statement does not return a record.</p></td></tr></table><div class="CHeading">Remarks</div><p>The SQL statement must be written in the Jet/ACE SQL dialect.</p></div>
</div>

</body></html>