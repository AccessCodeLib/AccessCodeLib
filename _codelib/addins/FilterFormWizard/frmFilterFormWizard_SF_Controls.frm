Version =20
VersionRequired =20
Checksum =-675564561
Begin Form
    NavigationButtons = NotDefault
    AllowDesignChanges = NotDefault
    ScrollBars =2
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =10050
    DatasheetFontHeight =11
    ItemSuffix =33
    Left =1950
    Top =1920
    Right =7905
    Bottom =5145
    DatasheetGridlinesColor =15062992
    RecSrcDt = Begin
        0xc4d680b8ef58e440
    End
    RecordSource ="tabFilterControls"
    OnCurrent ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x000000000453f40098bdbb61cdbdbb61c6d3417c8874ec0d807f0000d821d30d ,
        0x010403069c00d80353ef8001010009009a0b3408640001000f00580202000100 ,
        0x580203000100413400bcbb618874ec0d08faba1301000004b854f40004000000 ,
        0xdc54f40000000000000000000000000000000000010000000000000001000000 ,
        0x0200000011010000ffffffff4749533400000000000000000000000044494e55 ,
        0x22006001bc031c00ed43a17d0000000000000000000000000000000000000000 ,
        0x00000000000000000c0000000100000000000000000001000000000000000000 ,
        0x0000010000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000060010000534d544a ,
        0x00000000100050017b00430033004300310043003100310041002d0038003500 ,
        0x460032002d0034003700310033002d0042003100370037002d00320038003600 ,
        0x4200430038003900410038003500390041007d000000496e70757442696e0041 ,
        0x55544f00524553444c4c00556e69726573444c4c004f7269656e746174696f6e ,
        0x00504f52545241495400436f6c6c617465004f4646004d656469615479706500 ,
        0x5072696e74657244656661756c74004a6f62426c61636b4f7074696d697a6174 ,
        0x696f6e004f4e005265736f6c7574696f6e006470695f31323030783630307831 ,
        0x00506170657253697a65004c4554544552005061676573506572536865657400 ,
        0x3100506167654f726465720046726f6e74546f4261636b0050616765426f7264 ,
        0x6572004f464600436f6c6f724d6f646500436f6c6f7200000000000000000000 ,
        0x0000000000000000000000000000000000000000000000001c0000005634444d ,
        0x0100000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08002a0046000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000055534230303300
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    DatasheetBackColor12 =-2147483643
    ShowPageMargins =0
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    PrtDevModeW = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x2d00330032003000200053006500720069006500730000000000000000000000 ,
        0x01040306dc00d80353ef8001010009009a0b3408640001000f00580202000100 ,
        0x5802030001004100340000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000011010000ffffffff4749533400000000000000000000000044494e55 ,
        0x22006001bc031c00ed43a17d0000000000000000000000000000000000000000 ,
        0x00000000000000000c0000000100000000000000000001000000000000000000 ,
        0x0000010000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000060010000534d544a ,
        0x00000000100050017b00430033004300310043003100310041002d0038003500 ,
        0x460032002d0034003700310033002d0042003100370037002d00320038003600 ,
        0x4200430038003900410038003500390041007d000000496e70757442696e0041 ,
        0x55544f00524553444c4c00556e69726573444c4c004f7269656e746174696f6e ,
        0x00504f52545241495400436f6c6c617465004f4646004d656469615479706500 ,
        0x5072696e74657244656661756c74004a6f62426c61636b4f7074696d697a6174 ,
        0x696f6e004f4e005265736f6c7574696f6e006470695f31323030783630307831 ,
        0x00506170657253697a65004c4554544552005061676573506572536865657400 ,
        0x3100506167654f726465720046726f6e74546f4261636b0050616765426f7264 ,
        0x6572004f464600436f6c6f724d6f646500436f6c6f7200000000000000000000 ,
        0x0000000000000000000000000000000000000000000000001c0000005634444d ,
        0x0100000000000000000000000000000000000000
    End
    PrtDevNamesW = Begin
        0x0400260042000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000005500530042003000300033000000
    End
    
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            ForeThemeColorIndex =2
            ForeTint =60.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            FontName ="Segoe UI"
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BackColor =-2147483633
            BorderLineStyle =0
            BorderThemeColorIndex =3
            BorderShade =90.0
            ThemeFontIndex =1
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =3
            BorderShade =90.0
            ThemeFontIndex =1
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =3
            BorderShade =90.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            Height =285
            BackColor =15064278
            Name ="Formularkopf"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =2
            BackTint =20.0
            Begin
                Begin Label
                    OverlapFlags =93
                    Left =5831
                    Width =2040
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =11573124
                    Name ="labControl"
                    Caption ="Steuerelement"
                    FontName ="Tahoma"
                    Tag ="LANG:"
                    GridlineColor =10921638
                    LayoutCachedLeft =5831
                    LayoutCachedWidth =7871
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =85
                    Left =56
                    Width =2157
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =11573124
                    Name ="labDataField"
                    Caption ="Datenfeld"
                    FontName ="Tahoma"
                    Tag ="LANG:"
                    GridlineColor =10921638
                    LayoutCachedLeft =56
                    LayoutCachedWidth =2213
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =85
                    Left =3746
                    Width =1815
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =11573124
                    Name ="labRelaionalOperator"
                    Caption ="Vergleichsoperator"
                    FontName ="Tahoma"
                    Tag ="LANG:"
                    GridlineColor =10921638
                    LayoutCachedLeft =3746
                    LayoutCachedWidth =5561
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =85
                    Left =2268
                    Width =1380
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =11573124
                    Name ="labDataType"
                    Caption ="Datentyp"
                    FontName ="Tahoma"
                    Tag ="LANG:"
                    GridlineColor =10921638
                    LayoutCachedLeft =2268
                    LayoutCachedWidth =3648
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
                Begin Label
                    OverlapFlags =87
                    Left =7875
                    Width =2175
                    Height =285
                    FontSize =10
                    BorderColor =16777215
                    ForeColor =11573124
                    Name ="labControl2"
                    Caption ="weitere Steuerelemente"
                    FontName ="Tahoma"
                    Tag ="LANG:"
                    GridlineColor =10921638
                    LayoutCachedLeft =7875
                    LayoutCachedWidth =10050
                    LayoutCachedHeight =285
                    ThemeFontIndex =-1
                End
            End
        End
        Begin Section
            Height =642
            Name ="Detailbereich"
            AlternateBackColor =16250871
            AlternateBackThemeColorIndex =1
            AlternateBackShade =97.0
            BackThemeColorIndex =1
            Begin
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    ListWidth =3402
                    Left =5831
                    Top =29
                    Width =2041
                    Height =285
                    FontSize =10
                    TabIndex =3
                    BorderColor =13553360
                    ForeColor =3484194
                    ConditionalFormat = Begin
                        0x0100000090000000010000000100000000000000000000001700000000000000 ,
                        0x00000000ffffff00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x5b006300620043007200650061007400650043006f006e00740072006f006c00 ,
                        0x5d003d00540072007500650000000000
                    End
                    Name ="fcControl"
                    ControlSource ="Control"
                    RowSourceType ="Value List"
                    ColumnWidths ="3402"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    LayoutCachedLeft =5831
                    LayoutCachedTop =29
                    LayoutCachedWidth =7872
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000000000000000000ffffff00160000005b00 ,
                        0x6300620043007200650061007400650043006f006e00740072006f006c005d00 ,
                        0x3d005400720075006500000000000000000000000000000000000000000000
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =3746
                    Top =29
                    Width =1803
                    Height =285
                    FontSize =10
                    TabIndex =2
                    BoundColumn =1
                    BorderColor =13553360
                    ForeColor =3484194
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"40\""
                    Name ="fcRelationalOperator"
                    ControlSource ="RelationalOperator"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tabRelationalOperators.RelationalOperator, tabRelationalOperators.Relatio"
                        "nalOperatorCode FROM tabRelationalOperators ORDER BY tabRelationalOperators.Orde"
                        "rPos;"
                    ColumnWidths ="1134;0"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    LayoutCachedLeft =3746
                    LayoutCachedTop =29
                    LayoutCachedWidth =5549
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
                Begin ComboBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =2268
                    Top =29
                    Width =1353
                    Height =285
                    FontSize =10
                    TabIndex =1
                    BoundColumn =1
                    BorderColor =13553360
                    ForeColor =3484194
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"40\""
                    Name ="fcDataType"
                    ControlSource ="DataType"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tabSqlFieldDataTypes.SqlFieldDataType, tabSqlFieldDataTypes.SqlFieldDataT"
                        "ypeCode FROM tabSqlFieldDataTypes ORDER BY tabSqlFieldDataTypes.SqlFieldDataType"
                        ";"
                    ColumnWidths ="1134;0"
                    FontName ="Tahoma"
                    GridlineColor =10921638
                    AllowValueListEdits =0

                    LayoutCachedLeft =2268
                    LayoutCachedTop =29
                    LayoutCachedWidth =3621
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =5465
                    Top =390
                    TabIndex =7
                    BorderColor =13553360
                    Name ="fcRelationalOperatorNot"
                    ControlSource ="RelationalOperatorNot"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =5465
                    LayoutCachedTop =390
                    LayoutCachedWidth =5725
                    LayoutCachedHeight =630
                    Begin
                        Begin Label
                            OverlapFlags =127
                            Left =5135
                            Top =360
                            Width =330
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            ForeColor =11573124
                            Name ="labRelationalOperatorNot"
                            Caption ="Not"
                            FontName ="Tahoma"
                            GridlineColor =10921638
                            LayoutCachedLeft =5135
                            LayoutCachedTop =360
                            LayoutCachedWidth =5465
                            LayoutCachedHeight =600
                            ThemeFontIndex =-1
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =85
                    Left =4181
                    Top =390
                    TabIndex =5
                    BorderColor =13553360
                    Name ="fcWildCardSuffix"
                    ControlSource ="WildCardSuffix"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =4181
                    LayoutCachedTop =390
                    LayoutCachedWidth =4441
                    LayoutCachedHeight =630
                    Begin
                        Begin Label
                            OverlapFlags =119
                            Left =3746
                            Top =360
                            Width =435
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            ForeColor =11573124
                            Name ="labWildCardSuffix"
                            Caption ="xxx*"
                            FontName ="Tahoma"
                            GridlineColor =10921638
                            LayoutCachedLeft =3746
                            LayoutCachedTop =360
                            LayoutCachedWidth =4181
                            LayoutCachedHeight =600
                            ThemeFontIndex =-1
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =247
                    Left =4886
                    Top =390
                    TabIndex =6
                    BorderColor =13553360
                    Name ="fcWildCardPrefix"
                    ControlSource ="WildCardPrefix"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =4886
                    LayoutCachedTop =390
                    LayoutCachedWidth =5146
                    LayoutCachedHeight =630
                    Begin
                        Begin Label
                            OverlapFlags =119
                            Left =4451
                            Top =360
                            Width =435
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            ForeColor =11573124
                            Name ="labWildCardPrefix"
                            Caption ="*xxx"
                            FontName ="Tahoma"
                            GridlineColor =10921638
                            LayoutCachedLeft =4451
                            LayoutCachedTop =360
                            LayoutCachedWidth =4886
                            LayoutCachedHeight =600
                            ThemeFontIndex =-1
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =56
                    Top =29
                    Width =2160
                    Height =285
                    FontSize =10
                    BorderColor =13553360
                    ForeColor =3484194
                    Name ="fcDataField"
                    ControlSource ="DataField"
                    FontName ="Tahoma"
                    GridlineColor =10921638

                    LayoutCachedLeft =56
                    LayoutCachedTop =29
                    LayoutCachedWidth =2216
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =7938
                    Top =29
                    Width =2056
                    Height =285
                    FontSize =10
                    TabIndex =4
                    BorderColor =13553360
                    ForeColor =3484194
                    Name ="fcControl2"
                    ControlSource ="Control2"
                    StatusBarText ="Mehrere Steuerelemente mit Komma trennen"
                    FontName ="Tahoma"
                    ConditionalFormat = Begin
                        0x0100000090000000010000000100000000000000000000001700000000000000 ,
                        0x00000000ffffff00000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x5b006300620043007200650061007400650043006f006e00740072006f006c00 ,
                        0x5d003d00540072007500650000000000
                    End
                    GridlineColor =10921638
                    HorizontalAnchor =2

                    LayoutCachedLeft =7938
                    LayoutCachedTop =29
                    LayoutCachedWidth =9994
                    LayoutCachedHeight =314
                    ThemeFontIndex =-1
                    ConditionalFormat14 = Begin
                        0x01000100000001000000000000000000000000000000ffffff00160000005b00 ,
                        0x6300620043007200650061007400650043006f006e00740072006f006c005d00 ,
                        0x3d005400720075006500000000000000000000000000000000000000000000
                    End
                End
                Begin CheckBox
                    OverlapFlags =93
                    Left =6222
                    Top =390
                    TabIndex =8
                    BorderColor =13553360
                    Name ="cbCreateControl"
                    ControlSource ="CreateControl"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    GridlineColor =10921638

                    LayoutCachedLeft =6222
                    LayoutCachedTop =390
                    LayoutCachedWidth =6482
                    LayoutCachedHeight =630
                    Begin
                        Begin Label
                            OverlapFlags =255
                            Left =5831
                            Top =360
                            Width =414
                            Height =240
                            FontSize =8
                            BorderColor =16777215
                            Name ="labCreateControl"
                            Caption ="Neu"
                            FontName ="Tahoma"
                            Tag ="LANG:"
                            GridlineColor =10921638
                            LayoutCachedLeft =5831
                            LayoutCachedTop =360
                            LayoutCachedWidth =6245
                            LayoutCachedHeight =600
                            ThemeFontIndex =-1
                            ForeThemeColorIndex =0
                            ForeTint =100.0
                        End
                    End
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    SpecialEffect =0
                    OldBorderStyle =0
                    OverlapFlags =247
                    Left =5839
                    Top =336
                    Width =4137
                    Height =300
                    TabIndex =9
                    BorderColor =13553360
                    Name ="ogNewControlType"
                    ControlSource ="ControlType"
                    OnEnter ="[Event Procedure]"
                    GridlineColor =10921638

                    LayoutCachedLeft =5839
                    LayoutCachedTop =336
                    LayoutCachedWidth =9976
                    LayoutCachedHeight =636
                    Begin
                        Begin OptionButton
                            OverlapFlags =119
                            Left =6689
                            Top =396
                            OptionValue =109
                            BorderColor =13553360
                            Name ="ogfldTextbox"
                            GridlineColor =10921638

                            LayoutCachedLeft =6689
                            LayoutCachedTop =396
                            LayoutCachedWidth =6949
                            LayoutCachedHeight =636
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =6919
                                    Top =336
                                    Width =876
                                    Height =300
                                    BorderColor =16777215
                                    ForeColor =11573124
                                    Name ="labCreateTextbox"
                                    Caption ="TextBox"
                                    GridlineColor =10921638
                                    LayoutCachedLeft =6919
                                    LayoutCachedTop =336
                                    LayoutCachedWidth =7795
                                    LayoutCachedHeight =636
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =119
                            Left =7992
                            Top =396
                            TabIndex =1
                            OptionValue =111
                            BorderColor =13553360
                            Name ="ogfldCombobox"
                            GridlineColor =10921638

                            LayoutCachedLeft =7992
                            LayoutCachedTop =396
                            LayoutCachedWidth =8252
                            LayoutCachedHeight =636
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =8219
                                    Top =336
                                    Width =1032
                                    Height =300
                                    BorderColor =16777215
                                    ForeColor =11573124
                                    Name ="labCreateCombobox"
                                    Caption ="ComboBox"
                                    GridlineColor =10921638
                                    LayoutCachedLeft =8219
                                    LayoutCachedTop =336
                                    LayoutCachedWidth =9251
                                    LayoutCachedHeight =636
                                End
                            End
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="Formularfuß"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------------------------------------------------------------
' Form: frmFilterFormWizard_SF_Controls
'---------------------------------------------------------------------------------------
'/**
' \author       Josef Poetzl
' <summary>
' Wizard-Form-Unterformular für FilterControls-Import
' </summary>
' <remarks></remarks>
'**/
'---------------------------------------------------------------------------------------
'<codelib>
'  <file>_codelib/addins/FilterFormWizard/frmFilterFormWizard_SF_Controls.frm</file>
'  <license>_codelib/license.bas</license>
'  <use>_codelib/addins/shared/FormDesigner.cls</use>
'  <use>localization/L10nTools.bas</use>
'  <use>localization/L10nDict.cls</use>
'</codelib>
'---------------------------------------------------------------------------------------
'
Option Compare Database
Option Explicit

#Const ADODB_EARLYBINDING = 0

#If ADODB_EARLYBINDING = 1 Then

#Else
   Public Enum CursorTypeEnum
      adOpenKeyset = 1
   End Enum
   
   Public Enum CursorLocationEnum
      adUseClient = 3
   End Enum
   
   Public Enum LockTypeEnum
      adLockOptimistic = 3
   End Enum
#End If

Private WithEvents m_LngDict As L10nDict
Attribute m_LngDict.VB_VarHelpID = -1

Public Sub InitFilterForm(ByVal FrmRef As Form)

   InitDataSource
   LoadControlsFromForm FrmRef

End Sub

Private Sub InitDataSource()

#If ADODB_EARLYBINDING = 1 Then
   Dim rst As ADODB.Recordset
#Else
   Dim rst As Object
#End If

   Set rst = CreateObject("ADODB.Recordset")
   rst.CursorLocation = adUseClient
   rst.Open "select * from tabFilterControls", CodeProject.Connection, adOpenKeyset, adLockOptimistic
   Set rst.ActiveConnection = Nothing

   Set Me.Recordset = rst

End Sub

Private Sub LoadControlsFromForm(ByVal FrmRef As Form)

   Dim ctl As Control

   Me.fcControl.RowSource = vbNullString

   If FrmRef Is Nothing Then
      Exit Sub
   End If

   For Each ctl In FrmRef.Controls
      Select Case ctl.ControlType
         Case AcControlType.acTextBox, AcControlType.acComboBox, _
              AcControlType.acCheckBox, AcControlType.acListBox, _
              AcControlType.acOptionButton, AcControlType.acOptionGroup, _
              AcControlType.acToggleButton

            Me.fcControl.AddItem ctl.Name

      End Select
   Next

End Sub

Public Function AddControlsToImporter(ByVal Importer As FilterFormCodeImporter, ByVal FilterFormName As String, ByVal UseFilterDefinitionInTagProperty As Boolean) As Boolean
   
#If ADODB_EARLYBINDING = 1 Then
   Dim rst As ADODB.Recordset
#Else
   Dim rst As Object
#End If

   Dim RelOp As String
   Dim UseBetweenRelOp As Boolean
   Dim FilterCtl As Control
   Dim FrmDsgnr As FormDesigner

   Set rst = Me.Recordset.Clone
   If rst.RecordCount = 0 Then
      Exit Function
   End If
   
   Dim DataFieldName As String
   Dim ControlName As String, ControlName2 As String
   
   Dim SaveForm As Boolean
   
   If UseFilterDefinitionInTagProperty Then
      Set FrmDsgnr = New FormDesigner
      FrmDsgnr.FormName = FilterFormName
   End If

   With rst
      Do While Not .EOF

         RelOp = Nz(.Fields("RelationalOperator"), vbNullString)
         UseBetweenRelOp = (RelOp = "SQL_Between")
         
         If UseFilterDefinitionInTagProperty Then
            RelOp = GetRelationalOperatorKey(RelOp)
            If .Fields("WildCardSuffix") = True Then
               RelOp = RelOp & "*"
            End If
            If .Fields("WildCardPrefix") = True Then
               RelOp = "*" & RelOp
            End If
            If .Fields("RelationalOperatorNot") = True Then
               RelOp = "Not " & RelOp
            End If
         Else
            If .Fields("WildCardSuffix") = True Then
               RelOp = RelOp & " + SQL_Add_WildCardSuffix"
            End If
            If .Fields("WildCardPrefix") = True Then
               RelOp = RelOp & " + SQL_Add_WildCardPrefix"
            End If
            If .Fields("RelationalOperatorNot") = True Then
               RelOp = "SQL_Not + " & RelOp
            End If
         End If
         
         DataFieldName = Nz(.Fields("DataField").Value, vbNullString)

         If .Fields("CreateControl").Value = True Then
            Set FilterCtl = InsertFormControl(FilterFormName, Nz(.Fields("ControlType").Value, acTextBox), DataFieldName, UseBetweenRelOp, ControlName, ControlName2, UseFilterDefinitionInTagProperty)
            SaveForm = True
            AddControlsToImporter = True
         Else
            ControlName = Nz(.Fields("Control").Value, vbNullString)
            ControlName2 = Nz(.Fields("Control2"), vbNullString)
            If UseFilterDefinitionInTagProperty Then
               Set FilterCtl = FrmDsgnr.Form.Controls(ControlName)
            End If
         End If

         If UseFilterDefinitionInTagProperty Then
            FilterCtl.Tag = GetFilterControlTag(Nz(.Fields("DataType").Value, vbNullString), RelOp, DataFieldName, ControlName2)
            SaveForm = True
         Else
            ControlName = GetCheckedControlName(ControlName)
            ControlName2 = GetCheckedControlName(ControlName2)
            Importer.AddFilterControlDefinition DataFieldName, _
                                                Nz(.Fields("DataType"), vbNullString), _
                                                RelOp, _
                                                ControlName, _
                                                ControlName2
         End If
         
         Set FilterCtl = Nothing
         ControlName = vbNullString
         ControlName2 = vbNullString
         .MoveNext

      Loop
   End With
   
   If UseFilterDefinitionInTagProperty Then
      Set FrmDsgnr = Nothing
   End If
   
   If SaveForm Then
      DoCmd.Save acForm, FilterFormName
   End If

End Function

Private Function GetFilterControlTag(ByVal DataTypeText As String, ByVal RelOpText As String, ByVal DataFieldName As String, ByVal ControlName2 As String) As String
   
   Dim ControlTag As String
   Const SeparatorChar As String = "|"
   
   ControlTag = Replace(DataTypeText, "SQL_", vbNullString) & SeparatorChar & RelOpText & SeparatorChar & DataFieldName & SeparatorChar & ControlName2
   
   Do While Right(ControlTag, 1) = SeparatorChar
      ControlTag = Left(ControlTag, Len(ControlTag) - 1)
   Loop
   
   GetFilterControlTag = ControlTag
   
End Function

Private Function GetRelationalOperatorKey(ByVal RelationalOperatorCode As String) As String
   With CodeProject.Connection.Execute("select RelationalOperator from tabRelationalOperators where RelationalOperatorCode = '" & Replace(RelationalOperatorCode, "'", "''") & "'")
      If Not .EOF Then
         GetRelationalOperatorKey = .Fields(0).Value
      End If
      .Close
   End With
End Function

Private Function InsertFormControl(ByVal FilterFormName As String, ByVal ControlType As AcControlType, ByVal DataFieldName As String, ByVal UseBetweenRelOp As Boolean, ByRef ControlName As String, ByRef Control2Name As String, ByVal UseFilterDefinitionInTagProperty As Boolean) As Control

   Const DistanceBetweenControls As Long = 72

   Dim FilterCtl As Control
   Dim LabCtl As Control
   
   Dim ControlCaption As String, Control2Caption As String
   Dim CreateControl2 As Boolean

   ControlCaption = DataFieldName
   If StrComp(Left(DataFieldName, 1), UCase(Left(DataFieldName, 1)), vbBinaryCompare) <> 0 Then
      DataFieldName = UCase(Left(DataFieldName, 1)) & Mid(DataFieldName, 2)
   End If
   ControlName = GetCheckedControlName("fctl" & DataFieldName)
   
   With New FormDesigner
   
      .FormName = FilterFormName
      
      If UseBetweenRelOp Then
         CreateControl2 = True
         Control2Caption = ControlCaption & " bis"
         If UseFilterDefinitionInTagProperty Then
            Control2Name = "x" & ControlName & "Max"
         Else
            Control2Name = ControlName & "Max"
            ControlName = ControlName & "Min"
         End If
         ControlCaption = ControlCaption & " von"
      End If
      
      Set FilterCtl = .AddControl(ControlType, ControlName, acHeader, , , , , DistanceBetweenControls, True, ControlCaption)
      ControlName = FilterCtl.Name
      If CreateControl2 Then
         Set LabCtl = FilterCtl.Controls(0)
         Control2Name = .AddControl(ControlType, Control2Name, acHeader, LabCtl.Left + LabCtl.Width + DistanceBetweenControls, LabCtl.Top, , , DistanceBetweenControls, True, Control2Caption).Name
      End If
      
   End With
   
   Set InsertFormControl = FilterCtl

End Function

Private Sub cbCreateControl_AfterUpdate()

   Dim CreateNewControl As Boolean
   
   CreateNewControl = Me.cbCreateControl.Value

   With Me.ogNewControlType
      .TabStop = Nz(.Value, False)
      If CreateNewControl Then
         .Value = acTextBox
      Else
         .Value = Null
      End If
      
   End With
   
End Sub

Private Sub Form_Current()
   Me.ogNewControlType.TabStop = Nz(Me.cbCreateControl.Value)
End Sub

Private Sub Form_Load()
   L10n.TranslateControls Me.Controls
   Set m_LngDict = L10n
End Sub

Private Sub m_LngDict_DictionaryRefreshed()
   L10n.TranslateControls Me.Controls
End Sub

Private Sub ogNewControlType_Enter()
   Me.ogNewControlType.Locked = (Me.cbCreateControl.Value = False)
End Sub

Private Function GetCheckedControlName(ByVal ControlNameToCheck As String) As String
   GetCheckedControlName = Replace(ControlNameToCheck, " ", "_")
End Function

Public Sub InsertFilterRecord(ByVal DataFieldName As String, ByVal DataFieldType As DAO.DataTypeEnum)

   Dim FieldDataType As SqlFieldDataType
   
   Select Case DataFieldType
      Case DAO.DataTypeEnum.dbBinary, DAO.DataTypeEnum.dbGUID, DAO.DataTypeEnum.dbVarBinary
         Exit Sub
      Case 101 ' 101 = DAO.DataTypeEnum.dbAttachment
         Exit Sub
   End Select
   
   FieldDataType = ConvertDaoDataTypeToSqlFieldDataType(DataFieldType)
   
   With Me.Recordset
      .AddNew
      .Fields("DataField").Value = DataFieldName
      .Fields("DataType").Value = ConvertSqlFieldDataTypeToString(FieldDataType)
      If FieldDataType = SQL_Text Then
         .Fields("RelationalOperator").Value = "SQL_Like"
         .Fields("WildCardSuffix").Value = True
      Else
         .Fields("RelationalOperator").Value = "SQL_Equal"
         .Fields("WildCardSuffix").Value = False
      End If
      .Fields("CreateControl").Value = True
      .Fields("ControlType").Value = acTextBox
      .Fields("WildCardPrefix").Value = False
      .Fields("RelationalOperatorNot").Value = False
      .Update
   End With
      
End Sub

Private Function ConvertDaoDataTypeToSqlFieldDataType(ByVal DT As DAO.DataTypeEnum) As SqlFieldDataType

   Select Case DT
      Case DAO.DataTypeEnum.dbBigInt, DAO.DataTypeEnum.dbByte, DAO.DataTypeEnum.dbDecimal, DAO.DataTypeEnum.dbCurrency, DAO.DataTypeEnum.dbDouble, DAO.DataTypeEnum.dbFloat, DAO.DataTypeEnum.dbInteger, DAO.DataTypeEnum.dbLong, DAO.DataTypeEnum.dbNumeric, DAO.DataTypeEnum.dbSingle
         ConvertDaoDataTypeToSqlFieldDataType = SqlFieldDataType.SQL_Numeric
      Case DAO.DataTypeEnum.dbDate, DAO.DataTypeEnum.dbTime
         ConvertDaoDataTypeToSqlFieldDataType = SqlFieldDataType.SQL_Date
      Case DAO.DataTypeEnum.dbBoolean
         ConvertDaoDataTypeToSqlFieldDataType = SqlFieldDataType.SQL_Boolean
      Case Else
         ConvertDaoDataTypeToSqlFieldDataType = SqlFieldDataType.SQL_Text
   End Select

End Function

Private Function ConvertSqlFieldDataTypeToString(ByVal DT As SqlFieldDataType) As String
   Select Case DT
      Case SqlFieldDataType.SQL_Text
         ConvertSqlFieldDataTypeToString = "SQL_Text"
      Case SqlFieldDataType.SQL_Numeric
         ConvertSqlFieldDataTypeToString = "SQL_Numeric"
      Case SqlFieldDataType.SQL_Date
         ConvertSqlFieldDataTypeToString = "SQL_Date"
      Case SqlFieldDataType.SQL_Boolean
         ConvertSqlFieldDataTypeToString = "SQL_Boolean"
   End Select
End Function