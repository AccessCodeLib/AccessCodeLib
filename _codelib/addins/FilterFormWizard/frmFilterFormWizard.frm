Version =20
VersionRequired =20
Checksum =-1523960344
Begin Form
    AllowFilters = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    AllowAdditions = NotDefault
    KeyPreview = NotDefault
    DefaultView =0
    ScrollBars =0
    TabularFamily =119
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridY =10
    Width =10828
    DatasheetFontHeight =10
    ItemSuffix =101
    Left =705
    Top =960
    Right =13290
    Bottom =9330
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x668d2cd46a58e440
    End
    GUID = Begin
        0x8f309169ffbfbd4ebbb375424a700b57
    End
    Caption ="ACLib FilterForm Wizard"
    OnCurrent ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xae050000ae050000ae050000ae05000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000a519eb2f0400000001000000d47d3c000e00000048803c00 ,
        0x010400069c00440353ef8003010009009a0b3408640001000f00580202000100 ,
        0x580203000100413400803c0008000000c83cd70534803c00c43cd7052c7e3c00 ,
        0x23872b30e03c0000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000007000440300000000000000000000000000000000 ,
        0x0000000000000000030000000000000000001000503403002888040000000000 ,
        0x0000000000000100000000000000000000000000000000002401df8c03000000 ,
        0x05000b00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000070000000534d544a0000000010006000 ,
        0x46007200650065005000440046005f005800500000005265736f6c7574696f6e ,
        0x00363030647069005061676553697a650041340050616765526567696f6e0000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080013001b000100000000000000000000000000000000000000004672656550 ,
        0x44465850313a0000000000
    End
    FilterOnLoad =0
    ShowPageMargins =0
    AllowLayoutView =0
    DatasheetGridlinesColor12 =12632256
    PrtDevModeW = Begin
        0x0000000000763c005001f605b793c2f20016f6057a7109767f00000078651e30 ,
        0x09000000389b3c00b66a1e30f5c4f92f7c46f784000000003d03003ec400f605 ,
        0x01040006dc00440353ef8003010009009a0b3408640001000f00580202000100 ,
        0x5802030001004100340000000c0000000016f6050016f605fb15f60500000000 ,
        0x50763c000000f6057a7d1c0194753c0002000000107a3c00f571f476474fe30a ,
        0xfeffffffd33c0000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000007000440300000000000000000000000000000000 ,
        0x0000000000000000030000000000000000001000503403002888040000000000 ,
        0x0000000000000100000000000000000000000000000000002401df8c03000000 ,
        0x05000b00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000070000000534d544a0000000010006000 ,
        0x46007200650065005000440046005f005800500000005265736f6c7574696f6e ,
        0x00363030647069005061676553697a650041340050616765526567696f6e0000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNamesW = Begin
        0x04000f0017000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000460072006500650050004400460058005000 ,
        0x31003a0000000000000000000000
    End
    
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
        End
        Begin Line
            BorderLineStyle =0
            Width =1701
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin ComboBox
            SpecialEffect =2
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =3
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =90.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin ToggleButton
            Width =283
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin Section
            CanGrow = NotDefault
            Height =5727
            BackColor =-2147483633
            Name ="Detailbereich"
            GUID = Begin
                0xfeffd8470a0a9b46abd37d015aab40c1
            End
            Begin
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2381
                    Top =4957
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulFilterStringBuilder"
                    FontName ="Marlett"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xdd6a6769d341054eb9b6a296fae08f29
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2381
                    LayoutCachedTop =4957
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =5252
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2381
                    Top =4597
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulFilterControlManager"
                    FontName ="Marlett"
                    GUID = Begin
                        0x305cae0a69ac99408cdac46d5e2689ce
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2381
                    LayoutCachedTop =4597
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =4892
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2381
                    Top =5317
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulSqlTools"
                    FontName ="Marlett"
                    GUID = Begin
                        0x1d0212a8607e14459c58854d3069900b
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2381
                    LayoutCachedTop =5317
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =5612
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2381
                    Top =4252
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModules"
                    FontName ="Marlett"
                    GUID = Begin
                        0xbe7161d84c13b5499ad792e6366b9eac
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2381
                    LayoutCachedTop =4252
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =4547
                End
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =2
                    Left =2784
                    Top =4139
                    Width =0
                    Height =1588
                    Name ="Linie49"
                    GUID = Begin
                        0x6c2c3106ded8534c87892e2ee126530c
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2784
                    LayoutCachedTop =4139
                    LayoutCachedWidth =2784
                    LayoutCachedHeight =5727
                End
                Begin TextBox
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    Name ="sysFirst"
                    GUID = Begin
                        0x4d21045caadf464383f75e79a673ebd4
                    End

                End
                Begin CommandButton
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7313
                    Top =5272
                    Width =3402
                    Height =375
                    FontSize =10
                    TabIndex =4
                    Name ="cmdAddFilterControManagerToForm"
                    Caption ="FilterControlManager einfügen"
                    OnClick ="[Event Procedure]"
                    FontName ="Verdana"
                    GUID = Begin
                        0x5bd9780ad5280e4ca3a72fc65582233c
                    End
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =7313
                    LayoutCachedTop =5272
                    LayoutCachedWidth =10715
                    LayoutCachedHeight =5647
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin Label
                    OverlapFlags =85
                    Left =356
                    Top =4622
                    Width =1991
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulFilterControlManager"
                    Caption ="FilterControlManager"
                    GUID = Begin
                        0x8b2a1e9b456dac47a589d89260e7cd9d
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =356
                    LayoutCachedTop =4622
                    LayoutCachedWidth =2347
                    LayoutCachedHeight =4877
                End
                Begin Label
                    OverlapFlags =85
                    Left =356
                    Top =4982
                    Width =1991
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulFilterStringBuilder"
                    Caption ="FilterStringBuilder"
                    GUID = Begin
                        0x502db6c278e7644e80b7bb465da8086e
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =356
                    LayoutCachedTop =4982
                    LayoutCachedWidth =2347
                    LayoutCachedHeight =5237
                End
                Begin Label
                    OverlapFlags =85
                    Left =356
                    Top =5342
                    Width =1991
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulSqlTools"
                    Caption ="SqlTools"
                    GUID = Begin
                        0xdd04a61804b3d3489636dea0aac6d966
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =356
                    LayoutCachedTop =5342
                    LayoutCachedWidth =2347
                    LayoutCachedHeight =5597
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =2381
                    Top =4957
                    Width =295
                    Height =295
                    TabIndex =5
                    Name ="cmdCopyModulFilterStringBuilder"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc8975d8c2da3304ebb127dc3080d923e
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2381
                    LayoutCachedTop =4957
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =5252
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =2381
                    Top =4597
                    Width =295
                    Height =295
                    TabIndex =3
                    Name ="cmdCopyModulFilterControlManager"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc0cb35c7d786bf44aefdc3b2945a0498
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2381
                    LayoutCachedTop =4597
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =4892
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =2381
                    Top =5317
                    Width =295
                    Height =295
                    TabIndex =6
                    Name ="cmdCopyModulSqlTools"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xb1a983cde9722b43a3e535cf8b426c67
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2381
                    LayoutCachedTop =5317
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =5612
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin Label
                    OverlapFlags =85
                    Left =120
                    Top =4267
                    Width =1815
                    Height =255
                    FontSize =9
                    FontWeight =700
                    Name ="labCopyCaption"
                    Caption ="Module u. Klassen"
                    OnMouseDown ="[Event Procedure]"
                    ControlTipText ="nur in der Vollversion verfügbar"
                    GUID = Begin
                        0x6fdf1d4132b76c429cd92273cd9ef89b
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =120
                    LayoutCachedTop =4267
                    LayoutCachedWidth =1935
                    LayoutCachedHeight =4522
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =2381
                    Top =4252
                    Width =295
                    Height =295
                    TabIndex =1
                    Name ="cmdCopyModules"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x71b2bb2e794e5a4183b92a358e952ad8
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2381
                    LayoutCachedTop =4252
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =4547
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =87
                    IMESentenceMode =3
                    Left =2039
                    Top =170
                    Width =3402
                    Height =285
                    FontSize =10
                    TabIndex =2
                    GUID = Begin
                        0x9ae17955cc84ce48bbcca6b1a3566263
                    End
                    Name ="cbxFormName"
                    RowSourceType ="Table/Query"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Verdana"
                    OnGotFocus ="[Event Procedure]"

                    LayoutCachedLeft =2039
                    LayoutCachedTop =170
                    LayoutCachedWidth =5441
                    LayoutCachedHeight =455
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =113
                            Top =170
                            Width =1920
                            Height =285
                            FontSize =10
                            Name ="Bezeichnungsfeld89"
                            Caption ="Formular wählen:"
                            FontName ="Verdana"
                            GUID = Begin
                                0x686faf8a460dc643aef4f21fb057114d
                            End
                            LayoutCachedLeft =113
                            LayoutCachedTop =170
                            LayoutCachedWidth =2033
                            LayoutCachedHeight =455
                        End
                    End
                End
                Begin Subform
                    Enabled = NotDefault
                    OverlapFlags =87
                    SpecialEffect =3
                    Left =127
                    Top =855
                    Width =10605
                    Height =3255
                    TabIndex =7
                    BorderColor =-2147483630
                    Name ="sfrFilterControls"
                    SourceObject ="Form.frmFilterFormWizard_SF_Controls"
                    GUID = Begin
                        0x31310376de53cf4f94a5b24ab61e1a1a
                    End
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedLeft =127
                    LayoutCachedTop =855
                    LayoutCachedWidth =10732
                    LayoutCachedHeight =4110
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =127
                            Top =570
                            Width =10590
                            Height =285
                            FontSize =10
                            Name ="Bezeichnungsfeld90"
                            Caption ="FilterControls:"
                            GUID = Begin
                                0x316e57d56817c141a27648ce160be30c
                            End
                            LayoutCachedLeft =127
                            LayoutCachedTop =570
                            LayoutCachedWidth =10717
                            LayoutCachedHeight =855
                        End
                    End
                End
                Begin OptionGroup
                    Enabled = NotDefault
                    OverlapFlags =93
                    Left =3465
                    Top =4380
                    Width =3681
                    Height =1260
                    TabIndex =9
                    Name ="UseFilterMethodOptions"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    GUID = Begin
                        0x467177d9c56ca94a880a2e7ea0a3df15
                    End

                    LayoutCachedLeft =3465
                    LayoutCachedTop =4380
                    LayoutCachedWidth =7146
                    LayoutCachedHeight =5640
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            Left =3581
                            Top =4260
                            Width =1395
                            Height =240
                            BackColor =-2147483633
                            Name ="Bezeichnungsfeld92"
                            Caption ="UseFilter-Methode"
                            GUID = Begin
                                0x6e694148f314bf4eae763e55e8443045
                            End
                            LayoutCachedLeft =3581
                            LayoutCachedTop =4260
                            LayoutCachedWidth =4976
                            LayoutCachedHeight =4500
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =3615
                            Top =4652
                            OptionValue =0
                            BorderColor =12835293
                            Name ="Option93"
                            GUID = Begin
                                0x2ed9a0b87581e9459437795c1ea4f08f
                            End
                            GridlineColor =10921638

                            LayoutCachedLeft =3615
                            LayoutCachedTop =4652
                            LayoutCachedWidth =3875
                            LayoutCachedHeight =4892
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =3840
                                    Top =4620
                                    Width =3075
                                    Height =240
                                    Name ="Bezeichnungsfeld94"
                                    Caption ="auskommentierten Beispiel-Code einfügen"
                                    GUID = Begin
                                        0x45350e3d0a7cde4ca18753d3df2a7a50
                                    End
                                    LayoutCachedLeft =3840
                                    LayoutCachedTop =4620
                                    LayoutCachedWidth =6915
                                    LayoutCachedHeight =4860
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =3615
                            Top =4962
                            TabIndex =1
                            OptionValue =1
                            BorderColor =12835293
                            Name ="Option95"
                            GUID = Begin
                                0x918bf012f5ab6a4a82b18d8d78de17cb
                            End
                            GridlineColor =10921638

                            LayoutCachedLeft =3615
                            LayoutCachedTop =4962
                            LayoutCachedWidth =3875
                            LayoutCachedHeight =5202
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =3844
                                    Top =4935
                                    Width =3049
                                    Height =240
                                    Name ="Bezeichnungsfeld96"
                                    Caption ="aktuelles Formular filtern"
                                    GUID = Begin
                                        0xdcea6dbc2fc72b438c7c28fb17bae4f6
                                    End
                                    LayoutCachedLeft =3844
                                    LayoutCachedTop =4935
                                    LayoutCachedWidth =6893
                                    LayoutCachedHeight =5175
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =3615
                            Top =5305
                            TabIndex =2
                            OptionValue =2
                            BorderColor =12835293
                            Name ="Option97"
                            GUID = Begin
                                0x03d2ddc59a72074694568a25b639186a
                            End
                            GridlineColor =10921638

                            LayoutCachedLeft =3615
                            LayoutCachedTop =5305
                            LayoutCachedWidth =3875
                            LayoutCachedHeight =5545
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =3844
                                    Top =5275
                                    Width =1114
                                    Height =240
                                    Name ="Bezeichnungsfeld98"
                                    Caption ="Unterformular"
                                    GUID = Begin
                                        0x743cbf1b4fad704a87f1096bb7ea5c8e
                                    End
                                    LayoutCachedLeft =3844
                                    LayoutCachedTop =5275
                                    LayoutCachedWidth =4958
                                    LayoutCachedHeight =5515
                                End
                            End
                        End
                    End
                End
                Begin ComboBox
                    Enabled = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =247
                    IMESentenceMode =3
                    ListWidth =3402
                    Left =4958
                    Top =5275
                    Width =2061
                    TabIndex =8
                    GUID = Begin
                        0xd2abcc3725b6174684facff57821578b
                    End
                    Name ="cbxUseFilterSubForm"
                    RowSourceType ="Value List"
                    ColumnWidths ="3402"
                    AfterUpdate ="[Event Procedure]"
                    OnGotFocus ="[Event Procedure]"

                    LayoutCachedLeft =4958
                    LayoutCachedTop =5275
                    LayoutCachedWidth =7019
                    LayoutCachedHeight =5515
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------------------------------------------------------------
' Form: frmFilterFormWizard
'---------------------------------------------------------------------------------------
'/**
' \author       Josef Poetzl
' <summary>
' Wizard-Form für FilterControlManager-Import
' </summary>
' <remarks></remarks>
'**/
'---------------------------------------------------------------------------------------
'<codelib>
'  <file>_codelib/addins/FilterFormWizard/frmFilterFormWizard.frm</file>
'  <license>_codelib/license.bas</license>
'  <use>_codelib/addins/FilterFormWizard/FilterControlManagerImporter.cls</use>
'  <use>_codelib/addins/shared/AppFileCodeModulTransfer.cls</use>
'  <use>_codelib/addins/FilterFormWizard/frmFilterFormWizard_SF_Controls.frm</use>
'</codelib>
'---------------------------------------------------------------------------------------
'
Option Compare Database
Option Explicit

Private m_OpenModules As Long
Private m_CodeModulImporter As AppFileCodeModulTransfer

Private Const m_SubFormUseFilterOption As Long = 2

'Datenquellen für Formular (je nachdem ob Formular für FE-Verbindung bzw. Vorlage verwendet wird):
Private Property Get SourceDb() As DAO.Database
   Set SourceDb = CurrentDb
End Property

Private Property Get CodeModulImporter() As AppFileCodeModulTransfer
   If m_CodeModulImporter Is Nothing Then
      Set m_CodeModulImporter = New AppFileCodeModulTransfer
   End If
   Set CodeModulImporter = m_CodeModulImporter
End Property

Private Sub cbxFormName_AfterUpdate()

   Dim FormName As String
   Dim FormSelected As Boolean
   Dim FormRef As Form

   RefreshAddFilterButtonEnableMode
   
   FormName = Nz(Me.cbxFormName.Value, vbNullString)
   FormSelected = (Len(FormName) > 0)

   Me.sfrFilterControls.Enabled = FormSelected
   
   Me.UseFilterMethodOptions.Enabled = FormSelected
   With Me.cbxUseFilterSubForm
      .Enabled = FormSelected And (Me.UseFilterMethodOptions = m_SubFormUseFilterOption)
      .Value = Null
   End With

   If Not FormSelected Then
      Me.cbxFormName.RowSource = vbNullString
      Me.sfrFilterControls.Form.InitFilterForm Nothing
      Me.cbxUseFilterSubForm.RowSource = vbNullString
      Exit Sub
   End If

   Set FormRef = GetFilterFormRef
   Me.sfrFilterControls.Form.InitFilterForm FormRef

End Sub

Private Sub RefreshAddFilterButtonEnableMode()
   
   Dim bolEnable As Boolean

   bolEnable = (Len(Nz(Me.cbxFormName.Value, vbNullString)) > 0)
   
   If bolEnable Then
      If Me.UseFilterMethodOptions.Value = 2 Then
         bolEnable = (Len(Nz(Me.cbxUseFilterSubForm.Value, vbNullString)) > 0)
      End If
   End If

   Me.cmdAddFilterControManagerToForm.Enabled = bolEnable

End Sub

Private Function GetFilterFormRef() As Form

   Dim FormName As String

   FormName = Nz(Me.cbxFormName.Value, vbNullString)
   If Len(FormName) = 0 Then
      Set GetFilterFormRef = Nothing
      Exit Function
   End If

   OpenFormIfClosed FormName
   Set GetFilterFormRef = Application.Forms(FormName)

End Function

Private Sub OpenFormIfClosed(ByVal FormName As String)
   If Not CurrentProject.AllForms(FormName).IsLoaded Then
      DoCmd.OpenForm FormName, acDesign, , , , acHidden
   End If
End Sub

Private Sub cbxFormName_GotFocus()
   LoadForms
End Sub

Private Sub LoadForms()
   Me.cbxFormName.RowSource = "Select Name FROM [" & SourceDb.Name & "].MSysObjects where Type = -32768 Order By Name"
End Sub

Private Sub cbxUseFilterSubForm_AfterUpdate()
   RefreshAddFilterButtonEnableMode
End Sub

Private Sub cbxUseFilterSubForm_GotFocus()
   RefreshSubFormList
End Sub

Private Sub RefreshSubFormList()

   Dim frm As Form
   Dim ctl As Control

   Me.cbxUseFilterSubForm.RowSource = vbNullString
   
   Set frm = GetFilterFormRef
   If frm Is Nothing Then
      Exit Sub
   End If

   For Each ctl In frm.Controls
      Select Case ctl.ControlType
         Case AcControlType.acSubform
            Me.cbxUseFilterSubForm.AddItem ctl.Name
      End Select
   Next

End Sub

Private Sub cmdAddFilterControManagerToForm_Click()
   AddFilterControManagerToForm
End Sub

Private Sub AddFilterControManagerToForm()

   Dim FormName As String

   FormName = Nz(Me.cbxFormName.Value, vbNullString)
   If Len(FormName) = 0 Then
      MsgBox "Bitte zuerst Formular auswählen"
      Exit Sub
   End If
   With New FilterControlManagerImporter
      AddControlsToImporter .Self
      .WriteToForm Me.cbxFormName.Value, Nz(Me.UseFilterMethodOptions.Value, 0), Nz(Me.cbxUseFilterSubForm.Value, vbNullString)
   End With

   CheckModules

   Me.SetFocus

End Sub

Private Sub AddControlsToImporter(ByVal Importer As FilterControlManagerImporter)
   
   Me.sfrFilterControls.Form.AddControlsToImporter Importer

End Sub

Private Sub Form_Current()
   CheckModules
End Sub

Private Sub OpenReplaceModulesContextMenu(ByRef ctlMenuControl As Control, ByVal x As Single, ByVal y As Single)

   Dim mnu As WinApiShortcutMenu
   Dim lngSelectedMenuItem As Long

   Set mnu = New WinApiShortcutMenu
      
   With mnu
      .ControlSection = acDetail
      Set .AccessForm = Me
      Set .MenuControl = ctlMenuControl
      
      .AddMenuItem 1, "Alle Codemodule erneuern (vorhandene Module werden überschrieben)"
      .AddMenuItem 2, "Alle Codemodule außer 'SqlTools' erneuern (SqlTools bleibt unverändert)"
      
   End With
   
   lngSelectedMenuItem = mnu.OpenMenu(x, y)
   Select Case lngSelectedMenuItem
      Case 1
         ReplaceAllModules True
      Case 2
         ReplaceAllModules False
      Case Else
         '
   End Select

   Set mnu = Nothing

End Sub

Private Sub ReplaceAllModules(Optional ByVal bolWithSqlTools As Boolean = False)
   
   Dim bolReplaced As Boolean

On Error Resume Next
   
   With CodeModulImporter
      If bolWithSqlTools Then
         bolReplaced = .ReplaceCodeModules("SqlTools", "StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
      Else
         bolReplaced = .ReplaceCodeModules("StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
      End If
   End With

   If bolReplaced Then
   
      SetModulCopyControls "CopyModulSqlTools", True
      SetModulCopyControls "CopyModulFilterStringBuilder", True
      SetModulCopyControls "CopyModulFilterControlManager", True
      SetModulCopyControls "CopyModules", True
   
      If m_OpenModules = 0 Then
         MsgBox "Codemodule wurden aktualisiert"
      End If
      
      m_OpenModules = 0
      
   End If
   
End Sub

Private Sub Form_Open(Cancel As Integer)
   Me.Caption = Me.Caption & "  " & ChrW(&H25AA) & "  Version " & CurrentApplication.Version
End Sub

Private Sub labCopyCaption_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)

   If Button = 1 Or Button = 2 Then
      OpenReplaceModulesContextMenu Me.labCopyCaption, x, y
   End If

End Sub

Private Sub CheckModules()
   
   Dim bolCheckOK As Boolean
   
On Error Resume Next
   
   m_OpenModules = 0

   With CodeModulImporter
      bolCheckOK = .CheckCodeModules("SqlTools")
      m_OpenModules = m_OpenModules + 1 + bolCheckOK
      SetModulCopyControls "CopyModulSqlTools", bolCheckOK
      
      bolCheckOK = .CheckCodeModules("StringCollection", "FilterStringBuilder")
      m_OpenModules = m_OpenModules + 1 + bolCheckOK
      SetModulCopyControls "CopyModulFilterStringBuilder", bolCheckOK
      
      bolCheckOK = .CheckCodeModules("FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
      m_OpenModules = m_OpenModules + 1 + bolCheckOK
      SetModulCopyControls "CopyModulFilterControlManager", bolCheckOK
      
      bolCheckOK = (m_OpenModules = 0)
      SetModulCopyControls "CopyModules", bolCheckOK
   End With
   
End Sub

Private Sub cmdCopyModulSqlTools_Click()

   CodeModulImporter.TransferCodeModules "SqlTools"
   m_OpenModules = m_OpenModules - 1
   SetModulCopyControls "CopyModulSqlTools", True

End Sub

Private Sub cmdCopyModulFilterControlManager_Click()

   With CodeModulImporter
      .TransferCodeModules "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager"
      m_OpenModules = m_OpenModules - 1
      If Not .CheckCodeModules("StringCollection", "FilterStringBuilder") Then
         cmdCopyModulFilterStringBuilder_Click
      End If
      SetModulCopyControls "CopyModulFilterControlManager", True
   End With

End Sub

Private Sub cmdCopyModulFilterStringBuilder_Click()

   With CodeModulImporter
      .TransferCodeModules "StringCollection", "FilterStringBuilder"
      m_OpenModules = m_OpenModules - 1
      If Not .CheckCodeModules("SqlTools") Then
         cmdCopyModulSqlTools_Click
      End If
      SetModulCopyControls "CopyModulFilterStringBuilder", True
   End With

End Sub

Private Sub cmdCopyModules_Click()

   CodeModulImporter.TransferCodeModules "SqlTools", "StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager"
   SetModulCopyControls "CopyModulSqlTools", True
   SetModulCopyControls "CopyModulFilterStringBuilder", True
   SetModulCopyControls "CopyModulFilterControlManager", True
   SetModulCopyControls "CopyModules", True
   m_OpenModules = 0

End Sub

Private Sub SetModulCopyControls(ByVal sModulCode As String, ByVal bExists As Boolean)
   
   Dim sCaption As String
   Dim lBorderStyle As Long
   
On Error Resume Next
   
   If bExists Then Me.sysFirst.SetFocus
   Me.Controls("cmd" & sModulCode).Enabled = Not bExists
   If bExists Then
      sCaption = "b"
      lBorderStyle = 0
   Else
      sCaption = vbNullString
      lBorderStyle = 1
   End If
   With Me.Controls("lab" & sModulCode)
      .Caption = sCaption
      .BorderStyle = lBorderStyle
   End With
 
   If sModulCode <> "CopyModules" And m_OpenModules = 0 Then
      SetModulCopyControls "CopyModules", True
   End If
   
End Sub

Private Sub UseFilterMethodOptions_AfterUpdate()

   With Me.cbxUseFilterSubForm
      .Enabled = (Me.UseFilterMethodOptions = m_SubFormUseFilterOption)
      If .Enabled = False Then .Value = Null
   End With

   RefreshAddFilterButtonEnableMode

End Sub