Version =20
VersionRequired =20
Checksum =-1539093016
Begin Form
    AllowFilters = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    AllowAdditions = NotDefault
    KeyPreview = NotDefault
    DefaultView =0
    ScrollBars =0
    TabularFamily =119
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridY =10
    Width =10732
    DatasheetFontHeight =10
    ItemSuffix =120
    Left =4152
    Top =1092
    Right =14880
    Bottom =7104
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x668d2cd46a58e440
    End
    GUID = Begin
        0x8f309169ffbfbd4ebbb375424a700b57
    End
    Caption ="ACLib FilterForm Wizard"
    OnCurrent ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xae050000ae050000ae050000ae05000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0104f0a49c00a00753ef8003010009009a0b3408640001000f00580202000200 ,
        0x5802030001000000000000000000000000000000000000e0fe3f000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001010000010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010000000100000009000000b30d0000b0090000020000000100000001000000 ,
        0x9dffffff02000000020000000100000000000000010100000200000002000000 ,
        0x0300000005000000000000000000000001000000010100000101000000000000 ,
        0x0000000000000000000000000000000001000000000000000100000000000000 ,
        0x0100000001000000000000000200000002000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000002000000 ,
        0x0100000008000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000001000000010000009dffffff01000000 ,
        0x0101000009000000000000000000000000000000284e4f4e4529000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000a005000000000000 ,
        0xc2010000c2010000900100000000000030000022417269616c00000000000000 ,
        0x0000000000000000000000000000000000000000000000003200000000000000 ,
        0x0000000000000000284e4f4e4529000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000a005000000000000c2010000c201000090010000 ,
        0x0000000030000022417269616c00000000000000000000000000000000000000 ,
        0x0000000000000000000000003200000000000000000000000000000000000000 ,
        0xf0a497bc4c65786d61726b20533330302d533430302053657269657300000000 ,
        0x0000000038010000f0a497bc9dff580200000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000080000 ,
        0x0100000000000000ffff00000000000000000000000000000000630000000000 ,
        0x0100010001000100000002000100f802f6047008e01000000000000001000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000536f6674776172655c4c65786d61726b496e6b6a6574000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000010001000100010000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000001000100 ,
        0x0100010000000000000000000000000000000000000001009dff04009dffffff ,
        0xfefffcff00000000000000000000000001005802040058022c01580258020000 ,
        0x0000000000000000000001005802040058022c015802c0120000000000000000 ,
        0x00000000010058020400580258025802b0040000000000000000000000000100 ,
        0x060004000600010002000500000000000000000000000000f0a497bc
    End
    PrtDevNames = Begin
        0x0800210042000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000555342303035000000000000000000
    End
    FilterOnLoad =0
    ShowPageMargins =0
    AllowLayoutView =0
    DatasheetGridlinesColor12 =12632256
    PrtDevModeW = Begin
        0x0000eb7184f4a901d0067d0c04d7a00052168675b4a9a901101686755e168675 ,
        0x6027c30cd0067d0c94db20010000000000a00000000000002208100000a00000 ,
        0x0104f0a4dc00a00753ef8003010009009a0b3408640001000f00580202000200 ,
        0x58020300010000001075d50100000000b4a9a90190a3541b78a3541baca3541b ,
        0x78a3541b7000000008000000d4aea90101000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001010000010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010000000100000009000000b30d0000b0090000020000000100000001000000 ,
        0x9dffffff02000000020000000100000000000000010100000200000002000000 ,
        0x0300000005000000000000000000000001000000010100000101000000000000 ,
        0x0000000000000000000000000000000001000000000000000100000000000000 ,
        0x0100000001000000000000000200000002000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000002000000 ,
        0x0100000008000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000001000000010000009dffffff01000000 ,
        0x0101000009000000000000000000000000000000284e4f4e4529000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000a005000000000000 ,
        0xc2010000c2010000900100000000000030000022417269616c00000000000000 ,
        0x0000000000000000000000000000000000000000000000003200000000000000 ,
        0x0000000000000000284e4f4e4529000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000a005000000000000c2010000c201000090010000 ,
        0x0000000030000022417269616c00000000000000000000000000000000000000 ,
        0x0000000000000000000000003200000000000000000000000000000000000000 ,
        0xf0a497bc4c65786d61726b20533330302d533430302053657269657300000000 ,
        0x0000000038010000f0a497bc9dff580200000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000080000 ,
        0x0100000000000000ffff00000000000000000000000000000000630000000000 ,
        0x0100010001000100000002000100f802f6047008e01000000000000001000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000536f6674776172655c4c65786d61726b496e6b6a6574000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000010001000100010000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000001000100 ,
        0x0100010000000000000000000000000000000000000001009dff04009dffffff ,
        0xfefffcff00000000000000000000000001005802040058022c01580258020000 ,
        0x0000000000000000000001005802040058022c015802c0120000000000000000 ,
        0x00000000010058020400580258025802b0040000000000000000000000000100 ,
        0x060004000600010002000500000000000000000000000000f0a497bc
    End
    PrtDevNamesW = Begin
        0x04001d003e000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000055005300 ,
        0x4200300030003500000000000000000000000000000000000000
    End
    
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
        End
        Begin Line
            BorderLineStyle =0
            Width =1701
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin OptionButton
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =3
            BorderShade =90.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CheckBox
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin ComboBox
            SpecialEffect =2
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
        End
        Begin Subform
            BorderLineStyle =0
            Width =1701
            Height =1701
            BorderThemeColorIndex =3
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =90.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin ToggleButton
            Width =283
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin Section
            CanGrow = NotDefault
            Height =6029
            BackColor =-2147483633
            Name ="Detailbereich"
            GUID = Begin
                0xfeffd8470a0a9b46abd37d015aab40c1
            End
            Begin
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2381
                    Top =5081
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulFilterStringBuilder"
                    FontName ="Marlett"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xdd6a6769d341054eb9b6a296fae08f29
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2381
                    LayoutCachedTop =5081
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =5376
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2381
                    Top =4721
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulFilterControlManager"
                    FontName ="Marlett"
                    GUID = Begin
                        0x305cae0a69ac99408cdac46d5e2689ce
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2381
                    LayoutCachedTop =4721
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =5016
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2381
                    Top =5441
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulSqlTools"
                    FontName ="Marlett"
                    GUID = Begin
                        0x1d0212a8607e14459c58854d3069900b
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2381
                    LayoutCachedTop =5441
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =5736
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =2381
                    Top =4376
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModules"
                    FontName ="Marlett"
                    GUID = Begin
                        0xbe7161d84c13b5499ad792e6366b9eac
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2381
                    LayoutCachedTop =4376
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =4671
                End
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =2
                    Left =2784
                    Top =4215
                    Width =0
                    Height =1814
                    Name ="Linie49"
                    GUID = Begin
                        0x6c2c3106ded8534c87892e2ee126530c
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =2784
                    LayoutCachedTop =4215
                    LayoutCachedWidth =2784
                    LayoutCachedHeight =6029
                End
                Begin TextBox
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    Name ="sysFirst"
                    GUID = Begin
                        0x4d21045caadf464383f75e79a673ebd4
                    End

                End
                Begin CommandButton
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =7425
                    Top =5475
                    Width =3072
                    Height =375
                    FontSize =10
                    TabIndex =4
                    Name ="cmdAddFilterCodeToForm"
                    Caption ="Formular-Code einfügen"
                    OnClick ="[Event Procedure]"
                    FontName ="Verdana"
                    GUID = Begin
                        0x5bd9780ad5280e4ca3a72fc65582233c
                    End
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =7425
                    LayoutCachedTop =5475
                    LayoutCachedWidth =10497
                    LayoutCachedHeight =5850
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin Label
                    OverlapFlags =85
                    Left =356
                    Top =4746
                    Width =1991
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulFilterControlManager"
                    Caption ="FilterControlManager"
                    GUID = Begin
                        0x8b2a1e9b456dac47a589d89260e7cd9d
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =356
                    LayoutCachedTop =4746
                    LayoutCachedWidth =2347
                    LayoutCachedHeight =5001
                End
                Begin Label
                    OverlapFlags =85
                    Left =356
                    Top =5106
                    Width =1991
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulFilterStringBuilder"
                    Caption ="FilterStringBuilder"
                    GUID = Begin
                        0x502db6c278e7644e80b7bb465da8086e
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =356
                    LayoutCachedTop =5106
                    LayoutCachedWidth =2347
                    LayoutCachedHeight =5361
                End
                Begin Label
                    OverlapFlags =85
                    Left =356
                    Top =5466
                    Width =1991
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulSqlTools"
                    Caption ="SqlTools"
                    GUID = Begin
                        0xdd04a61804b3d3489636dea0aac6d966
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =356
                    LayoutCachedTop =5466
                    LayoutCachedWidth =2347
                    LayoutCachedHeight =5721
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =2381
                    Top =5081
                    Width =295
                    Height =295
                    TabIndex =5
                    Name ="cmdCopyModulFilterStringBuilder"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc8975d8c2da3304ebb127dc3080d923e
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2381
                    LayoutCachedTop =5081
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =5376
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =2381
                    Top =4721
                    Width =295
                    Height =295
                    TabIndex =3
                    Name ="cmdCopyModulFilterControlManager"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc0cb35c7d786bf44aefdc3b2945a0498
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2381
                    LayoutCachedTop =4721
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =5016
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =2381
                    Top =5441
                    Width =295
                    Height =295
                    TabIndex =6
                    Name ="cmdCopyModulSqlTools"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xb1a983cde9722b43a3e535cf8b426c67
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2381
                    LayoutCachedTop =5441
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =5736
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =93
                    Left =120
                    Top =4398
                    Width =2145
                    Height =255
                    FontSize =9
                    FontWeight =700
                    ForeColor =16737792
                    Name ="labCopyCaption"
                    Caption ="Klassen installieren:"
                    OnMouseDown ="[Event Procedure]"
                    OnMouseMove ="[Event Procedure]"
                    GUID = Begin
                        0x6fdf1d4132b76c429cd92273cd9ef89b
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =120
                    LayoutCachedTop =4398
                    LayoutCachedWidth =2265
                    LayoutCachedHeight =4653
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =223
                    Left =2381
                    Top =4376
                    Width =295
                    Height =295
                    TabIndex =1
                    Name ="cmdCopyModules"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x71b2bb2e794e5a4183b92a358e952ad8
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =2381
                    LayoutCachedTop =4376
                    LayoutCachedWidth =2676
                    LayoutCachedHeight =4671
                    WebImagePaddingLeft =3
                    WebImagePaddingTop =3
                    WebImagePaddingRight =2
                    WebImagePaddingBottom =2
                    Overlaps =1
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =2039
                    Top =170
                    Width =3402
                    Height =285
                    FontSize =10
                    TabIndex =2
                    GUID = Begin
                        0x9ae17955cc84ce48bbcca6b1a3566263
                    End
                    Name ="cbxFormName"
                    RowSourceType ="Table/Query"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Verdana"
                    OnGotFocus ="[Event Procedure]"

                    LayoutCachedLeft =2039
                    LayoutCachedTop =170
                    LayoutCachedWidth =5441
                    LayoutCachedHeight =455
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =113
                            Top =170
                            Width =1920
                            Height =285
                            FontSize =10
                            Name ="Bezeichnungsfeld89"
                            Caption ="Formular wählen:"
                            FontName ="Verdana"
                            GUID = Begin
                                0x686faf8a460dc643aef4f21fb057114d
                            End
                            LayoutCachedLeft =113
                            LayoutCachedTop =170
                            LayoutCachedWidth =2033
                            LayoutCachedHeight =455
                        End
                    End
                End
                Begin Subform
                    Enabled = NotDefault
                    OverlapFlags =87
                    SpecialEffect =3
                    Left =120
                    Top =900
                    Width =10605
                    Height =3255
                    TabIndex =7
                    BorderColor =-2147483630
                    Name ="sfrFilterControls"
                    SourceObject ="Form.frmFilterFormWizard_SF_Controls"
                    GUID = Begin
                        0x31310376de53cf4f94a5b24ab61e1a1a
                    End
                    GridlineColor =10921638
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedLeft =120
                    LayoutCachedTop =900
                    LayoutCachedWidth =10725
                    LayoutCachedHeight =4155
                    BorderThemeColorIndex =-1
                    BorderShade =100.0
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =120
                            Top =615
                            Width =1920
                            Height =285
                            FontSize =10
                            Name ="Bezeichnungsfeld90"
                            Caption ="FilterControls:"
                            GUID = Begin
                                0x316e57d56817c141a27648ce160be30c
                            End
                            LayoutCachedLeft =120
                            LayoutCachedTop =615
                            LayoutCachedWidth =2040
                            LayoutCachedHeight =900
                        End
                    End
                End
                Begin OptionGroup
                    Enabled = NotDefault
                    OverlapFlags =93
                    Left =3465
                    Top =4621
                    Width =3681
                    Height =1304
                    TabIndex =9
                    Name ="UseFilterMethodOptions"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    GUID = Begin
                        0x467177d9c56ca94a880a2e7ea0a3df15
                    End
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =3465
                    LayoutCachedTop =4621
                    LayoutCachedWidth =7146
                    LayoutCachedHeight =5925
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            Left =3581
                            Top =4501
                            Width =1395
                            Height =240
                            BackColor =-2147483633
                            Name ="Bezeichnungsfeld92"
                            Caption ="UseFilter-Methode"
                            GUID = Begin
                                0x6e694148f314bf4eae763e55e8443045
                            End
                            HorizontalAnchor =1
                            VerticalAnchor =1
                            LayoutCachedLeft =3581
                            LayoutCachedTop =4501
                            LayoutCachedWidth =4976
                            LayoutCachedHeight =4741
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =3615
                            Top =4893
                            OptionValue =0
                            BorderColor =13553360
                            Name ="Option93"
                            GUID = Begin
                                0x2ed9a0b87581e9459437795c1ea4f08f
                            End
                            GridlineColor =10921638
                            HorizontalAnchor =1
                            VerticalAnchor =1

                            LayoutCachedLeft =3615
                            LayoutCachedTop =4893
                            LayoutCachedWidth =3875
                            LayoutCachedHeight =5133
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =3840
                                    Top =4861
                                    Width =3075
                                    Height =240
                                    Name ="Bezeichnungsfeld94"
                                    Caption ="auskommentierten Beispiel-Code einfügen"
                                    GUID = Begin
                                        0x45350e3d0a7cde4ca18753d3df2a7a50
                                    End
                                    HorizontalAnchor =1
                                    VerticalAnchor =1
                                    LayoutCachedLeft =3840
                                    LayoutCachedTop =4861
                                    LayoutCachedWidth =6915
                                    LayoutCachedHeight =5101
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =3615
                            Top =5203
                            TabIndex =1
                            OptionValue =1
                            BorderColor =13553360
                            Name ="Option95"
                            GUID = Begin
                                0x918bf012f5ab6a4a82b18d8d78de17cb
                            End
                            GridlineColor =10921638
                            HorizontalAnchor =1
                            VerticalAnchor =1

                            LayoutCachedLeft =3615
                            LayoutCachedTop =5203
                            LayoutCachedWidth =3875
                            LayoutCachedHeight =5443
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =3844
                                    Top =5176
                                    Width =3049
                                    Height =240
                                    Name ="Bezeichnungsfeld96"
                                    Caption ="aktuelles Formular filtern"
                                    GUID = Begin
                                        0xdcea6dbc2fc72b438c7c28fb17bae4f6
                                    End
                                    HorizontalAnchor =1
                                    VerticalAnchor =1
                                    LayoutCachedLeft =3844
                                    LayoutCachedTop =5176
                                    LayoutCachedWidth =6893
                                    LayoutCachedHeight =5416
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =3615
                            Top =5546
                            TabIndex =2
                            OptionValue =2
                            BorderColor =13553360
                            Name ="Option97"
                            GUID = Begin
                                0x03d2ddc59a72074694568a25b639186a
                            End
                            GridlineColor =10921638
                            HorizontalAnchor =1
                            VerticalAnchor =1

                            LayoutCachedLeft =3615
                            LayoutCachedTop =5546
                            LayoutCachedWidth =3875
                            LayoutCachedHeight =5786
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =3844
                                    Top =5516
                                    Width =1114
                                    Height =240
                                    Name ="Bezeichnungsfeld98"
                                    Caption ="Unterformular"
                                    GUID = Begin
                                        0x743cbf1b4fad704a87f1096bb7ea5c8e
                                    End
                                    HorizontalAnchor =1
                                    VerticalAnchor =1
                                    LayoutCachedLeft =3844
                                    LayoutCachedTop =5516
                                    LayoutCachedWidth =4958
                                    LayoutCachedHeight =5756
                                End
                            End
                        End
                    End
                End
                Begin ComboBox
                    Enabled = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =247
                    IMESentenceMode =3
                    ListWidth =3402
                    Left =4958
                    Top =5516
                    Width =2061
                    TabIndex =8
                    GUID = Begin
                        0xd2abcc3725b6174684facff57821578b
                    End
                    Name ="cbxUseFilterSubForm"
                    RowSourceType ="Value List"
                    ColumnWidths ="3402"
                    AfterUpdate ="[Event Procedure]"
                    OnGotFocus ="[Event Procedure]"
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =4958
                    LayoutCachedTop =5516
                    LayoutCachedWidth =7019
                    LayoutCachedHeight =5756
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =3
                    Left =1680
                    Top =4188
                    Width =1080
                    Height =210
                    FontSize =7
                    Name ="Bezeichnungsfeld101"
                    Caption ="bereits installiert"
                    FontName ="Small Fonts"
                    GUID = Begin
                        0x9586ac4241703346a1cfd7ee0517764e
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =1680
                    LayoutCachedTop =4188
                    LayoutCachedWidth =2760
                    LayoutCachedHeight =4398
                End
                Begin OptionGroup
                    Enabled = NotDefault
                    OverlapFlags =215
                    Left =7245
                    Top =4620
                    Width =3458
                    Height =1304
                    TabIndex =10
                    Name ="FormCodeOptions"
                    DefaultValue ="1"
                    GUID = Begin
                        0xed45349e0bb4624d802c11bd5a81e244
                    End
                    HorizontalAnchor =1
                    VerticalAnchor =1

                    LayoutCachedLeft =7245
                    LayoutCachedTop =4620
                    LayoutCachedWidth =10703
                    LayoutCachedHeight =5924
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            Left =7361
                            Top =4500
                            Width =1395
                            Height =240
                            BackColor =-2147483633
                            Name ="Label104"
                            Caption ="Filter-Variante"
                            GUID = Begin
                                0x4cd36eb1b18bd14090e780e9374d713e
                            End
                            HorizontalAnchor =1
                            VerticalAnchor =1
                            LayoutCachedLeft =7361
                            LayoutCachedTop =4500
                            LayoutCachedWidth =8756
                            LayoutCachedHeight =4740
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =7395
                            Top =4892
                            OptionValue =1
                            BorderColor =13553360
                            Name ="Option105"
                            GUID = Begin
                                0x9360b4bcc3c8bf48a0506593b1be6c0a
                            End
                            GridlineColor =10921638
                            HorizontalAnchor =1
                            VerticalAnchor =1

                            LayoutCachedLeft =7395
                            LayoutCachedTop =4892
                            LayoutCachedWidth =7655
                            LayoutCachedHeight =5132
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =7620
                                    Top =4860
                                    Width =2985
                                    Height =240
                                    Name ="Label106"
                                    Caption ="FilterControlManager-Methoden"
                                    GUID = Begin
                                        0x96fff90c3e8c3744973d78912bd996cc
                                    End
                                    HorizontalAnchor =1
                                    VerticalAnchor =1
                                    LayoutCachedLeft =7620
                                    LayoutCachedTop =4860
                                    LayoutCachedWidth =10605
                                    LayoutCachedHeight =5100
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            Left =7395
                            Top =5202
                            TabIndex =1
                            OptionValue =2
                            BorderColor =13553360
                            Name ="Option107"
                            GUID = Begin
                                0x3b9786ef86a3784a9dd3a8c5ebed31d9
                            End
                            GridlineColor =10921638
                            HorizontalAnchor =1
                            VerticalAnchor =1

                            LayoutCachedLeft =7395
                            LayoutCachedTop =5202
                            LayoutCachedWidth =7655
                            LayoutCachedHeight =5442
                            Begin
                                Begin Label
                                    OverlapFlags =247
                                    Left =7624
                                    Top =5175
                                    Width =2959
                                    Height =240
                                    Name ="Label108"
                                    Caption ="FilterStringBuilder-Methoden"
                                    GUID = Begin
                                        0x69dd7bb4498fde4eadebb58c04022929
                                    End
                                    HorizontalAnchor =1
                                    VerticalAnchor =1
                                    LayoutCachedLeft =7624
                                    LayoutCachedTop =5175
                                    LayoutCachedWidth =10583
                                    LayoutCachedHeight =5415
                                End
                            End
                        End
                    End
                End
                Begin ComboBox
                    OverlapFlags =87
                    IMESentenceMode =3
                    ColumnCount =4
                    Left =8820
                    Top =4200
                    Width =1836
                    TabIndex =11
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"40\""
                    GUID = Begin
                        0x441a7ad565bdaf4ba272387b51e93fe5
                    End
                    Name ="cbxSqlLang"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT tabSqlLangFormat.SqlLang, tabSqlLangFormat.SqlDateFormat, tabSqlLangForma"
                        "t.SqlBooleanTrueString, tabSqlLangFormat.SqlWildCardString FROM tabSqlLangFormat"
                        " ORDER BY tabSqlLangFormat.SqlLang;"
                    ColumnWidths ="1701;0;0;0"
                    DefaultValue ="\"Jet/DAO\""
                    HorizontalAnchor =1

                    LayoutCachedLeft =8820
                    LayoutCachedTop =4200
                    LayoutCachedWidth =10656
                    LayoutCachedHeight =4440
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =7755
                            Top =4200
                            Width =1065
                            Height =240
                            RightMargin =29
                            Name ="Label112"
                            Caption ="SQL-Dialekt:"
                            GUID = Begin
                                0x14d7ced7ebfa2f4dbad32c7023fb2a33
                            End
                            HorizontalAnchor =1
                            LayoutCachedLeft =7755
                            LayoutCachedTop =4200
                            LayoutCachedWidth =8820
                            LayoutCachedHeight =4440
                        End
                    End
                End
                Begin ComboBox
                    Enabled = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    IMESentenceMode =3
                    ListWidth =2268
                    Left =9332
                    Top =299
                    Width =1311
                    TabIndex =12
                    GUID = Begin
                        0x7fbc37c8d7358d42adb800f0c274acc7
                    End
                    Name ="cbxRemoveFilterCtl"
                    RowSourceType ="Value List"
                    HorizontalAnchor =1

                    LayoutCachedLeft =9332
                    LayoutCachedTop =299
                    LayoutCachedWidth =10643
                    LayoutCachedHeight =539
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =6405
                            Top =303
                            Width =2925
                            Height =240
                            RightMargin =29
                            Name ="Label114"
                            Caption ="CommandButton \"Filter löschen\":"
                            GUID = Begin
                                0xe5c1e8b3e7057c4ea77f36613572cde1
                            End
                            HorizontalAnchor =1
                            LayoutCachedLeft =6405
                            LayoutCachedTop =303
                            LayoutCachedWidth =9330
                            LayoutCachedHeight =543
                        End
                    End
                End
                Begin ComboBox
                    Enabled = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    IMESentenceMode =3
                    Left =9332
                    Top =15
                    Width =1311
                    TabIndex =13
                    GUID = Begin
                        0x468d75b535427e479ada1078d0e59ce2
                    End
                    Name ="cbxUseFilterCtl"
                    RowSourceType ="Value List"
                    ColumnWidths ="2268"
                    HorizontalAnchor =1

                    LayoutCachedLeft =9332
                    LayoutCachedTop =15
                    LayoutCachedWidth =10643
                    LayoutCachedHeight =255
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =6405
                            Top =19
                            Width =2925
                            Height =240
                            RightMargin =29
                            Name ="Label116"
                            Caption ="CommandButton \"Filter anwenden\":"
                            GUID = Begin
                                0xf68078d376144d4793b250bb6c33fe72
                            End
                            HorizontalAnchor =1
                            LayoutCachedLeft =6405
                            LayoutCachedTop =19
                            LayoutCachedWidth =9330
                            LayoutCachedHeight =259
                        End
                    End
                End
                Begin ComboBox
                    Enabled = NotDefault
                    RowSourceTypeInt =1
                    OverlapFlags =87
                    IMESentenceMode =3
                    ListWidth =2268
                    Left =9333
                    Top =589
                    Width =1311
                    TabIndex =14
                    GUID = Begin
                        0xa00a87a1d6cb4544b317178021673676
                    End
                    Name ="cbxAutoFilterCtl"
                    RowSourceType ="Value List"
                    HorizontalAnchor =1

                    LayoutCachedLeft =9333
                    LayoutCachedTop =589
                    LayoutCachedWidth =10644
                    LayoutCachedHeight =829
                    Begin
                        Begin Label
                            OverlapFlags =93
                            TextAlign =3
                            Left =6406
                            Top =593
                            Width =2925
                            Height =240
                            RightMargin =29
                            Name ="Label118"
                            Caption ="AutoFilter-Checkbox:"
                            GUID = Begin
                                0x7236fa277bfd404d87113a1a58418527
                            End
                            HorizontalAnchor =1
                            LayoutCachedLeft =6406
                            LayoutCachedTop =593
                            LayoutCachedWidth =9331
                            LayoutCachedHeight =833
                        End
                    End
                End
                Begin Label
                    FontUnderline = NotDefault
                    OverlapFlags =85
                    TextAlign =1
                    Left =96
                    Top =5760
                    Width =2568
                    Height =240
                    ForeColor =16737792
                    Name ="labCheckVersion"
                    Caption ="Wizard-Version prüfen"
                    OnClick ="[Event Procedure]"
                    OnMouseMove ="[Event Procedure]"
                    Tag ="unchecked"
                    GUID = Begin
                        0xdcdeffa97bf2ca4f8f5702328eae0b9b
                    End
                    VerticalAnchor =1
                    LayoutCachedLeft =96
                    LayoutCachedTop =5760
                    LayoutCachedWidth =2664
                    LayoutCachedHeight =6000
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------------------------------------------------------------
' Form: frmFilterFormWizard
'---------------------------------------------------------------------------------------
'/**
' \author       Josef Poetzl
' <summary>
' Wizard-Form für FilterControlManager-Import
' </summary>
' <remarks></remarks>
'**/
'---------------------------------------------------------------------------------------
'<codelib>
'  <file>_codelib/addins/FilterFormWizard/frmFilterFormWizard.frm</file>
'  <license>_codelib/license.bas</license>
'  <use>_codelib/addins/FilterFormWizard/FilterFormCodeImporter.cls</use>
'  <use>_codelib/addins/shared/AppFileCodeModulTransfer.cls</use>
'  <use>_codelib/addins/FilterFormWizard/frmFilterFormWizard_SF_Controls.frm</use>
'</codelib>
'---------------------------------------------------------------------------------------
'
Option Compare Database
Option Explicit

Private m_OpenModules As Long
Private m_CodeModulImporter As AppFileCodeModulTransfer

Private Const m_SubFormUseFilterOption As Long = 2

'Datenquellen für Formular (je nachdem ob Formular für FE-Verbindung bzw. Vorlage verwendet wird):
Private Property Get SourceDb() As DAO.Database
   Set SourceDb = CurrentDb
End Property

Private Property Get CodeModulImporter() As AppFileCodeModulTransfer
   If m_CodeModulImporter Is Nothing Then
      Set m_CodeModulImporter = New AppFileCodeModulTransfer
   End If
   Set CodeModulImporter = m_CodeModulImporter
End Property

Private Sub cbxFormName_AfterUpdate()

   Dim FormName As String
   Dim FormSelected As Boolean
   Dim FormRef As Form

   RefreshAddFilterButtonEnableMode
   
   FormName = Nz(Me.cbxFormName.Value, vbNullString)
   FormSelected = (Len(FormName) > 0)

   Me.sfrFilterControls.Enabled = FormSelected
   Me.cbxUseFilterCtl.Enabled = FormSelected
   Me.cbxRemoveFilterCtl.Enabled = FormSelected
   Me.cbxAutoFilterCtl.Enabled = FormSelected
   
   Me.UseFilterMethodOptions.Enabled = FormSelected
   With Me.cbxUseFilterSubForm
      .Enabled = FormSelected And (Me.UseFilterMethodOptions = m_SubFormUseFilterOption)
      .Value = Null
   End With
   
   Me.FormCodeOptions.Enabled = FormSelected
   
   If Not FormSelected Then
      Me.cbxFormName.RowSource = vbNullString
      Me.sfrFilterControls.Form.InitFilterForm Nothing
      Me.cbxUseFilterSubForm.RowSource = vbNullString
      Exit Sub
   End If

   Set FormRef = GetFilterFormRef
   
   LoadControlsFromForm FormRef

End Sub

Private Sub RefreshAddFilterButtonEnableMode()
   
   Dim bolEnable As Boolean

   bolEnable = (Len(Nz(Me.cbxFormName.Value, vbNullString)) > 0)
   
   If bolEnable Then
      If Me.UseFilterMethodOptions.Value = 2 Then
         bolEnable = (Len(Nz(Me.cbxUseFilterSubForm.Value, vbNullString)) > 0)
      End If
   End If

   Me.cmdAddFilterCodeToForm.Enabled = bolEnable

End Sub

Private Function GetFilterFormRef() As Form

   Dim FormName As String

   FormName = Nz(Me.cbxFormName.Value, vbNullString)
   If Len(FormName) = 0 Then
      Set GetFilterFormRef = Nothing
      Exit Function
   End If

   OpenFormIfClosed FormName
   Set GetFilterFormRef = Application.Forms(FormName)

End Function

Private Sub OpenFormIfClosed(ByVal FormName As String)
   If Not CurrentProject.AllForms(FormName).IsLoaded Then
      DoCmd.OpenForm FormName, acDesign, , , , acHidden
   End If
End Sub

Private Sub cbxFormName_GotFocus()
   LoadForms
End Sub

Private Sub LoadForms()
   Me.cbxFormName.RowSource = "Select Name FROM [" & SourceDb.Name & "].MSysObjects where Type = -32768 Order By Name"
End Sub

Private Sub cbxUseFilterSubForm_AfterUpdate()
   RefreshAddFilterButtonEnableMode
End Sub

Private Sub cbxUseFilterSubForm_GotFocus()
   RefreshSubFormList
End Sub

Private Sub RefreshSubFormList()

   Dim frm As Form
   Dim ctl As Control

   Me.cbxUseFilterSubForm.RowSource = vbNullString
   
   Set frm = GetFilterFormRef
   If frm Is Nothing Then
      Exit Sub
   End If

   For Each ctl In frm.Controls
      Select Case ctl.ControlType
         Case AcControlType.acSubform
            Me.cbxUseFilterSubForm.AddItem ctl.Name
      End Select
   Next

End Sub

Private Sub AddFilterCodeToForm(ByVal ImporterRef As IFilterFormCodeBuilder)

   Dim FormName As String

   FormName = Nz(Me.cbxFormName.Value, vbNullString)
   If Len(FormName) = 0 Then
      MsgBox "Bitte zuerst Formular auswählen", , CurrentApplication.ApplicationName
      Exit Sub
   End If
   
   With New FilterFormCodeImporter
   
      Set .Importer = ImporterRef
   
      AddControlsToImporter .Self, FormName
      
      .WriteToForm Me.cbxFormName.Value, _
                   Nz(Me.UseFilterMethodOptions.Value, 0), _
                   Nz(Me.cbxUseFilterSubForm.Value, vbNullString), _
                   Nz(Me.cbxSqlLang.Column(1), vbNullString), _
                   Nz(Me.cbxSqlLang.Column(2), vbNullString), _
                   Nz(Me.cbxSqlLang.Column(3), vbNullString), _
                   Nz(Me.cbxUseFilterCtl.Value, vbNullString), _
                   Nz(Me.cbxRemoveFilterCtl.Value, vbNullString), _
                   Nz(Me.cbxAutoFilterCtl.Value, vbNullString)

   End With

   CheckModules

   Me.SetFocus

End Sub


Private Sub AddControlsToImporter(ByVal Importer As FilterFormCodeImporter, ByVal FilterFormName As String)
   
   Me.sfrFilterControls.Form.AddControlsToImporter Importer, FilterFormName

End Sub

Private Sub cmdAddFilterCodeToForm_Click()
   
   Select Case Me.FormCodeOptions.Value
      Case 1
         AddFilterCodeToForm New FilterControlManagerCodeBuilder
      Case 2
         AddFilterCodeToForm New FilterStringBuilderCodeBuilder
   End Select
   
End Sub

Private Sub Form_Current()
   CheckModules
End Sub

Private Sub OpenReplaceModulesContextMenu(ByRef ctlMenuControl As Control, ByVal X As Single, ByVal Y As Single)

   Dim mnu As WinApiShortcutMenu
   Dim lngSelectedMenuItem As Long

   Set mnu = New WinApiShortcutMenu
      
   With mnu
      .ControlSection = acDetail
      Set .AccessForm = Me
      Set .MenuControl = ctlMenuControl
      
      .AddMenuItem 1, "Alle Codemodule erneuern (vorhandene Module werden überschrieben)"
      .AddMenuItem 2, "Alle Codemodule außer 'SqlTools' erneuern (SqlTools bleibt unverändert)"
      
   End With
   
   lngSelectedMenuItem = mnu.OpenMenu(X, Y)
   Select Case lngSelectedMenuItem
      Case 1
         ReplaceAllModules True
      Case 2
         ReplaceAllModules False
      Case Else
         '
   End Select

   Set mnu = Nothing

End Sub

Private Sub ReplaceAllModules(Optional ByVal bolWithSqlTools As Boolean = False)
   
   Dim bolReplaced As Boolean

On Error Resume Next
   
   With CodeModulImporter
      If bolWithSqlTools Then
         bolReplaced = .ReplaceCodeModules("SqlTools", "StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
      Else
         bolReplaced = .ReplaceCodeModules("StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
      End If
   End With

   If bolReplaced Then
   
      SetModulCopyControls "CopyModulSqlTools", True
      SetModulCopyControls "CopyModulFilterStringBuilder", True
      SetModulCopyControls "CopyModulFilterControlManager", True
      SetModulCopyControls "CopyModules", True
   
      If m_OpenModules = 0 Then
         MsgBox "Codemodule wurden aktualisiert", , CurrentApplication.ApplicationName
      End If
      
      m_OpenModules = 0
      
   End If
   
End Sub

Private Sub Form_Open(Cancel As Integer)
   Me.Caption = Me.Caption & "  " & ChrW(&H25AA) & "  Version " & CurrentApplication.Version & " (SVN-Rev. " & SvnRev & ")"
End Sub

Private Sub labCheckVersion_Click()
   
   Select Case Me.labCheckVersion.Tag
      Case "unchecked"
         SetNewVersionInfo
      Case "NewVersionExists"
         OpenDownloadSource
      Case Else
         '
   End Select
   
End Sub

Private Sub labCheckVersion_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
   If Me.labCheckVersion.Tag <> "VersionUptodate" Then
      modWinApi_Mouse.MouseCursor IDC_HAND
   End If
End Sub

Private Sub labCopyCaption_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)

   If Button = 1 Or Button = 2 Then
      OpenReplaceModulesContextMenu Me.labCopyCaption, X, Y
   End If

End Sub

Private Sub CheckModules(Optional ByVal WithControlManager As Boolean = True)
   
   Dim bolCheckOK As Boolean
   
On Error Resume Next
   
   m_OpenModules = 0

   With CodeModulImporter
      bolCheckOK = .CheckCodeModules("SqlTools")
      m_OpenModules = m_OpenModules + 1 + bolCheckOK
      SetModulCopyControls "CopyModulSqlTools", bolCheckOK
      
      bolCheckOK = .CheckCodeModules("StringCollection", "FilterStringBuilder")
      m_OpenModules = m_OpenModules + 1 + bolCheckOK
      SetModulCopyControls "CopyModulFilterStringBuilder", bolCheckOK
      
      If WithControlManager Then
         bolCheckOK = .CheckCodeModules("FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
         m_OpenModules = m_OpenModules + 1 + bolCheckOK
         SetModulCopyControls "CopyModulFilterControlManager", bolCheckOK
      End If
      
      bolCheckOK = (m_OpenModules = 0)
      SetModulCopyControls "CopyModules", bolCheckOK
   End With
   
End Sub

Private Sub cmdCopyModulSqlTools_Click()

   CodeModulImporter.TransferCodeModules "SqlTools"
   m_OpenModules = m_OpenModules - 1
   SetModulCopyControls "CopyModulSqlTools", True

End Sub

Private Sub cmdCopyModulFilterControlManager_Click()

   With CodeModulImporter
      .TransferCodeModules "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager"
      m_OpenModules = m_OpenModules - 1
      If Not .CheckCodeModules("StringCollection", "FilterStringBuilder") Then
         cmdCopyModulFilterStringBuilder_Click
      End If
      SetModulCopyControls "CopyModulFilterControlManager", True
   End With

End Sub

Private Sub cmdCopyModulFilterStringBuilder_Click()

   With CodeModulImporter
      .TransferCodeModules "StringCollection", "FilterStringBuilder"
      m_OpenModules = m_OpenModules - 1
      If Not .CheckCodeModules("SqlTools") Then
         cmdCopyModulSqlTools_Click
      End If
      SetModulCopyControls "CopyModulFilterStringBuilder", True
   End With

End Sub

Private Sub cmdCopyModules_Click()

   CodeModulImporter.TransferCodeModules "SqlTools", "StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager"
   SetModulCopyControls "CopyModulSqlTools", True
   SetModulCopyControls "CopyModulFilterStringBuilder", True
   SetModulCopyControls "CopyModulFilterControlManager", True
   SetModulCopyControls "CopyModules", True
   m_OpenModules = 0

End Sub

Private Sub SetModulCopyControls(ByVal sModulCode As String, ByVal bExists As Boolean)
   
   Dim sCaption As String
   Dim lBorderStyle As Long
   
On Error Resume Next
   
   If bExists Then Me.sysFirst.SetFocus
   Me.Controls("cmd" & sModulCode).Enabled = Not bExists
   If bExists Then
      sCaption = "b"
      lBorderStyle = 0
   Else
      sCaption = vbNullString
      lBorderStyle = 1
   End If
   With Me.Controls("lab" & sModulCode)
      .Caption = sCaption
      .BorderStyle = lBorderStyle
   End With
 
   If sModulCode <> "CopyModules" And m_OpenModules = 0 Then
      SetModulCopyControls "CopyModules", True
   End If
   
End Sub

Private Sub labCopyCaption_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
   modWinApi_Mouse.MouseCursor IDC_HAND
End Sub

Private Sub UseFilterMethodOptions_AfterUpdate()

   With Me.cbxUseFilterSubForm
      .Enabled = (Me.UseFilterMethodOptions = m_SubFormUseFilterOption)
      If .Enabled = False Then .Value = Null
   End With

   RefreshAddFilterButtonEnableMode

End Sub

Private Sub LoadControlsFromForm(ByVal FormRef As Form)

   Dim ctl As Control

   ClearFilterCtlCombobox Me.cbxUseFilterCtl
   ClearFilterCtlCombobox Me.cbxRemoveFilterCtl
   ClearFilterCtlCombobox Me.cbxAutoFilterCtl

   If FormRef Is Nothing Then
      Exit Sub
   End If

   For Each ctl In FormRef.Controls
      Select Case ctl.ControlType
         Case AcControlType.acCommandButton
         
            Me.cbxUseFilterCtl.AddItem ctl.Name
            Me.cbxRemoveFilterCtl.AddItem ctl.Name
         
         Case AcControlType.acCheckBox, AcControlType.acToggleButton
              
            Me.cbxAutoFilterCtl.AddItem ctl.Name
            

      End Select
   Next
   
   Me.sfrFilterControls.Form.InitFilterForm FormRef

End Sub

Private Sub ClearFilterCtlCombobox(ByVal cbx As ComboBox)
   cbx.RowSource = vbNullString
   cbx.Value = Null
End Sub

Private Sub SetNewVersionInfo()
   
   Dim AhProcParams(1) As Variant
   Dim AhResumeMode As ApplicationHandlerResumeModes
   Dim AhResumeMessage As Variant
   
   Call CurrentApplication.CallExtensionProcedure("AppVersion", "NewVersionExists", AhResumeMode, AhResumeMessage, AhProcParams)
   
   If AhResumeMode <> AppResumeMode_Completed Then
      If AhResumeMode = AppResumeMode_Error Then
      If Len(AhResumeMessage) > 0 Then
         MsgBox AhResumeMessage, vbExclamation, "Fehler bei Versionsprüfung"
      End If
      End If
      Exit Sub
   End If
   
   With Me.labCheckVersion
   If AhResumeMessage = False Then
      .Caption = "Version ist aktuell"
      .Tag = "VersionUptodate"
      .ForeColor = 0
      .FontUnderline = False
   ElseIf AhResumeMessage = True Then
      .Caption = "Neue Version (" & AhProcParams(0) & ") verfügbar"
      .ControlTipText = AhProcParams(1)
      .Tag = "NewVersionExists"
   Else
      
   End If
   End With
   
End Sub

Private Sub OpenDownloadSource()
   Application.FollowHyperlink DownLoadSource, , True, False
End Sub