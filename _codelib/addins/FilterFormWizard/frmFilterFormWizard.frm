Version =20
VersionRequired =20
Checksum =-831596018
Begin Form
    AllowFilters = NotDefault
    RecordSelectors = NotDefault
    ShortcutMenu = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    AllowAdditions = NotDefault
    KeyPreview = NotDefault
    DefaultView =0
    ScrollBars =0
    TabularFamily =119
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    Cycle =1
    GridY =10
    Width =11908
    DatasheetFontHeight =10
    ItemSuffix =90
    Left =405
    Top =1200
    Right =15165
    Bottom =11340
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x668d2cd46a58e440
    End
    GUID = Begin
        0x8f309169ffbfbd4ebbb375424a700b57
    End
    Caption ="ACLib FilterForm Wizard"
    OnCurrent ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xae050000ae050000ae050000ae05000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000a519ca2f0400000001000000748335000e000000e8853500 ,
        0x010400069c00440353ef8003010009009a0b3408640001000f00580202000100 ,
        0x58020300010041340085350008000000c83cf305d4853500c43cf305cc833500 ,
        0x23870a30e03c0000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000007000440300000000000000000000000000000000 ,
        0x0000000000000000030000000000000000001000503403002888040000000000 ,
        0x0000000000000100000000000000000000000000000000002401df8c03000000 ,
        0x05000b00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000070000000534d544a0000000010006000 ,
        0x46007200650065005000440046005f005800500000005265736f6c7574696f6e ,
        0x00363030647069005061676553697a650041340050616765526567696f6e0000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080013001b000100000000000000000000000000000000000000004672656550 ,
        0x44465850313a0000000000
    End
    FilterOnLoad =0
    ShowPageMargins =0
    AllowLayoutView =0
    DatasheetGridlinesColor12 =12632256
    PrtDevModeW = Begin
        0x00000000007b35005001f5055fac75d30016f5057a7170777f0000007865fd2f ,
        0x09000000d8a03500b66afd2ff5c4d82f3cd130a4000000003d03003ec400f505 ,
        0x01040006dc00440353ef8003010009009a0b3408640001000f00580202000100 ,
        0x5802030001004100340000000c0000000016f5050016f505fb15f50500000000 ,
        0xf07b35000000f5057a7dfb01347b350002000000b07f3500f571c6773e5a7d07 ,
        0xfeffffffd33c0000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000007000440300000000000000000000000000000000 ,
        0x0000000000000000030000000000000000001000503403002888040000000000 ,
        0x0000000000000100000000000000000000000000000000002401df8c03000000 ,
        0x05000b00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000070000000534d544a0000000010006000 ,
        0x46007200650065005000440046005f005800500000005265736f6c7574696f6e ,
        0x00363030647069005061676553697a650041340050616765526567696f6e0000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNamesW = Begin
        0x04000f0017000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000460072006500650050004400460058005000 ,
        0x31003a0000000000000000000000
    End
    
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            Width =850
            Height =850
        End
        Begin Line
            BorderLineStyle =0
            Width =1701
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin CheckBox
            SpecialEffect =2
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            Width =1701
            Height =1701
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin ComboBox
            SpecialEffect =2
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
        End
        Begin ToggleButton
            Width =283
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin Section
            Height =2607
            BackColor =-2147483633
            Name ="Detailbereich"
            GUID = Begin
                0xfeffd8470a0a9b46abd37d015aab40c1
            End
            Begin
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =4812
                    Top =1328
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulFilterStringBuilder"
                    FontName ="Marlett"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xdd6a6769d341054eb9b6a296fae08f29
                    End
                    LayoutCachedLeft =4812
                    LayoutCachedTop =1328
                    LayoutCachedWidth =5107
                    LayoutCachedHeight =1623
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =4812
                    Top =968
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulFilterControlManager"
                    FontName ="Marlett"
                    GUID = Begin
                        0x305cae0a69ac99408cdac46d5e2689ce
                    End
                    LayoutCachedLeft =4812
                    LayoutCachedTop =968
                    LayoutCachedWidth =5107
                    LayoutCachedHeight =1263
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =4812
                    Top =1688
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModulSqlTools"
                    FontName ="Marlett"
                    GUID = Begin
                        0x1d0212a8607e14459c58854d3069900b
                    End
                    LayoutCachedLeft =4812
                    LayoutCachedTop =1688
                    LayoutCachedWidth =5107
                    LayoutCachedHeight =1983
                End
                Begin Label
                    OldBorderStyle =1
                    BorderWidth =1
                    OverlapFlags =93
                    TextFontCharSet =2
                    TextAlign =1
                    TextFontFamily =2
                    Left =4812
                    Top =623
                    Width =295
                    Height =295
                    FontSize =16
                    ForeColor =5026082
                    Name ="labCopyModules"
                    FontName ="Marlett"
                    GUID = Begin
                        0xbe7161d84c13b5499ad792e6366b9eac
                    End
                    LayoutCachedLeft =4812
                    LayoutCachedTop =623
                    LayoutCachedWidth =5107
                    LayoutCachedHeight =918
                End
                Begin Line
                    OverlapFlags =85
                    SpecialEffect =2
                    Left =5272
                    Top =170
                    Width =0
                    Height =2268
                    Name ="Linie49"
                    GUID = Begin
                        0x6c2c3106ded8534c87892e2ee126530c
                    End
                    LayoutCachedLeft =5272
                    LayoutCachedTop =170
                    LayoutCachedWidth =5272
                    LayoutCachedHeight =2438
                End
                Begin TextBox
                    AllowAutoCorrect = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    BackStyle =0
                    IMESentenceMode =3
                    Width =0
                    Height =0
                    Name ="sysFirst"
                    GUID = Begin
                        0x4d21045caadf464383f75e79a673ebd4
                    End

                End
                Begin CommandButton
                    Enabled = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =7651
                    Top =1190
                    Width =3402
                    Height =375
                    FontSize =10
                    TabIndex =4
                    Name ="cmdAddFilterControManagerToForm"
                    Caption ="FilterControlManager einfügen"
                    OnClick ="[Event Procedure]"
                    FontName ="Verdana"
                    GUID = Begin
                        0x5bd9780ad5280e4ca3a72fc65582233c
                    End

                    LayoutCachedLeft =7651
                    LayoutCachedTop =1190
                    LayoutCachedWidth =11053
                    LayoutCachedHeight =1565
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin Label
                    OverlapFlags =85
                    Left =462
                    Top =998
                    Width =4286
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulFilterControlManager"
                    Caption ="FilterControlManager"
                    GUID = Begin
                        0x8b2a1e9b456dac47a589d89260e7cd9d
                    End
                    LayoutCachedLeft =462
                    LayoutCachedTop =998
                    LayoutCachedWidth =4748
                    LayoutCachedHeight =1253
                End
                Begin Label
                    OverlapFlags =85
                    Left =462
                    Top =1358
                    Width =4286
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulFilterStringBuilder"
                    Caption ="FilterStringBuilder"
                    GUID = Begin
                        0x502db6c278e7644e80b7bb465da8086e
                    End
                    LayoutCachedLeft =462
                    LayoutCachedTop =1358
                    LayoutCachedWidth =4748
                    LayoutCachedHeight =1613
                End
                Begin Label
                    OverlapFlags =85
                    Left =462
                    Top =1718
                    Width =4286
                    Height =255
                    FontSize =9
                    Name ="labCaptionCopyModulSqlTools"
                    Caption ="SqlTools"
                    GUID = Begin
                        0xdd04a61804b3d3489636dea0aac6d966
                    End
                    LayoutCachedLeft =462
                    LayoutCachedTop =1718
                    LayoutCachedWidth =4748
                    LayoutCachedHeight =1973
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =4812
                    Top =1328
                    Width =295
                    Height =295
                    TabIndex =5
                    Name ="cmdCopyModulFilterStringBuilder"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc8975d8c2da3304ebb127dc3080d923e
                    End

                    LayoutCachedLeft =4812
                    LayoutCachedTop =1328
                    LayoutCachedWidth =5107
                    LayoutCachedHeight =1623
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =4812
                    Top =968
                    Width =295
                    Height =295
                    TabIndex =3
                    Name ="cmdCopyModulFilterControlManager"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc0cb35c7d786bf44aefdc3b2945a0498
                    End

                    LayoutCachedLeft =4812
                    LayoutCachedTop =968
                    LayoutCachedWidth =5107
                    LayoutCachedHeight =1263
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =4812
                    Top =1688
                    Width =295
                    Height =295
                    TabIndex =6
                    Name ="cmdCopyModulSqlTools"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xb1a983cde9722b43a3e535cf8b426c67
                    End

                    LayoutCachedLeft =4812
                    LayoutCachedTop =1688
                    LayoutCachedWidth =5107
                    LayoutCachedHeight =1983
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin Label
                    OverlapFlags =85
                    Left =226
                    Top =643
                    Width =1815
                    Height =255
                    FontSize =9
                    FontWeight =700
                    Name ="labCopyCaption"
                    Caption ="Module u. Klassen"
                    OnMouseDown ="[Event Procedure]"
                    ControlTipText ="nur in der Vollversion verfügbar"
                    GUID = Begin
                        0x6fdf1d4132b76c429cd92273cd9ef89b
                    End
                    LayoutCachedLeft =226
                    LayoutCachedTop =643
                    LayoutCachedWidth =2041
                    LayoutCachedHeight =898
                End
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =215
                    Left =4812
                    Top =623
                    Width =295
                    Height =295
                    TabIndex =1
                    Name ="cmdCopyModules"
                    Caption ="Befehl69"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x71b2bb2e794e5a4183b92a358e952ad8
                    End

                    LayoutCachedLeft =4812
                    LayoutCachedTop =623
                    LayoutCachedWidth =5107
                    LayoutCachedHeight =918
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin ComboBox
                    OverlapFlags =87
                    IMESentenceMode =3
                    Left =7651
                    Top =623
                    Width =3402
                    Height =285
                    FontSize =10
                    TabIndex =2
                    GUID = Begin
                        0x9ae17955cc84ce48bbcca6b1a3566263
                    End
                    Name ="cbxFormName"
                    RowSourceType ="Table/Query"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="Verdana"
                    OnGotFocus ="[Event Procedure]"

                    LayoutCachedLeft =7651
                    LayoutCachedTop =623
                    LayoutCachedWidth =11053
                    LayoutCachedHeight =908
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =5725
                            Top =623
                            Width =1920
                            Height =285
                            FontSize =10
                            Name ="Bezeichnungsfeld89"
                            Caption ="Formular wählen:"
                            FontName ="Verdana"
                            GUID = Begin
                                0x686faf8a460dc643aef4f21fb057114d
                            End
                            LayoutCachedLeft =5725
                            LayoutCachedTop =623
                            LayoutCachedWidth =7645
                            LayoutCachedHeight =908
                        End
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------------------------------------------------------------
' Form: frmFilterFormWizard
'---------------------------------------------------------------------------------------
'/**
' \author       Josef Poetzl
' <summary>
' Wizard-From für FilterControlManager-Import
' </summary>
' <remarks></remarks>
'**/
'---------------------------------------------------------------------------------------
'<codelib>
'  <file>_codelib/addins/FilterFormWizard/frmFilterFormWizard.frm</file>
'  <license>_codelib/license.bas</license>
'  <use>_codelib/addins/FilterFormWizard/FilterControlManagerImporter.cls</use>
'  <use>_codelib/addins/shared/AppFileCodeModulTransfer.cls</use>
'</codelib>
'---------------------------------------------------------------------------------------
'
Option Compare Database
Option Explicit

Private m_OpenModules As Long
Private m_CodeModulImporter As AppFileCodeModulTransfer

'Datenquellen für Formular (je nachdem ob Formular für FE-Verbindung bzw. Vorlage verwendet wird):
Private Property Get SourceDb() As DAO.Database
   Set SourceDb = CurrentDb
End Property

Private Property Get CodeModulImporter() As AppFileCodeModulTransfer
   If m_CodeModulImporter Is Nothing Then
      Set m_CodeModulImporter = New AppFileCodeModulTransfer
   End If
   Set CodeModulImporter = m_CodeModulImporter
End Property

Private Sub cbxFormName_AfterUpdate()
   Me.cmdAddFilterControManagerToForm.Enabled = (Len(Nz(Me.cbxFormName.Value, vbNullString)) > 0)
End Sub

Private Sub cbxFormName_GotFocus()
   LoadForms
End Sub

Private Sub LoadForms()
   Me.cbxFormName.RowSource = "Select Name FROM [" & SourceDb.Name & "].MSysObjects where Type = -32768 Order By Name"
End Sub

Private Sub cmdAddFilterControManagerToForm_Click()
   AddFilterControManagerToForm
End Sub

Private Sub AddFilterControManagerToForm()

   Dim FormName As String

   FormName = Nz(Me.cbxFormName.Value, vbNullString)
   If Len(FormName) = 0 Then
      MsgBox "Bitte zuerst Formular auswählen"
      Exit Sub
   End If
   With New FilterControlManagerImporter
      .AddToForm Me.cbxFormName
   End With

   CheckModules

   Me.SetFocus

End Sub

Private Sub Form_Current()
   CheckModules
End Sub

Private Sub OpenReplaceModulesContextMenu(ByRef ctlMenuControl As Control, ByVal x As Single, ByVal y As Single)

   Dim mnu As WinApiShortcutMenu
   Dim lngSelectedMenuItem As Long

   Set mnu = New WinApiShortcutMenu
      
   With mnu
      .ControlSection = acDetail
      Set .AccessForm = Me
      Set .MenuControl = ctlMenuControl
      
      .AddMenuItem 1, "Alle Codemodule erneuern (vorhandene Module werden überschrieben)"
      .AddMenuItem 2, "Alle Codemodule außer 'SqlTools' erneuern (SqlTools bleibt unverändert)"
      
   End With
   
   lngSelectedMenuItem = mnu.OpenMenu(x, y)
   Select Case lngSelectedMenuItem
      Case 1
         ReplaceAllModules True
      Case 2
         ReplaceAllModules False
      Case Else
         '
   End Select

   Set mnu = Nothing

End Sub

Private Sub ReplaceAllModules(Optional ByVal bolWithSqlTools As Boolean = False)
   
   Dim bolReplaced As Boolean

On Error Resume Next
   
   With CodeModulImporter
      If bolWithSqlTools Then
         bolReplaced = .ReplaceCodeModules("SqlTools", "StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
      Else
         bolReplaced = .ReplaceCodeModules("StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
      End If
   End With

   If bolReplaced Then
   
      SetModulCopyControls "CopyModulSqlTools", True
      SetModulCopyControls "CopyModulFilterStringBuilder", True
      SetModulCopyControls "CopyModulFilterControlManager", True
      SetModulCopyControls "CopyModules", True
   
      If m_OpenModules = 0 Then
         MsgBox "Codemodule wurden aktualisiert"
      End If
      
      m_OpenModules = 0
      
   End If
   
End Sub

Private Sub Form_Open(Cancel As Integer)
   Me.Caption = Me.Caption & "  " & ChrW(&H25AA) & "  Version " & CurrentApplication.Version
End Sub

Private Sub labCopyCaption_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)

   If Button = 1 Or Button = 2 Then
      OpenReplaceModulesContextMenu Me.labCopyCaption, x, y
   End If

End Sub

Private Sub CheckModules()
   
   Dim bolCheckOK As Boolean
   
On Error Resume Next
   
   m_OpenModules = 0

   With CodeModulImporter
      bolCheckOK = .CheckCodeModules("SqlTools")
      m_OpenModules = m_OpenModules + 1 + bolCheckOK
      SetModulCopyControls "CopyModulSqlTools", bolCheckOK
      
      bolCheckOK = .CheckCodeModules("StringCollection", "FilterStringBuilder")
      m_OpenModules = m_OpenModules + 1 + bolCheckOK
      SetModulCopyControls "CopyModulFilterStringBuilder", bolCheckOK
      
      bolCheckOK = .CheckCodeModules("FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager")
      m_OpenModules = m_OpenModules + 1 + bolCheckOK
      SetModulCopyControls "CopyModulFilterControlManager", bolCheckOK
      
      bolCheckOK = (m_OpenModules = 0)
      SetModulCopyControls "CopyModules", bolCheckOK
   End With
   
End Sub

Private Sub cmdCopyModulSqlTools_Click()

   CodeModulImporter.TransferCodeModules "SqlTools"
   m_OpenModules = m_OpenModules - 1
   SetModulCopyControls "CopyModulSqlTools", True

End Sub

Private Sub cmdCopyModulFilterControlManager_Click()

   With CodeModulImporter
      .TransferCodeModules "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager"
      m_OpenModules = m_OpenModules - 1
      If Not .CheckCodeModules("StringCollection", "FilterStringBuilder") Then
         cmdCopyModulFilterStringBuilder_Click
      End If
      SetModulCopyControls "CopyModulFilterControlManager", True
   End With

End Sub

Private Sub cmdCopyModulFilterStringBuilder_Click()

   With CodeModulImporter
      .TransferCodeModules "StringCollection", "FilterStringBuilder"
      m_OpenModules = m_OpenModules - 1
      If Not .CheckCodeModules("SqlTools") Then
         cmdCopyModulSqlTools_Click
      End If
      SetModulCopyControls "CopyModulFilterStringBuilder", True
   End With

End Sub

Private Sub cmdCopyModules_Click()

   CodeModulImporter.TransferCodeModules "SqlTools", "StringCollection", "FilterStringBuilder", "FilterControlEventBridge", "FilterControl", "FilterControlCollection", "FilterControlManager"
   SetModulCopyControls "CopyModulSqlTools", True
   SetModulCopyControls "CopyModulFilterStringBuilder", True
   SetModulCopyControls "CopyModulFilterControlManager", True
   SetModulCopyControls "CopyModules", True
   m_OpenModules = 0

End Sub

Private Sub SetModulCopyControls(ByVal sModulCode As String, ByVal bExists As Boolean)
   
   Dim sCaption As String
   Dim lBorderStyle As Long
   
On Error Resume Next
   
   If bExists Then Me.sysFirst.SetFocus
   Me.Controls("cmd" & sModulCode).Enabled = Not bExists
   If bExists Then
      sCaption = "b"
      lBorderStyle = 0
   Else
      sCaption = vbNullString
      lBorderStyle = 1
   End If
   With Me.Controls("lab" & sModulCode)
      .Caption = sCaption
      .BorderStyle = lBorderStyle
   End With
 
   If sModulCode <> "CopyModules" And m_OpenModules = 0 Then
      SetModulCopyControls "CopyModules", True
   End If
   
End Sub