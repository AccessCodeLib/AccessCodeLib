Version =19
VersionRequired =19
Checksum =122265352
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    ScrollBars =0
    TabularCharSet =238
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =6519
    DatasheetFontHeight =11
    ItemSuffix =15
    Left =3405
    Top =2160
    Right =9930
    Bottom =4890
    RecSrcDt = Begin
        0x64c41833a29ce340
    End
    GUID = Begin
        0xd6258268a2c1af4299d34b2f5de83f35
    End
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x00000000ba28d92f0400000001000000f0501300180000006453130018511300 ,
        0x010400069c00440343ef8005010009009a0b3408640001000f00c80002000100 ,
        0xc80002000100413400000000c8fc8a0950531300c4fc8a0948511300e993db2f ,
        0xe0fc8a09f0930000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000007000440300000000000000000000000000000000 ,
        0x0000000000000000030000000000000000001000503403002888040000000000 ,
        0x0000000000000100000000000000000000000000000000002401df8c03000000 ,
        0x05000400ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000000000000000000000000000070000000534d544a0000000010006000 ,
        0x46007200650065005000440046005f005800500000005265736f6c7574696f6e ,
        0x00363030647069005061676553697a65004c6574746572005061676552656769 ,
        0x6f6e000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080013001b000100000000000000000000000000000000000000004672656550 ,
        0x44465850313a00
    End
    OnLoad ="[Event Procedure]"
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Calibri"
        End
        Begin TextBox
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
        End
        Begin Section
            Height =2747
            Name ="Detail"
            GUID = Begin
                0xedc8cc418f48694986edc4646052bd7c
            End
            Begin
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =228
                    Top =505
                    Width =6066
                    Height =315
                    Name ="FileSearchTextbox1"
                    DefaultValue ="\"C:\\\""
                    OnGotFocus ="[Event Procedure]"
                    GUID = Begin
                        0x46ad28438907cb429517fc3dccfb2d65
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =228
                    Top =940
                    Width =6066
                    Height =315
                    TabIndex =1
                    Name ="FileSearchTextbox2"
                    DefaultValue ="\"C:\\\""
                    OnGotFocus ="[Event Procedure]"
                    GUID = Begin
                        0x4c4304ff8d704f468eebe3974111d3f3
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =2381
                    Top =1832
                    Width =3921
                    Height =315
                    TabIndex =2
                    Name ="FileSearchTextbox3"
                    OnGotFocus ="[Event Procedure]"
                    GUID = Begin
                        0xb9050bf94e91014ea3ade9d9a836c1d5
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =230
                            Top =1832
                            Width =2145
                            Height =315
                            Name ="Label11"
                            Caption ="Ausgangsverzeichnis:"
                            GUID = Begin
                                0x98a11d9470701743a62966ba1c1d950e
                            End
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =2381
                    Top =2267
                    Width =3921
                    Height =315
                    TabIndex =3
                    Name ="FileSearchTextbox4"
                    OnGotFocus ="[Event Procedure]"
                    GUID = Begin
                        0x41b95047536c0a448f5e96aa8924e23f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =230
                            Top =2267
                            Width =2145
                            Height =315
                            Name ="Label12"
                            Caption ="Suche:"
                            GUID = Begin
                                0x24b16e8529cd8e448baf33f2036b0ec4
                            End
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextFontCharSet =238
                    Left =225
                    Top =1485
                    Width =3225
                    Height =315
                    FontWeight =700
                    Name ="Label13"
                    Caption ="Suche ab Ausgangsverzeichnis"
                    GUID = Begin
                        0xa70b70fe95e2d74cb6cd188c45908dd8
                    End
                End
                Begin Label
                    OverlapFlags =85
                    TextFontCharSet =238
                    Left =225
                    Top =165
                    Width =3390
                    Height =315
                    FontWeight =700
                    Name ="Label14"
                    Caption ="Suche mit vollständiger Pfadangabe"
                    GUID = Begin
                        0x785d4bb240a39f45afbdb91c35ac2128
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------------------------------------------------------------
' VBA Document: Form_TEST_DirTextbox (Josef Pötzl, 2009-12-18)
'---------------------------------------------------------------------------------------
'/**
' <summary>
' Test-Formular für DirTextbox
' </summary>
' <remarks>
' </remarks>
'**/
'---------------------------------------------------------------------------------------
'<codelib>
'  <file>_test/usability/TEST_DirTextbox.frm</file>
'  <license>_codelib/license.bas</license>
'  <use>usability/ApplicationHandler_DirTextbox.cls</use>
'</codelib>
'---------------------------------------------------------------------------------------
'
' Initialisierung der DirTextbox-Erweiterung in _config_Application nicht vergessen!
'  ... AddApplicationHandlerExtension New ApplicationHandler_DirTextbox
'
Option Compare Database
Option Explicit

Private Sub bindTextbox(ByRef tb As Textbox, Optional ByVal BaseFolderPath As String = vbNullString)

   'Latebindung, damit ApplicationHandler_DirTextbox-Klasse nicht vorhanden sein muss
   Dim ojbDirTextbox As Object ' = ApplicationHandler_DirTextbox

   'Standard-Instanz verwenden:
   Set ojbDirTextbox = CurrentApplication.Extensions("DirTextbox")

   'extra Instanz für Textbox-Steuerung initialisieren ... ist nützlich,
   'wenn die Initialisierung bei Form.Load und nicht bei Texbox.GotFocus durchgeführt werden soll
   'Set ojbDirTextbox = CurrentApplication.GetExtensionInstance("DirTextbox")
   
   'Textbox binden
   If Not (ojbDirTextbox Is Nothing) Then
      Set ojbDirTextbox.Textbox = tb
      ojbDirTextbox.BaseFolderPath = BaseFolderPath
   End If

End Sub


Private Sub FileSearchTextbox1_GotFocus()
   bindTextbox Me.FileSearchTextbox1
End Sub

Private Sub FileSearchTextbox2_GotFocus()
   bindTextbox Me.FileSearchTextbox2
End Sub

Private Sub FileSearchTextbox3_GotFocus()
   bindTextbox Me.FileSearchTextbox3
End Sub

Private Sub FileSearchTextbox4_GotFocus()
   bindTextbox Me.FileSearchTextbox4, Nz(Me.FileSearchTextbox3, vbNullString)
End Sub

Private Sub Form_Load()
   Me.FileSearchTextbox3.Value = Environ("ProgramFiles")
   Me.FileSearchTextbox4.Value = "..\"
End Sub