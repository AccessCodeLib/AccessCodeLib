Version =20
VersionRequired =20
Checksum =-383326870
Begin Form
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    AllowDesignChanges = NotDefault
    TabularCharSet =238
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =9578
    DatasheetFontHeight =11
    ItemSuffix =11
    Right =17235
    Bottom =7965
    RecSrcDt = Begin
        0xcaa307d65247e440
    End
    GUID = Begin
        0x200502ec4eea0944a441eebe10c190ef
    End
    NameMap = Begin
        0x0acc0e55000000004fcb7a31b6b05d488fefb34ccfe76eea00000000c3d76180 ,
        0x9947e44000000000f803000075007300790073005f0041007000700046006900 ,
        0x6c0065007300000000000000c99f94188e23964db3634c605528700807000000 ,
        0x4fcb7a31b6b05d488fefb34ccfe76eea460069006c0065004e0061006d006500 ,
        0x000000000000d8a20b517088db4aaa99a93f830c2b65070000004fcb7a31b6b0 ,
        0x5d488fefb34ccfe76eea4500610072006c007900420069006e00640069006e00 ,
        0x67005200650066004e0061006d0065000000000000001455a1629285cb4ba735 ,
        0x5dbd1b21ebe8070000004fcb7a31b6b05d488fefb34ccfe76eea560065007200 ,
        0x730069006f006e00000000000000000000000000000000000000000000000c00 ,
        0x0000040000000000000000000000000000000000
    End
    RecordSource ="usys_AppFiles"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x3a0000003a0000003a0000003a00000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00580303ff0000010009009a0b3408640001000f00580202000100 ,
        0x5802020000004134000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x220010014c030c00cad2f6720000000000000000000000000000000000000000 ,
        0x0000000000000000090000000000000000000100000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000001000000000000000000000010010000534d544a ,
        0x00000000100000014d006900630072006f0073006f0066007400200058005000 ,
        0x5300200044006f00630075006d0065006e007400200057007200690074006500 ,
        0x72000000496e70757442696e00464f524d534f5552434500524553444c4c0055 ,
        0x6e69726573444c4c00496e7465726c656176696e67004f464600496d61676554 ,
        0x797065004a5045474d6564004f7269656e746174696f6e00504f525452414954 ,
        0x00436f6c6c617465004f4646005265736f6c7574696f6e004f7074696f6e3100 ,
        0x506170657253697a65004c455454455200436f6c6f724d6f6465003234627070 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000c0000004d58445701010000
    End
    PrtDevNames = Begin
        0x0800260044000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000585053506f72743a00
    End
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            SizeMode =3
            PictureAlignment =2
            Width =1701
            Height =1701
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SizeMode =3
            SpecialEffect =2
            Width =4536
            Height =2835
            LabelX =-1701
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            Width =1701
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin FormHeader
            Height =1447
            Name ="Formularkopf"
            GUID = Begin
                0x9cbbafb6a354644e81115838840b6fd3
            End
            Begin
                Begin Label
                    OverlapFlags =93
                    TextFontCharSet =161
                    TextAlign =1
                    Top =60
                    Width =3764
                    Height =569
                    FontSize =18
                    LeftMargin =22
                    TopMargin =22
                    RightMargin =22
                    BottomMargin =22
                    Name ="Auto_Title0"
                    Caption ="DotNetLibFileManager"
                    FontName ="Arial"
                    GUID = Begin
                        0xd48dca49154eca41a8c850b1d14bbfdd
                    End
                    GridlineColor =-2147483616
                    LayoutCachedTop =60
                    LayoutCachedWidth =3764
                    LayoutCachedHeight =629
                End
                Begin Label
                    OverlapFlags =85
                    TextFontCharSet =161
                    TextAlign =2
                    Top =1155
                    Width =4720
                    Height =284
                    FontSize =10
                    FontWeight =700
                    Name ="Bezeichnungsfeld1"
                    Caption ="FileName"
                    FontName ="Arial"
                    GUID = Begin
                        0x79f42ffe926e0d45bf7d638b78f076f2
                    End
                    ColumnGroup =1
                    GroupTable =1
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleLeft =1
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineWidthLeft =0
                    GridlineWidthTop =0
                    GridlineWidthRight =0
                    GridlineWidthBottom =0
                    LayoutCachedTop =1155
                    LayoutCachedWidth =4720
                    LayoutCachedHeight =1439
                End
                Begin Label
                    OverlapFlags =85
                    TextFontCharSet =161
                    TextAlign =2
                    Left =7230
                    Top =1155
                    Width =2340
                    Height =284
                    FontSize =10
                    FontWeight =700
                    Name ="Bezeichnungsfeld3"
                    Caption ="EarlyBindingName"
                    FontName ="Arial"
                    GUID = Begin
                        0x2318fcd43e75f6438ec2b6cc97654ee5
                    End
                    ColumnGroup =2
                    GroupTable =1
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleLeft =1
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineWidthLeft =0
                    GridlineWidthTop =0
                    GridlineWidthRight =0
                    GridlineWidthBottom =0
                    LayoutCachedLeft =7230
                    LayoutCachedTop =1155
                    LayoutCachedWidth =9570
                    LayoutCachedHeight =1439
                End
                Begin Label
                    OverlapFlags =85
                    TextFontCharSet =161
                    TextAlign =2
                    Left =4735
                    Top =1155
                    Width =2480
                    Height =284
                    FontSize =10
                    FontWeight =700
                    Name ="Bezeichnungsfeld7"
                    Caption ="Version"
                    FontName ="Arial"
                    GUID = Begin
                        0x74e5803695e8df459a14e600df1b4f1f
                    End
                    ColumnGroup =3
                    GroupTable =1
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleLeft =1
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineWidthLeft =0
                    GridlineWidthTop =0
                    GridlineWidthRight =0
                    GridlineWidthBottom =0
                    LayoutCachedLeft =4735
                    LayoutCachedTop =1155
                    LayoutCachedWidth =7215
                    LayoutCachedHeight =1439
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =45
                    Top =630
                    Height =343
                    Name ="btnAddFile"
                    Caption ="AddFile"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x0a561a0ec7624b4cbfe643c3d66f618b
                    End

                    LayoutCachedLeft =45
                    LayoutCachedTop =630
                    LayoutCachedWidth =1746
                    LayoutCachedHeight =973
                End
            End
        End
        Begin Section
            Height =293
            Name ="Detailbereich"
            GUID = Begin
                0x81a1fe6e49063241a64531a0a5e3e490
            End
            Begin
                Begin TextBox
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextFontCharSet =161
                    BackStyle =0
                    IMESentenceMode =3
                    Top =7
                    Width =4720
                    Height =277
                    FontSize =10
                    BorderColor =0
                    Name ="FileName"
                    ControlSource ="FileName"
                    FontName ="Arial"
                    GUID = Begin
                        0xe520bd3ff341c0488ed3fb802bee877b
                    End
                    ColumnGroup =1
                    GroupTable =1
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleLeft =1
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineWidthLeft =0
                    GridlineWidthTop =0
                    GridlineWidthRight =0
                    GridlineWidthBottom =0

                    LayoutCachedTop =7
                    LayoutCachedWidth =4720
                    LayoutCachedHeight =284
                End
                Begin TextBox
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextFontCharSet =161
                    BackStyle =0
                    IMESentenceMode =3
                    Left =7230
                    Top =7
                    Width =2340
                    Height =277
                    FontSize =10
                    TabIndex =2
                    BorderColor =0
                    Name ="EarlyBindingRefName"
                    ControlSource ="EarlyBindingRefName"
                    FontName ="Arial"
                    GUID = Begin
                        0x2150aeca45b47c4795dd1e652402ace7
                    End
                    ColumnGroup =2
                    GroupTable =1
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleLeft =1
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineWidthLeft =0
                    GridlineWidthTop =0
                    GridlineWidthRight =0
                    GridlineWidthBottom =0

                    LayoutCachedLeft =7230
                    LayoutCachedTop =7
                    LayoutCachedWidth =9570
                    LayoutCachedHeight =284
                End
                Begin TextBox
                    OldBorderStyle =0
                    OverlapFlags =85
                    TextFontCharSet =161
                    TextAlign =3
                    BackStyle =0
                    IMESentenceMode =3
                    Left =4735
                    Top =7
                    Width =2480
                    Height =277
                    FontSize =10
                    TabIndex =1
                    BorderColor =0
                    Name ="Version"
                    ControlSource ="Version"
                    FontName ="Arial"
                    GUID = Begin
                        0x57770ecf4adda545af26d25fe8f40fd7
                    End
                    ColumnGroup =3
                    GroupTable =1
                    LeftPadding =0
                    TopPadding =0
                    RightPadding =0
                    BottomPadding =0
                    GridlineStyleLeft =1
                    GridlineStyleTop =1
                    GridlineStyleRight =1
                    GridlineStyleBottom =1
                    GridlineWidthLeft =0
                    GridlineWidthTop =0
                    GridlineWidthRight =0
                    GridlineWidthBottom =0

                    LayoutCachedLeft =4735
                    LayoutCachedTop =7
                    LayoutCachedWidth =7215
                    LayoutCachedHeight =284
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="Formularfuß"
            GUID = Begin
                0x4d1394e4c04e664cbbc7ac74fc471509
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------------------------------------------------------------
' Form: DotNetLibFileManager
'---------------------------------------------------------------------------------------
'/**
' \author       Sten Schmidt
' <summary>
' Formular zur Verwaltung der ACLib .NET Integrationsdateien.
' </summary>
' <remarks>Es können auch sonstige Dateiformate hinzugefügt und verwaltet werden, die im Bibliotheksverzeichnis der Anwendung bereitgestellt werden.</remarks>
'\ingroup DotNetLib
'**/
'---------------------------------------------------------------------------------------
'<codelib>
'  <file>_dotnetlib/integration/DotNetLibFileManager.frm</file>
'  <use>_dotnetlib/integration/DotNetLibRepair.frm</use>
'  <use>file/LibFiles.cls</use>
'  <use>file/FileTools.bas</use>
'  <use>data/dao/DaoTools.bas</use>
'  <license>_codelib/license.bas</license>
'  <description>Formular zur Verwaltung der ACLib .NET Integrationsdateien.</description>
'</codelib>
'---------------------------------------------------------------------------------------
'

Option Compare Database
Option Explicit

Private Const m_RegInfoTableName As String = "usys_AppFiles"
Private m_Lib As LibFiles

Public Property Get Lib() As LibFiles
    If m_Lib Is Nothing Then Set m_Lib = New LibFiles
    Set Lib = m_Lib
End Property

Private Sub btnAddFile_Click()
    
    Dim newFilePath As String
        newFilePath = FileTools.SelectFile()
    
    If FileTools.FileExists(newFilePath) Then
        
        Lib.ImportFileToTable _
            FileTools.FileNameWithoutPath(newFilePath) _
            , "[APPDIR]\Lib", True, , _
            FileTools.GetDirFromFullFileName(newFilePath)
    
    End If
    
    Lib.ReInitialize
    Me.Requery
    
End Sub

Private Sub Form_Load()

    If Not DaoTools.TableDefExists(m_RegInfoTableName, CurrentDb()) Then
        Lib.CreateAppFileTable
    End If

End Sub

Private Sub Form_Close()
    Set m_Lib = Nothing
End Sub